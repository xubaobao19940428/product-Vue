<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>demo-2</title>
</head>

<body>
    <div id="demo-2">demo-2页面</div>
    <button id="save">保存</button>
    <script>
        /**
         * postMessage window.postMeessag只能适用于同一标签下的页面通讯,不同标签下的页面是收不到信息的
         * */
        // document.getElementById('save').addEventListener('click', () => {
        //     console.log(window.opener)
        //     window.opener.postMessage({
        //         targetOrigin: window.location.origin,
        //         name: 'demo2',
        //         message: '凯小默保存成功啦啦啦啦！！！！'
        //     }, window.location.origin);
        // });

        //【BroadcastChannel】方式 在同源策略下是同一个浏览器不同的tab下可进行通信
        // const broad = new BroadcastChannel("moment");
        // document.getElementById('save').addEventListener('click', () => {
        //     broad.postMessage({
        //         value: `moment ${new Date()}`,
        //     });
        // });
        // broad.onmessage = function (e) {
        //     console.log(e.data);
        // };


        //第三种方式 Service Worker

        // navigator.serviceWorker.register("worker.js").then(() => {
        //     console.log("注册成功");
        // });

        // setInterval(() => {
        //     navigator.serviceWorker.controller.postMessage({
        //         value: `页面2 ${new Date()}`,
        //     });
        // }, 3000);

        // navigator.serviceWorker.onmessage = function (e) {
        //     console.log(e.data.value);
        // };
    </script>
</body>

</html>