(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2323d09a"],{"137c":function(e,t,a){"use strict";a.d(t,"t",(function(){return i})),a.d(t,"y",(function(){return o})),a.d(t,"r",(function(){return s})),a.d(t,"u",(function(){return n})),a.d(t,"z",(function(){return l})),a.d(t,"s",(function(){return c})),a.d(t,"v",(function(){return u})),a.d(t,"w",(function(){return d})),a.d(t,"x",(function(){return p})),a.d(t,"l",(function(){return h})),a.d(t,"k",(function(){return m})),a.d(t,"n",(function(){return g})),a.d(t,"m",(function(){return f})),a.d(t,"p",(function(){return v})),a.d(t,"h",(function(){return b})),a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return O})),a.d(t,"i",(function(){return w})),a.d(t,"g",(function(){return C})),a.d(t,"f",(function(){return D})),a.d(t,"q",(function(){return S})),a.d(t,"c",(function(){return _})),a.d(t,"d",(function(){return N})),a.d(t,"o",(function(){return k})),a.d(t,"j",(function(){return L})),a.d(t,"e",(function(){return x}));var r=a("284b");function i(e){console.log(e);var t=r["a"].create("GetAddressReq",e);return Object(r["a"])("erp","AddressBossService.GetAddress",t,"GetAddressResp")}function o(e){console.log(e);var t=r["a"].create("UpdateAddressReq",e);return Object(r["a"])("erp","AddressBossService.UpdateAddress",t,"UpdateAddressResp")}function s(e){console.log(e);var t=r["a"].create("DeleteAddressReq",e);return Object(r["a"])("erp","AddressBossService.DeleteAddress",t,"DeleteAddressResp")}function n(e){console.log(e);var t=r["a"].create("GetAddressLogiReq",e);return Object(r["a"])("erp","AddressLogiBossService.GetAddressLogi",t,"GetAddressLogiResp")}function l(e){console.log(e);var t=r["a"].create("UpdateAddressLogiReq",e);return Object(r["a"])("erp","AddressLogiBossService.UpdateAddressLogi",t,"UpdateAddressLogiResp")}function c(e){console.log(e);var t=r["a"].create("DeleteAddressLogiReq",e);return Object(r["a"])("erp","AddressLogiBossService.DeleteAddressLogi",t,"DeleteAddressLogiResp")}function u(e){console.log(e);var t=r["a"].create("LogiCompanyListReq",e);return Object(r["a"])("erp","LogiCompanyBossService.GetLogiCompanyList",t,"LogiCompanyListResp")}function d(e){console.log(e);var t=r["a"].create("SaveLogiCompanyReq",e);return Object(r["a"])("erp","LogiCompanyBossService.SaveLogiCompany",t,"SaveLogiCompanyResp")}function p(e){console.log(e);var t=r["a"].create("SyncAddressLogiReq",e);return Object(r["a"])("erp","AddressLogiBossService.SyncAddressLogi",t,"SyncAddressLogiResp")}function h(e){var t=r["a"].create("FreightForwarderListReq",e);return Object(r["a"])("erp","B2BFreightForwarderService.GetB2BFreightForwarderList",t,"FreightForwarderListResp")}function m(e){var t=r["a"].create("FreightForwarderListReq",e);return Object(r["a"])("erp","B2BFreightForwarderService.ExportCostGoFreightForwarder",t,"ImportB2BFreightForwarderResp")}function g(e){var t=r["a"].create("ImportB2BFreightForwarderReq",e);return Object(r["a"])("erp","B2BFreightForwarderService.ImportPurchaseFreightForwarder",t,"ImportB2BFreightForwarderResp")}function f(e){var t=r["a"].create("ImportB2BFreightForwarderReq",e);return Object(r["a"])("erp","B2BFreightForwarderService.ImportCostGoFreightForwarder",t,"ImportB2BFreightForwarderResp")}function v(e){var t=r["a"].create("QueryFreightForwarderInfoReq",e);return Object(r["a"])("erp","B2BFreightForwarderService.QueryFreightForwarderInfo",t,"FreightForwarderInfoResp")}function b(e){var t=r["a"].create("EditFreightForwarderReq",e);return Object(r["a"])("erp","B2BFreightForwarderService.EditFreightForwarderInfo",t,"FreightForwarderInfoResp")}function y(e){var t=r["a"].create("B2BOutOrderInfoReq",e);return Object(r["a"])("erp","B2BFreightForwarderService.B2BFreightForwarderSkuInfo",t,"B2BOutOrderInfoResp")}function O(e){var t=r["a"].create("B2BImportTemplateReq",e);return Object(r["a"])("erp","B2BFreightForwarderService.B2BImportTemplates",t,"B2BImportTemplateResp")}function w(e){var t=r["a"].create("EditFreightForwarderReq",e);return Object(r["a"])("erp","B2BFreightForwarderService.EditOutNoFreightForwarder",t,"FreightForwarderInfoResp")}function C(e){var t=r["a"].create("CrossBorderListReq",e);return Object(r["a"])("erp","CrossBorderService.CrossBorderList",t,"CrossBorderListResp")}function D(e){var t=r["a"].create("CrossBorderListReq",e);return Object(r["a"])("erp","CrossBorderService.ExportCrossBorderData",t,"CrossBorderExportResp")}function S(e){var t=r["a"].create("SingleCrossBorderReq",e);return Object(r["a"])("erp","CrossBorderService.SyncCrossBorderLogisticsInfo",t,"SingleCrossBorderResp")}function _(e){var t=r["a"].create("SingleCrossBorderReq",e);return Object(r["a"])("erp","CrossBorderService.CancelCrossBorder",t,"SingleCrossBorderResp")}function N(e){var t=r["a"].create("SingleCrossBorderReq",e);return Object(r["a"])("erp","CrossBorderService.ConfirmArrive",t,"SingleCrossBorderResp")}function k(e){var t=r["a"].create("SingleCrossBorderReq",e);return Object(r["a"])("erp","CrossBorderService.ManualOrder",t,"SingleCrossBorderResp")}function L(e){var t=r["a"].create("EnumConfigReq",e);return Object(r["a"])("erp","CrossBorderService.GetSelectEnum",t,"EnumConfigResp")}function x(e){var t=r["a"].create("ConfirmArriveBatchReq",e);return Object(r["a"])("erp","CrossBorderService.ConfirmArriveBatch",t,"ConfirmArriveBatchResp")}},"4af2":function(e,t,a){"use strict";var r=a("b4d7"),i=a.n(r);i.a},"571c":function(e,t,a){},"60fb":function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s}));var r=a("5c96"),i="https://file.fingo.shop";axios.defaults.timeout=45e3,axios.interceptors.request.use((function(e){return e}),(function(e){return r["Message"].error("请求超时"),Promise.resolve(e)}));var o=function(e,t){var a={headers:{"Content-Type":"multipart/form-data"}};return axios.post("".concat(i).concat(e),t,a).then((function(e){return e.data}))},s=function(e,t){var a={headers:{"Content-Type":"multipart/form-data"}};return axios.post("".concat(i).concat(e),t,a).then((function(e){return e.data}))}},"87cf":function(e,t,a){},"8a46":function(e,t,a){"use strict";a.r(t);var r,i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container app-puchase"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.switchTab},model:{value:e.tabActive,callback:function(t){e.tabActive=t},expression:"tabActive"}},e._l(e.tabTypeMap,(function(e,t){return a("el-tab-pane",{key:t,attrs:{label:e,name:t}})})),1),a("div",{staticClass:"filter-container"},[a("el-form",{ref:"purchaseOrderFilter",attrs:{inline:"",model:e.queryData}},[a("el-form-item",{staticClass:"product",attrs:{label:"商品：",prop:"value"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入",size:"medium",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.queryData.value,callback:function(t){e.$set(e.queryData,"value",t)},expression:"queryData.value"}},[a("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.queryData.choseType,callback:function(t){e.$set(e.queryData,"choseType",t)},expression:"queryData.choseType"}},e._l(e.productOptionList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.code}})})),1)],1)],1),a("el-form-item",{attrs:{label:"采购单号："}},[a("el-input",{staticStyle:{width:"230px"},attrs:{clearable:"",placeholder:"请输入采购单号",size:"medium"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.queryData.purchaseOrderNo,callback:function(t){e.$set(e.queryData,"purchaseOrderNo",t)},expression:"queryData.purchaseOrderNo"}})],1),a("el-form-item",{attrs:{label:"订单号："}},[a("el-input",{attrs:{placeholder:"请输入订单号",size:"medium"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.queryData.orderNo,callback:function(t){e.$set(e.queryData,"orderNo",t)},expression:"queryData.orderNo"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"后台类目：",prop:"cateId"}},[a("el-cascader",{staticClass:"normalOperatorBox",staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",props:{label:"cateName",children:"levelValue",value:"cateId",lazy:!0,lazyLoad:e.getBackSubCategory,checkStrictly:!0,emitPath:!1},placeholder:"请选择商品后台分组",options:e.backCategoryOptions,size:"medium"},on:{change:e.setBackCateId},model:{value:e.queryData.cateId,callback:function(t){e.$set(e.queryData,"cateId",t)},expression:"queryData.cateId"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.drop,expression:"drop"}]},[a("el-form-item",{attrs:{label:"供应商："}},[a("el-select",{directives:[{name:"el-select-loadmore",rawName:"v-el-select-loadmore",value:e.loadMore,expression:"loadMore"}],attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"","remote-method":e.getSupplierList,placeholder:"请输入供应商"},on:{change:function(t){return e.search()}},model:{value:e.queryData.supplierId,callback:function(t){e.$set(e.queryData,"supplierId",t)},expression:"queryData.supplierId"}},e._l(e.supplierLists,(function(e,t){return a("el-option",{key:t,attrs:{label:e.supplierName,value:e.supplierId}})})),1)],1),a("el-form-item",{attrs:{label:"物流单号："}},[a("el-input",{attrs:{placeholder:"请输入物流单号",size:"medium"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.queryData.logiCode,callback:function(t){e.$set(e.queryData,"logiCode",t)},expression:"queryData.logiCode"}})],1),a("el-form-item",{attrs:{label:"关联采购单号："}},[a("el-input",{attrs:{placeholder:"请输入关联采购单号",size:"medium"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.queryData.refPurchaseOrderNo,callback:function(t){e.$set(e.queryData,"refPurchaseOrderNo",t)},expression:"queryData.refPurchaseOrderNo"}})],1),"ALL"===e.tabActive||"SHORTAGE"===e.tabActive||"CANCLE"===e.tabActive||"WARNING"===e.tabActive?[a("el-form-item",{staticClass:"filter-item",attrs:{label:"采购单状态：",prop:"purchaseOrderStatus"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择采购单状态",size:"medium"},on:{change:function(t){return e.search()}},model:{value:e.queryData.purchaseOrderStatus,callback:function(t){e.$set(e.queryData,"purchaseOrderStatus",t)},expression:"queryData.purchaseOrderStatus"}},e._l(e.purchaseOrderStatusMap,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1)]:e._e(),a("el-form-item",{attrs:{label:"采购单来源："}},[a("el-select",{attrs:{filterable:"",multiple:"",clearable:"",size:"medium"},on:{change:function(t){return e.search()}},model:{value:e.queryData.type,callback:function(t){e.$set(e.queryData,"type",t)},expression:"queryData.type"}},e._l(e.purchaseOrderSource,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1),a("el-form-item",{attrs:{label:"Fingo系统："}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"medium"},on:{change:function(t){return e.search()}},model:{value:e.queryData.isUseFingoSystem,callback:function(t){e.$set(e.queryData,"isUseFingoSystem",t)},expression:"queryData.isUseFingoSystem"}},e._l(e.FingoSystem,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1),a("el-form-item",{attrs:{label:"收货仓库："}},[a("el-select",{attrs:{clearable:"",size:"medium",placeholder:"请选择仓库"},on:{change:function(t){return e.search()}},model:{value:e.queryData.warehouseNo,callback:function(t){e.$set(e.queryData,"warehouseNo",t)},expression:"queryData.warehouseNo"}},e._l(e.warehouseList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.warehouseName,value:e.warehouseNo}})})),1)],1),a("el-form-item",{attrs:{label:"发货方式："}},[a("el-select",{attrs:{clearable:"",placeholder:"发货方式",size:"medium"},on:{change:function(t){return e.search()}},model:{value:e.queryData.deliveWay,callback:function(t){e.$set(e.queryData,"deliveWay",t)},expression:"queryData.deliveWay"}},e._l(e.deliveWayList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),"ALL"===e.tabActive||"UN_PURCHASE"===e.tabActive||"ALL_DELIVER"===e.tabActive?a("el-form-item",{attrs:{label:"自动采购状态："}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"medium"},on:{change:function(t){return e.search()}},model:{value:e.queryData.externalStatus,callback:function(t){e.$set(e.queryData,"externalStatus",t)},expression:"queryData.externalStatus"}},e._l(e.automaticProcurementList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),a("el-form-item",{attrs:{prop:"timeList",label:"创建时间："}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",size:"medium",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:e.queryData.timeList,callback:function(t){e.$set(e.queryData,"timeList",t)},expression:"queryData.timeList"}})],1)],2),a("el-form-item",{staticClass:"filter-item",staticStyle:{"margin-left":"20px"}},[a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"medium"},on:{click:e.search}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh-left",size:"medium"},on:{click:e.resetSearch}},[e._v("重置")]),a("el-button",{attrs:{icon:"el-icon-aim",size:"medium"},on:{click:e.buttonLocation}},[e._v("定位")]),e.hasPermission("BTN_PURCHASE_ORDER_EXPORT_ADD")?a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"medium"},on:{click:function(t){return e.showDialog("add")}}},[e._v("\n                        新增采购单\n                    ")]):e._e(),e.hasPermission("BTN_PURCHASE_LIST_EXPORT")?a("el-button",{attrs:{loading:e.exportLoading,icon:"el-icon-download",type:"primary",size:"medium"},on:{click:function(t){return e.exportPurchaseOrder("yes")}}},[e._v("\n                        导出订单\n                    ")]):e._e(),e.hasPermission("BTN_PURCHASE_LIST_EXPORT")?a("el-button",{attrs:{loading:e.exportNoImgLoading,icon:"el-icon-download",type:"primary",size:"medium"},on:{click:function(t){return e.exportPurchaseOrder("noImg")}}},[e._v("\n                        导出（不带图）\n                    ")]):e._e(),"HAS_PURCHASE"===e.tabActive&&e.hasPermission("BTN_PURCHASE_SHIP_EXPORT")?a("el-button",{attrs:{icon:"el-icon-download",type:"primary",size:"medium"},on:{click:e.exportShipOrder}},[e._v("\n                        导出发货单\n                    ")]):e._e(),"HAS_PURCHASE"===e.tabActive?a("el-upload",{staticStyle:{display:"inline","margin-left":"10px"},attrs:{action:"",multiple:"","http-request":e.uploadFile,"show-file-list":!1}},[e.hasPermission("BTN__IMPORT_SHIPMENT_ORDER")?a("el-button",{attrs:{icon:"el-icon-upload",loading:e.uploadLoading,disable:e.uploadLoading,type:"primary",size:"medium"}},[e._v("导入发货订单\n                        ")]):e._e()],1):e._e(),e.hasPermission("BTN_IMPORT_COMFIRM_PURCHASE")&&"UN_PURCHASE"===e.tabActive?a("el-button",{attrs:{icon:"el-icon-upload",type:"primary",size:"medium"},on:{click:e.uploadClick}},[e._v("导入确认采购\n                    ")]):e._e(),a("el-link",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",underline:!1},on:{click:e.dropDown}},[e._v("\n                        "+e._s(e.dropDownContent)+"\n                        "),a("i",{class:e.dropDownIcon})])],1)],1)],1),a("div",{staticClass:"main-content-wrapper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%","font-size":"12px"},attrs:{data:e.dataListNew,height:"100%","row-key":e.getRowKeys,"default-expand-all":!0}},[a("el-table-column",{staticStyle:{width:"100%"},attrs:{fixed:"left",prop:"details",type:"expand",stripe:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-table",{staticStyle:{width:"100%","font-size":"10px"},attrs:{data:t.row.details,"header-cell-style":{background:"#F9FAFD"}}},[a("el-table-column",{attrs:{label:"商品名称",width:"170px","show-overflow-tooltip":!0,align:"center",prop:"productName",fixed:"left"}}),a("el-table-column",{attrs:{label:"skuCode",align:"center",prop:"skuCode",width:"120px"}}),a("el-table-column",{attrs:{label:"SKU图片",align:"center","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("img",{staticClass:"previewImage",attrs:{src:e.dealShowFileSrc(t.row.productCover)}}),a("img",{staticClass:"thumbnail image-box",attrs:{slot:"reference",src:e.dealShowFileSrc(t.row.productCover)},slot:"reference"})])]}}],null,!0)}),a("el-table-column",{attrs:{label:"SKU属性",prop:"skuDesc",align:"center","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.skuDesc))])]}}],null,!0)}),a("el-table-column",{attrs:{label:"采购单价",align:"center","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.purchasePrice||"-"))])]}}],null,!0)}),a("el-table-column",{attrs:{label:"系统数量",align:"center","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.systemCount||"0")+"\n                                ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"采购数量",align:"center","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.purchaseCount||"0")+"\n                                ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"商品链接","show-overflow-tooltip":!0,prop:"productLink","min-width":"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticStyle:{color:"#66b1ff"},attrs:{href:t.row.productLink,target:"_blank"}},[e._v(e._s(t.row.productLink))])]}}],null,!0)}),a("el-table-column",{attrs:{label:"第三方订单号",align:"center","show-overflow-tooltip":!0,prop:"thirdOrderNo","min-width":"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.thirdOrderNo||"-"))])]}}],null,!0)}),a("el-table-column",{attrs:{label:"发货数",align:"center","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.shipCount||"0")+"\n                                ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"入库数",prop:"incomeNum",align:"center","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.incomeNum||"0")+"\n                                ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"入库异常数",prop:"incomeAbnormalNum",align:"center","min-width":"85px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.incomeAbnormalNum||"0")+"\n                                ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"缺货数",align:"center","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.stockoutNum||"0")+"\n                                ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"取消数",align:"center","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                    "+e._s(t.row.cancelCount||"0")+"\n                                ")]}}],null,!0)}),a("el-table-column",{attrs:{label:"物流信息",align:"center",prop:"logisticsSingle","min-width":"250px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",e._l(t.row.logi,(function(r,i){return a("div",{key:i},[a("div",{staticClass:"block-right"},[a("div",[e._v(e._s(e.getCompanyName(r.logiCompany||"-"))+"："+e._s(r.logiCode))]),a("div",[e._v("发货数量："+e._s(r.count))]),1==t.row.logi.length?a("div"):e._e()])])})),0)]}}],null,!0)}),a("el-table-column",{attrs:{label:"单个sku操作",align:"center","min-width":"120px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",["WAIT_PURCHASE"===t.row.purchaseOrderStatus&&e.hasPermission("BTN_SKU_PURCHASE_ORDER_EDIT")?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.showEditDialog(t.row,"edit")}}},[e._v("\n                                            编辑\n                                        ")]):e._e(),"SYSTEM"===t.row.purchaseType&&e.hasPermission("BTN_SKU_ORIGINAL_ORDER")?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.showOriginalDialog(t.row)}}},[e._v("\n                                            原订单信息\n                                        ")]):e._e(),t.row.stockoutNum>0&&e.hasPermission("BTN_SKU_PURCHASE_ORDER_MAKE_UP")?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.showEditDialog(t.row,"makeup")}}},[e._v("\n                                            补单\n                                        ")]):e._e(),t.row.stockoutNum>0&&e.hasPermission("BTN_SKU_PURCHASE_ORDER_CANCEL")?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.showCancelnum(t.row)}}},[e._v("\n                                            取消采购数量\n                                        ")]):e._e(),"WAIT_PURCHASE"!=t.row.purchaseOrderStatus&&"STORAGED"!=t.row.purchaseOrderStatus&&t.row.availableStockoutCount>0&&e.hasPermission("BTN_SKU_SHORTAGE")?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.confirmhandleStockout(t.row)}}},[e._v("\n                                            缺货\n                                        ")]):e._e(),("PURCHASED"==t.row.purchaseOrderStatus||"PART_SHIPPED"==t.row.purchaseOrderStatus)&&2===t.row.isUseFingoSystem&&t.row.availableShipCount>0&&e.hasPermission("BTN_SKU_DELIVER_GOODS")?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.showDeliver(t.row,1)}}},[e._v("\n                                            发货\n                                        ")]):e._e()],1)]}}],null,!0)})],1)]}}])}),a("el-table-column",{attrs:{fixed:"left",label:"采购单号",align:"center",prop:"purchaseOrderNo","min-width":"180px"}}),a("el-table-column",{attrs:{label:"收货仓库",align:"center","min-width":"80px",prop:"warehouseName"}}),a("el-table-column",{attrs:{label:"发货方式",align:"center","min-width":"80px",prop:"deliveWay"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.deliveWay?a("div",[e._v("空运")]):a("div",[e._v("海运")])]}}])}),a("el-table-column",{attrs:{label:"剩余处理时间","min-width":"135px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:e.judgeTime(t.row.retainTime)},[e._v(" "+e._s(t.row.retainTime||"-"))])]}}])}),a("el-table-column",{attrs:{label:"供应商名称",prop:"supplierName",align:"center","min-width":"120px"}}),a("el-table-column",{attrs:{label:"采购来源",prop:"fingoSkuCode",align:"center","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e.purchaseOrderSource[t.row.purchaseType]))])]}}])}),a("el-table-column",{attrs:{label:"采购总金额",align:"center","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.purchaseAmount||"-"))])]}}])}),a("el-table-column",{attrs:{label:"运费",align:"center",prop:"freight","min-width":"55px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.freight||"-"))])]}}])}),a("el-table-column",{attrs:{label:"采购单创建时间",prop:"createTime",align:"center","min-width":"135px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("secondTimeFormat")(t.row.createTime)))])]}}])}),a("el-table-column",{attrs:{label:"入库时间",align:"center",prop:"incomeTime","min-width":"135px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("secondTimeFormat")(t.row.incomeTime)))])]}}])}),a("el-table-column",{attrs:{label:"关联采购单号 ",align:"center",prop:"refPurchaseOrderNo","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.refPurchaseOrderNo||"-")+"\n                    ")]}}])}),a("el-table-column",{attrs:{label:"供应商交货仓",align:"center","min-width":"120px",prop:"warehouseName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.transferName||"-"))])]}}])}),a("el-table-column",{attrs:{label:"采购单状态",align:"center","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["WAIT_PURCHASE"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{effect:"dark",type:"warning",size:"mini"}},[e._v("未采购")]):e._e(),"PURCHASED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{effect:"dark",size:"mini"}},[e._v("待发货")]):e._e(),"STOCKOUT"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v("缺货")]):e._e(),"SHIPPED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"success",effect:"dark",size:"mini"}},[e._v("待入库")]):e._e(),"STORAGED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{effect:"dark",size:"mini"}},[e._v("已入库")]):e._e(),"CANCLE"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("取消")]):e._e(),"CANCELED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("已取消")]):e._e(),a("div",[e._v(e._s(e.externalStatus[t.row.externalStatus]))])]}}])}),a("el-table-column",{attrs:{label:"整单操作",align:"center","min-width":"160px","min-height":"30px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"order-btn-box"},[e.hasPermission("BTN_ALL_PURCHASE_ORDER_EDIT")&&"EXTERNAL_UN_PURCHASE"!==e.tabActive&&"EXTERNAL_PURCHASE_UN_PAY"!==e.tabActive&&"WAIT_PURCHASE"==t.row.purchaseOrderStatus?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.editEntireOrder(t.row)}}},[e._v("\n                                编辑\n                            ")]):e._e(),e.hasPermission("BTN_ALL_PURCHASE_LIST_EXPORT")&&"EXTERNAL_UN_PURCHASE"!==e.tabActive&&"EXTERNAL_PURCHASE_UN_PAY"!==e.tabActive?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.exportEntireOrder(t.row)}}},[e._v("\n                                导出\n                            ")]):e._e(),e.hasPermission("BTN_ALL_VIEW_DETAILS")||"EXTERNAL_UN_PURCHASE"===e.tabActive||"EXTERNAL_PURCHASE_UN_PAY"===e.tabActive?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.showPurchaseOrderDetail(t.row)}}},[e._v("\n                                查看详情\n                            ")]):e._e(),"WAIT_PURCHASE"==t.row.purchaseOrderStatus&&"EXTERNAL_UN_PURCHASE"!==e.tabActive&&"EXTERNAL_PURCHASE_UN_PAY"!==e.tabActive&&e.hasPermission("BTN_ALL_CONFIRM_PURCHASE")?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.confirmPurchase(t.row)}}},[e._v("\n                                确认采购\n                            ")]):e._e(),"WAIT_PURCHASE"!=t.row.purchaseOrderStatus&&"EXTERNAL_UN_PURCHASE"!==e.tabActive&&"EXTERNAL_PURCHASE_UN_PAY"!==e.tabActive||!e.hasPermission("BTN_ALL_CANCEL")?e._e():a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.confirmAllCancel(t.row)}}},[e._v("\n                                整单取消\n                            ")]),"PURCHASED"!==t.row.purchaseOrderStatus&&"PART_SHIPPED"!==t.row.purchaseOrderStatus||2!==t.row.isUseFingoSystem||1!==t.row.isShip||!e.hasPermission("BTN_ALL_DELIVER_GOODS")?e._e():a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.showDeliver(t.row,2)}}},[e._v("\n                                发货\n                            ")])],1)]}}])})],1)],1),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{"current-page":e.queryData.page.pageNum,"page-sizes":[5,10,20,30,50],"page-size":e.queryData.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),e.addDialog.show?a("add-edit-po",{attrs:{propWmsWarehouseList:e.wmsWarehouseList,addDialog:e.addDialog},on:{getList:e.getListnew}}):e._e(),e.editDialog.show?a("single-sku-edit",{attrs:{propWmsWarehouseList:e.wmsWarehouseList,editDialog:e.editDialog},on:{"on-confirm-edit":e.handleEditSingleSku,"on-confirm-makeup":e.handleSingleMakeup}}):e._e(),a("cancel-purchaes-num",{attrs:{editDialog:e.editDialog},on:{getList:e.getListnew,"on-confirm":e.handleConfirmCancelPurchaseNum}}),a("shipping-information",{attrs:{deliver:e.deliver},on:{"refresh-list":e.getPurchaseOrderList}}),a("comprehensive-details",{ref:"purchaseOrderDetail",attrs:{List:e.List},on:{getList:e.getListnew}}),a("original-order-details",{ref:"originalDetail",attrs:{editDialog:e.editDialog}}),a("stock-out-details",{ref:"stockDetail",attrs:{editDialog:e.editDialog},on:{getList:e.getListnew}}),e.editDialog.confirmPurchase.show?a("confirm-purchase",{ref:"confirmPurchase",attrs:{editDialog:e.editDialog,purchaseList:e.purchaseList,details:e.details,transferList:e.transferList},on:{getList:e.getListnew}}):e._e(),a("upload-file",{attrs:{dialogVisible:e.uploadDialog},on:{"on-cancle":e.cancelUpload}})],1)},o=[],s=(a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("6b54"),a("bd86")),n=(a("96cf"),a("3b8d")),l=(a("c5f6"),a("55dd"),a("456d"),a("75fc")),c=(a("7f7f"),a("7514"),a("28a5"),a("ac6a"),a("2ef0")),u=a.n(c),d=a("60fb"),p=a("e3c6"),h=a("0cd8"),m=a("84a3"),g=a("e7c2"),f=a("ed08"),v=a("345d"),b=a("8866"),y=a("5ed1"),O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.addDialog.title,visible:e.addDialog.show,width:"950px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.addDialog,"show",t)},close:function(t){e.addDialog.show=!1}}},[a("el-form",{ref:"addDialog",attrs:{"label-position":"right","label-width":"130px",rules:e.addDialog.rules,model:e.addDialog.param}},[a("el-form-item",{staticClass:"filter-item",attrs:{label:"商品信息："}},[a("div",{staticClass:"product-info-wrapper"},[e._l(e.addDialog.param.purchaseOrderProductAddInfos,(function(t,r){return a("div",{key:r,staticClass:"flex mar-b-10 product-info-item"},[a("el-input",{attrs:{placeholder:"请输入商品编码"},model:{value:t.skuCode,callback:function(a){e.$set(t,"skuCode",a)},expression:"item.skuCode"}}),a("el-input",{staticClass:"mar-l-10",attrs:{type:"number",placeholder:"请输入采购数量"},on:{blur:function(a){return e.checkNum(t.purchaseCount)}},model:{value:t.purchaseCount,callback:function(a){e.$set(t,"purchaseCount",a)},expression:"item.purchaseCount"}}),a("el-input",{staticClass:"mar-l-10",attrs:{type:"number",placeholder:"请输入采购价格"},model:{value:t.purchasePrice,callback:function(a){e.$set(t,"purchasePrice",a)},expression:"item.purchasePrice"}}),a("el-input",{staticClass:"mar-l-10",attrs:{placeholder:"请输入第三方单号"},model:{value:t.thirdOrderNo,callback:function(a){e.$set(t,"thirdOrderNo",a)},expression:"item.thirdOrderNo"}}),"SYSTEM"!=e.addDialog.param.purchaseSource?a("div",{staticClass:"delete-box",on:{click:function(t){return e.deleteProducts(r)}}},[a("i",{staticClass:"el-icon-circle-close"})]):e._e()],1)})),a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.addProducts()}}},[e._v("+ 新 增")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.SyncNowRelationN}},[e._v("一键同步第三方单号")])],2)]),"SYSTEM"!=e.addDialog.param.purchaseSource?a("el-form-item",{staticClass:"filter-item",attrs:{label:"发货方式：",prop:"deliveWay"}},[a("el-select",{attrs:{disabled:"WAIT_PURCHASE"===e.addDialog.param.purchaseOrderStatus,filterable:"",clearable:"",size:"medium"},on:{change:function(t){return e.changeWareHouse(e.addDialog.param.deliveWay)}},model:{value:e.addDialog.param.deliveWay,callback:function(t){e.$set(e.addDialog.param,"deliveWay",t)},expression:"addDialog.param.deliveWay"}},e._l(e.deliveWayList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"1"==e.addDialog.param.deliveWay?a("el-form-item",{staticClass:"filter-item",attrs:{label:"收货仓库：",prop:"warehouseNo"}},["add"==this.addDialog.type?a("el-select",{attrs:{filterable:"",clearable:"",size:"medium",placeholder:"请选择仓库"},model:{value:e.addDialog.param.warehouseNo,callback:function(t){e.$set(e.addDialog.param,"warehouseNo",t)},expression:"addDialog.param.warehouseNo"}},e._l(e.wmsWarehouseList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.warehouseName,value:e.warehouseNo,disabled:"0001"===e.warehouseNo||"0005"===e.warehouseNo}})})),1):a("span",[e._v(e._s(e.addDialog.param.warehouseName))])],1):a("el-form-item",{staticClass:"filter-item",attrs:{label:"收货仓库：",prop:"warehouseNo"}},["add"==this.addDialog.type?a("el-select",{attrs:{disabled:"WAIT_PURCHASE"===e.addDialog.param.purchaseOrderStatus,filterable:"",clearable:"",size:"medium",placeholder:"请选择仓库"},model:{value:e.addDialog.param.warehouseNo,callback:function(t){e.$set(e.addDialog.param,"warehouseNo",t)},expression:"addDialog.param.warehouseNo"}},e._l(e.wmsWarehouseList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.warehouseName,value:e.warehouseNo}})})),1):a("span",[e._v(e._s(e.addDialog.param.warehouseName))])],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"供应商：",prop:"supplierId"}},[a("el-select",{attrs:{"remote-method":e.getSupplierList,filterable:"",clearable:"",remote:"","reserve-keyword":"",size:"medium"},model:{value:e.addDialog.param.supplierId,callback:function(t){e.$set(e.addDialog.param,"supplierId",t)},expression:"addDialog.param.supplierId"}},e._l(e.supplierList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.supplierName,value:e.supplierId}})})),1)],1),a("el-form-item",{attrs:{label:"运费：",prop:"freight"}},[a("el-input",{staticStyle:{width:"196px"},attrs:{type:"number",placeholder:"请输入运费",size:"medium"},model:{value:e.addDialog.param.freight,callback:function(t){e.$set(e.addDialog.param,"freight",t)},expression:"addDialog.param.freight"}})],1),a("el-form-item",{attrs:{label:"推送供应商：",prop:"isUse"}},[a("el-radio-group",{model:{value:e.addDialog.param.isUse,callback:function(t){e.$set(e.addDialog.param,"isUse",t)},expression:"addDialog.param.isUse"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),a("el-radio",{attrs:{label:2}},[e._v("否")])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancle}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.addLoading,size:"small"},on:{click:e.addPurchase}},[e._v("确 定")])],1)])],1)},w=[],C={name:"addEditPo",props:{addDialog:{type:Object,default:function(){}},propWmsWarehouseList:Array},mixins:[p["a"]],data:function(){return{addLoading:!1,deliveWayList:[{value:1,label:"海运"},{value:2,label:"空运"}],supplierList:[]}},mounted:function(){this.wmsWarehouseList=this.propWmsWarehouseList,"editEntireOrder"===this.addDialog.param.type&&(console.log("===>"),this.getSupplierList("",this.addDialog.param.supplierId))},components:{},methods:{getSupplierList:function(e,t){var a=this,r={supplierName:e,supplierId:t||""};Object(v["i"])(this.filterData(r)).then((function(e){console.log("111111",e),1===e.ret.errcode&&(a.supplierList=e.list)}))},checkNum:function(e){e<=0&&this.$alert("采购数量不能为小于等于零")},deleteProducts:function(e){this.addDialog.param.purchaseOrderProductAddInfos.splice(e,1)},addProducts:function(){this.addDialog.param.purchaseOrderProductAddInfos.push({skuCode:"",purchaseCount:"",purchasePrice:"",thirdOrderNo:""})},isRepeat:function(e){var t={};for(var a in e){if(t[e[a].skuCode])return!0;t[e[a].skuCode]=!0}return!1},addPurchase:function(){var e=this;this.$refs["addDialog"].validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(a){var r,i,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=5;break}if(r=e.addDialog.param.purchaseOrderProductAddInfos.filter((function(e){return e.skuCode&&""!=e.purchaseCount&&""!=e.purchasePrice})),r.length>0){for(i=0;i<e.addDialog.param.purchaseOrderProductAddInfos.length;i++)e.addDialog.param.purchaseOrderProductAddInfos[i].purchaseCount<0&&e.$message.warning("采购数量异常");e.isRepeat(r)?e.$message.warning("skuCode不能相同"):(o=e.addDialog.param,s={},s.purchaseOrderNo=o.purchaseOrderNo,s.warehouseNo=o.warehouseNo,s.supplierId=o.supplierId,s.deliveWay=o.deliveWay,s.freight=o.freight,s.isUse=o.isUse,s.detailInfo=o.purchaseOrderProductAddInfos,e.savePurchaseOrder(s))}else e.$message.warning("商品信息不能为空");t.next=6;break;case 5:return t.abrupt("return",!1);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},SyncNowRelationN:function(){for(var e=0;e<this.addDialog.param.purchaseOrderProductAddInfos.length;e++)this.addDialog.param.purchaseOrderProductAddInfos[e].thirdOrderNo=this.addDialog.param.purchaseOrderProductAddInfos[0].thirdOrderNo},changeWareHouse:function(e){},savePurchaseOrder:function(e){var t=this;this.addLoading=!0,Object(h["O"])(this.filterData(e)).then((function(e){t.addLoading=!1,1===e.ret.errcode?(t.$message.success("操作成功！"),t.addDialog.show=!1,t.$emit("getList"),t.reset()):t.$message.error(e.message)})).catch((function(e){t.addLoading=!1,console.log(e)}))},cancle:function(){this.addDialog.show=!1,this.reset()},reset:function(){this.$refs.addDialog.resetFields()}}},D=C,S=(a("d5e8"),a("2877")),_=Object(S["a"])(D,O,w,!1,null,"717d2438",null),N=_.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.editDialog.title,visible:e.editDialog.show,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.editDialog,"show",t)},close:function(t){e.editDialog.show=!1}}},[a("el-form",{ref:"addDialog",attrs:{"label-position":"right","label-width":"130px",model:e.editDialog.param}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"filter-item",attrs:{label:"供应商：",prop:"supplierId"}},[a("el-select",{attrs:{disabled:"WAIT_PURCHASE"===e.editDialog.param.purchaseOrderStatus,filterable:"",clearable:"",remote:"","reserve-keyword":"","remote-method":e.getSupplierList,placeholder:"请输入供应商"},on:{change:e.dialogChange},model:{value:e.supplierId,callback:function(t){e.supplierId=t},expression:"supplierId"}},e._l(e.supplierList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.supplierName,value:e.supplierId}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"skuCode："}},[a("span",[e._v(e._s(e.editDialog.param.skuCode||"-"))])])],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"收货仓库："}},[a("span",[e._v(e._s(e.editDialog.param.warehouseName))])])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"系统数量："}},[a("span",[e._v(e._s(e.editDialog.param.systemCount))])])],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},["makeup"==this.editDialog.type?a("el-form-item",{attrs:{label:"已入库数量："}},[a("span",[e._v(e._s(e.editDialog.param.incomeNum))])]):e._e()],1),a("el-col",{attrs:{span:12}},["makeup"==this.editDialog.type?a("el-form-item",{attrs:{label:"已取消数量："}},[a("span",[e._v(e._s(e.editDialog.param.cancelCount))])]):e._e()],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},["makeup"==this.editDialog.type?a("el-form-item",{attrs:{label:"最大可补数量："}},[a("span",[e._v(e._s(e.editDialog.param.maxCount))])]):e._e()],1)],1),"makeup"==this.editDialog.type?a("el-form-item",{attrs:{label:"采购数量：",prop:"purchaseCount"}},[a("el-input",{attrs:{placeholder:"请输入采购数量"},on:{blur:function(t){return e.checkPurchaseCount(e.editDialog.param.purchaseCount)}},model:{value:e.editDialog.param.purchaseCount,callback:function(t){e.$set(e.editDialog.param,"purchaseCount",t)},expression:"editDialog.param.purchaseCount"}})],1):a("el-form-item",{attrs:{label:"采购数量：",prop:"purchaseCount"}},[a("el-input",{attrs:{placeholder:"请输入采购数量"},model:{value:e.editDialog.param.purchaseCount,callback:function(t){e.$set(e.editDialog.param,"purchaseCount",t)},expression:"editDialog.param.purchaseCount"}})],1),"onemakeup"!=e.editDialog.type?[a("el-form-item",{attrs:{label:"商品采购单价：",prop:"purchasePrice"}},[a("el-input",{attrs:{placeholder:"请输入商品采购单价"},model:{value:e.editDialog.param.purchasePrice,callback:function(t){e.$set(e.editDialog.param,"purchasePrice",t)},expression:"editDialog.param.purchasePrice"}})],1),a("el-form-item",{attrs:{label:"第三方单号：",prop:"thirdOrderNo"}},[a("el-input",{attrs:{placeholder:"请输入第三方单号"},model:{value:e.editDialog.param.thirdOrderNo,callback:function(t){e.$set(e.editDialog.param,"thirdOrderNo",t)},expression:"editDialog.param.thirdOrderNo"}})],1)]:e._e(),a("el-form-item",{attrs:{label:"运费：",prop:"freight"}},[a("el-input",{attrs:{placeholder:"请输入运费"},model:{value:e.editDialog.param.freight,callback:function(t){e.$set(e.editDialog.param,"freight",t)},expression:"editDialog.param.freight"}})],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.getPurchaseclose}},[e._v("取 消")]),"edit"==this.editDialog.type?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSingleEditConfirm}},[e._v("确 定")]):e._e(),"makeup"==this.editDialog.type?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSingleMakeupConfirm}},[e._v("确 定")]):e._e()],1)])],1)},L=[],x={name:"singleSkuEdit",props:{editDialog:{type:Object,default:function(){}},propWmsWarehouseList:Array},mixins:[p["a"]],data:function(){return{supplierId:""}},mounted:function(){"edit"===this.editDialog.type&&(console.log("===>"),this.supplierId=this.editDialog.param.supplierId,this.getSupplierList("",this.editDialog.param.supplierId))},watch:{editDialog:{handler:function(e){console.log(e),e.show&&(this.supplierId=e.param.supplierId)},deep:!0}},components:{},methods:{getSupplierList:function(e,t){var a=this,r={supplierName:e,supplierId:t||""};Object(v["i"])(this.filterData(r)).then((function(e){console.log(e),1===e.ret.errcode&&(a.supplierList=e.list)}))},dialogChange:function(e){},getPurchaseclose:function(){this.editDialog.show=!1,this.editDialog.param.productPurchasePrice="",this.editDialog.param.content=""},checkPurchaseCount:function(e){(e>this.editDialog.param.maxCount||e<=0)&&(this.$alert("采购数量不在允许范围内"),this.editDialog.param.purchaseCount=this.editDialog.param.maxCount)},onSingleEditConfirm:function(){this.$emit("on-confirm-edit",this.editDialog.param)},onSingleMakeupConfirm:function(){this.$emit("on-confirm-makeup",this.editDialog.param)}}},A=x,P=(a("fe2d"),Object(S["a"])(A,k,L,!1,null,"78110ca1",null)),I=P.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"取消采购数量",visible:e.editDialog.cancelnum.show,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.editDialog.cancelnum,"show",t)},close:function(t){e.editDialog.cancelnum.show=!1}}},[a("el-form",{attrs:{"label-position":"right","label-width":"130px",model:e.editDialog.param}},[a("el-form-item",{attrs:{label:"供应商：",prop:"supplierName"}},[a("span",[e._v(e._s(e.editDialog.param.supplierName))])]),a("el-form-item",{attrs:{label:"skuCode：",prop:"skuCode"}},[a("span",[e._v(e._s(e.editDialog.param.skuCode))])]),a("el-form-item",{attrs:{label:"系统数量：",prop:"purchaseCount"}},[a("span",[e._v(e._s(e.editDialog.param.systemCount))])]),a("el-form-item",{attrs:{label:"实际采购数量：",prop:"purchaseCount"}},[a("span",[e._v(e._s(e.editDialog.param.purchaseCount))])]),a("el-form-item",{attrs:{label:"入库数量：",prop:"incomeNum"}},[a("span",[e._v(e._s(e.editDialog.param.incomeNum))])]),a("el-form-item",{attrs:{label:"已取消数量：",prop:"cancelCount"}},[a("span",[e._v(e._s(e.editDialog.param.cancelCount))])]),a("el-form-item",{attrs:{label:"发货数量："}},[a("span",[e._v(e._s(e.editDialog.param.shipCount))])]),a("el-form-item",{attrs:{label:"取消数量：",prop:"count"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入取消数量",min:"1",max:e.editDialog.param.cancelCount},model:{value:e.editDialog.param.count,callback:function(t){e.$set(e.editDialog.param,"count",t)},expression:"editDialog.param.count"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.getCancelclose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onConfirmCancelPurchaseNum}},[e._v("确 定")])],1)])],1)},E=[],R={name:"cancelPurchaesNum",props:{editDialog:{type:Object,default:function(){}}},mixins:[p["a"]],data:function(){return{}},components:{},methods:{getCancelclose:function(){this.editDialog.cancelnum.show=!1,this.editDialog.param.count=""},onConfirmCancelPurchaseNum:function(){console.log(this.editDialog.param),this.$emit("on-confirm",this.editDialog.param)}}},j=R,U=Object(S["a"])(j,T,E,!1,null,"1249387a",null),$=U.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"发货信息",width:"1200px",visible:e.deliver.show},on:{"update:visible":function(t){return e.$set(e.deliver,"show",t)},close:function(t){e.deliver.show=!1}}},[a("el-button",{staticClass:"button-sync-tag mar-t-20",attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.SyncNow()}}},[e._v("复制到所有商品\n    ")]),a("el-form",{ref:"ship",staticStyle:{"margin-left":"1px"},attrs:{"label-position":"left","label-width":"90px",model:e.deliver.param}},[a("el-form-item",[a("div",{staticClass:"logistics-info-wrapper"},[a("div",{staticStyle:{"margin-left":"-86px"}},[e._v("采购单号："+e._s(this.deliver.param.purchaseOrderNo))]),e._l(e.deliver.ships,(function(t,r){return a("div",{key:r,staticClass:"mar-b-10 logistics-info-item"},[a("div",{staticClass:"flex",staticStyle:{"margin-left":"-86px"}},[a("div",{staticStyle:{width:"240px"}},[e._v("skuCode："+e._s(t.skuCode))]),a("div",{staticStyle:{width:"160px"}},[e._v("未发货数量："+e._s(t.availableShipCount))]),a("div",e._l(t.logiList,(function(i,o){return a("div",{key:o},[a("div",{staticClass:"flex align-center"},[a("el-input",{staticClass:"mar-l-10 ",staticStyle:{width:"23%"},attrs:{placeholder:"输入发货数量",size:"medium"},on:{blur:function(t){return e.checkLogistics(i.count)}},model:{value:i.count,callback:function(t){e.$set(i,"count",t)},expression:"skuItem.count"}}),a("el-select",{staticStyle:{"margin-left":"10px"},attrs:{placeholder:"物流公司",size:"medium",filterable:"",clearable:""},model:{value:i.logiCompany,callback:function(t){e.$set(i,"logiCompany",t)},expression:"skuItem.logiCompany"}},e._l(e.logisticsCompany,(function(e){return a("el-option",{key:e.id,attrs:{label:e.companyName,value:e.logiCompany}})})),1),a("el-input",{staticStyle:{width:"24%","margin-left":"10px"},attrs:{placeholder:"请输入物流单号",size:"medium"},on:{blur:function(t){return e.validateJyh(i.logiCode)}},model:{value:i.logiCode,callback:function(t){e.$set(i,"logiCode",t)},expression:"skuItem.logiCode"}}),a("i",{staticClass:"el-icon-circle-close",staticStyle:{"margin-left":"10px"},on:{click:function(a){return e.deleteDeliverSku(t,r,o)}}}),a("div",[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"mini"},on:{click:function(a){return e.addSkuMag(t)}}},[e._v("物流拆分")])],1)],1)])})),0)])])}))],2)])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.deliver.show=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small","v-loading":e.loading},on:{click:e.handleDeliver}},[e._v("确 定")])],1)],1)},B=[],z=a("137c"),F={name:"shippingInformation",props:{deliver:{type:Object,default:function(){}}},mixins:[p["a"]],data:function(){return{loading:!1,logisticsCompany:[]}},components:{},mounted:function(){this.getLogisticsCompany()},methods:{getLogisticsCompany:function(){var e=this;Object(z["v"])({type:2,cooperateStatus:1,page:{pageNum:1,pageSize:100,pagingSwitch:!1}}).then((function(t){1===t.ret.errcode&&(e.logisticsCompany=t.logiCompany)}))},SyncNow:function(){console.log(this.deliver.ships);for(var e=0;e<this.deliver.ships.length;e++)for(var t=0;t<this.deliver.ships[e].logiList.length;t++){var a=this.deliver.ships[e].logiList[t];a.logiCode=this.deliver.ships[0].logiList[0].logiCode,a.logiCompany=this.deliver.ships[0].logiList[0].logiCompany,a.logisticsType=this.deliver.ships[0].logiList[0].logisticsType}},checkLogistics:function(e){""==e&&this.$alert("输入不可为空")},validateJyh:function(e){var t=/^[A-Za-z0-9]{1,30}$/;t.test(e)||this.$alert("请输入字母或数字组成的物流单号,不能有空格")},addSkuMag:function(e){e.logiList.push({logisticsType:"DOMESTIC",logiCompany:"",logiCode:"",count:""})},deleteDeliverSku:function(e,t,a){e.logiList.splice(a,1),""==e.logiList&&this.deliver.ships.splice(t,1)},handleDeliver:function(){var e=this;this.loading=!0;var t={delivers:this.deliver.ships};Object(h["B"])(this.filterData(t)).then((function(t){e.loading=!1,1===t.ret.errcode?(e.deliver.show=!1,e.$message.success("发货成功！"),e.$emit("refresh-list")):e.$message.error(t.message)})).catch((function(t){e.loading=!1,console.log(t)}))}}},W=F,H=Object(S["a"])(W,q,B,!1,null,"6e4091af",null),M=H.exports,G=a("9d52"),X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"缺货详情页",visible:e.editDialog.stockOutDetails.show,width:"900px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.editDialog.stockOutDetails,"show",t)},close:function(t){e.editDialog.stockOutDetails.show=!1}}},[a("el-card",{staticStyle:{"margin-bottom":"20px"}},[a("el-form",{attrs:{"label-position":"right","label-width":"100px",model:e.editDialog.param}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"采购单号："}},[a("span",[e._v(e._s(e.editDialog.param.purchaseOrderNo||"-"))])])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"商品名称："}},[a("span",[e._v(e._s(e.editDialog.param.productName))])])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"SkU图片："}},[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.dealShowFileSrc(e.editDialog.param.productCover),fit:"contain"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"skuCode："}},[a("span",[e._v(e._s(e.editDialog.param.skuCode||"-"))])])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"采购数量："}},[a("span",[e._v(e._s(e.editDialog.param.purchaseCount||"-"))])])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"SKU属性："}},[a("span",[e._v(e._s(e.editDialog.param.skuDesc||"-"))])])],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"已入库数："}},[a("span",[e._v(e._s(e.editDialog.param.incomeNum))])])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"已取消数："}},[a("span",[e._v(e._s(e.editDialog.param.cancelCount))])])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"已缺货数："}},[a("span",[e._v(e._s(e.editDialog.param.stockoutNum))])])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.deliveryList,border:""}},[a("el-table-column",{attrs:{label:"快递公司","min-width":"200px",fixed:"left",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.logiCompany))])]}}])}),a("el-table-column",{attrs:{label:"物流单号",align:"center","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(" "+e._s(t.row.logiCode))])]}}])}),a("el-table-column",{attrs:{label:"签收状态",align:"center","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.signStatus?a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("已签收")]):e._e(),2===t.row.signStatus?a("el-tag",{attrs:{size:"mini"}},[e._v("未签收")]):e._e()]}}])}),a("el-table-column",{attrs:{label:"发货数","min-width":"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(" "+e._s(t.row.totalCount))])]}}])}),a("el-table-column",{attrs:{label:"入库数","min-width":"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.incomeCount))])]}}])}),a("el-table-column",{attrs:{label:"缺货数量","min-width":"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.signStatus?a("el-input",{attrs:{min:0,tyle:"width: 150px;",size:"mini",type:"number"},on:{blur:function(a){return e.checkCount(t.row,1)}},model:{value:t.row.count,callback:function(a){e.$set(t.row,"count",a)},expression:"scope.row.count"}}):e._e(),1===t.row.signStatus?a("el-input",{attrs:{min:0,tyle:"width: 150px;",size:"mini",disabled:!0},model:{value:t.row.count,callback:function(a){e.$set(t.row,"count",a)},expression:"scope.row.count"}}):e._e()]}}])})],1),a("div",{staticStyle:{"margin-left":"435px"}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticStyle:{"margin-left":"100px"},attrs:{label:"未发货数量："}},[a("div",{staticStyle:{"font-size":"10px"}},[e._v(e._s(this.unShipCount))])])],1),a("el-col",{staticStyle:{width:"49.83333%"},attrs:{span:12}},[a("el-form-item",{staticStyle:{"margin-left":"33px"},attrs:{label:"缺货数量："}},[0==this.unShipCount?a("el-input",{staticStyle:{width:"98px"},attrs:{min:0,size:"mini",disabled:!0},model:{value:e.count,callback:function(t){e.count=t},expression:"count"}}):a("el-input",{staticStyle:{width:"98px"},attrs:{min:0,size:"mini",type:"number"},on:{blur:function(t){return e.checkCount(e.count,2)}},model:{value:e.count,callback:function(t){e.count=t},expression:"count"}})],1)],1)],1)],1),a("div",{staticStyle:{"margin-left":"300px"}},[a("el-checkbox",{model:{value:e.autoCancel,callback:function(t){e.autoCancel=t},expression:"autoCancel"}},[e._v("同时取消采购")])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.getCancelclose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onConfirmCancel}},[e._v("确 定")])],1)])],1)},K=[],V={name:"stockOutDetails",props:{editDialog:{type:Object,default:function(){}}},mixins:[p["a"]],data:function(){return{autoCancel:!1,loading:!1,count:0,deliveryList:[],deliveryList1:[],unShipCount:"",totalShipNum:"",totalSkuShipNum:0,totalIncomeNum:""}},components:{},created:function(){},methods:{checkCount:function(e,t){return 1===t&&(e.count>e.totalCount-e.incomeCount||""===e.count)?(this.$alert("缺货输入框 <= 发货数-入库数或数据为空"),console.log(111),e.count=0,!1):2!==t||!(e>this.unShipCount||""===e)||(this.$alert("缺货输入框<=采购数-发货数（未发货数）或数据为空"),this.count=0,!1)},getCancelclose:function(){this.editDialog.stockOutDetails.show=!1},confirmhandleStockout:function(){var e=this;this.loading=!0,this.count=0;var t={purchaseOrderNo:this.editDialog.param.purchaseOrderNo,skuCode:this.editDialog.param.skuCode};this.deliveryList=[],Object(h["l"])(t).then((function(t){if(e.loading=!1,1===t.ret.errcode){console.log(t),e.deliveryList1=t.delivery,e.deliveryList1.map((function(t,a){e.deliveryList.push(Object.assign({},t,{count:"0"}))})),console.log(e.deliveryList),e.unShipCount=t.unShipCount;for(var a=0;a<e.deliveryList.length;a++)e.totalShipNum+=e.deliveryList[a].totalCount,e.totalIncomeNum+=e.deliveryList[a].incomeCount}})).catch((function(t){e.loading=!1,console.log(t)}))},onConfirmCancel:function(){var e=this,t=!0;this.totalSkuShipNum=0,console.log(this.deliveryList);for(var a=0;a<this.deliveryList.length;a++)if(2===this.deliveryList[a].signStatus){if(!this.checkCount(this.deliveryList[a],1))return void(t=!1);console.log("缺货填写数："+this.deliveryList[a].count),this.totalSkuShipNum+=parseInt(this.deliveryList[a].count)}if(0==this.unShipCount||this.checkCount(this.count,2)){if(this.totalSkuShipNum>this.editDialog.param.purchaseCount-this.editDialog.param.incomeNum-this.editDialog.param.cancelCount-this.editDialog.param.stockoutNum)return this.$alert("整单缺货数量<=实际采购数量-已入库数量-已取消数量-已缺货数量"),void(t=!1);if(t){var r={};if(this.editDialog.stockOutDetails.show=!0,this.deliveryList==[])r={purchaseOrderNo:this.editDialog.param.purchaseOrderNo,skuCode:this.editDialog.param.skuCode,count:this.count,stockout:[]};else{r={purchaseOrderNo:this.editDialog.param.purchaseOrderNo,skuCode:this.editDialog.param.skuCode,count:this.count,stockout:[]};for(var i=0;i<this.deliveryList.length;i++)r.stockout.push({incomeNo:this.deliveryList[i].incomeNo,count:this.deliveryList[i].count})}console.log(r),Object.assign(r,{autoCancel:this.autoCancel?"1":"2"}),Object(h["z"])(this.filterData(r)).then((function(t){1===t.ret.errcode?(e.$message.success("缺货成功！"),e.editDialog.stockOutDetails.show=!1,e.$emit("getList")):e.$message.error(t.ret.msg)})).catch((function(e){console.log(e)})),this.count=0,this.autoCancel=!1}}else t=!1}}},Y=V,J=Object(S["a"])(Y,X,K,!1,null,"771d6a19",null),Q=J.exports,Z=a("17ef"),ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"采购单详情",visible:e.editDialog.Original.show,height:"100%","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.editDialog.Original,"show",t)},close:function(t){e.editDialog.Original.show=!1}}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"采购单号："}},[a("div",[e._v(e._s(this.editDialog.param.purchaseOrderNo))])])],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{staticStyle:{"margin-left":"30px"},attrs:{label:"SkuCode："}},[a("div",[e._v(e._s(this.editDialog.param.skuCode))])])],1)],1)],1),a("div",[a("el-table",{attrs:{data:e.orderDetail,loading:e.loading}},[a("el-table-column",{attrs:{label:"用户订单号","min-width":"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.orderNo))])]}}])}),a("el-table-column",{attrs:{label:"SKU商品数量","min-width":"240px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.count||"-"))])]}}])})],1)],1),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{"current-page":e.page.pageNum,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{icon:"el-icon-download",type:"primary",size:"small"},on:{click:e.exportOrder}},[e._v("导出数据")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.closeall}},[e._v("关 闭")])],1)],1)},te=[],ae={name:"originalOrderDetails",props:{editDialog:{type:Object,default:function(){}}},mixins:[p["a"]],data:function(){return{exportLoading:!1,loading:!1,orderDetail:[],page:{pageSize:10,pageNum:1},total:0}},created:function(){},components:{},methods:{closeall:function(){this.editDialog.Original.show=!1},handleSizeChange:function(e){this.page.pageSize=e,this.getOrderDetail()},handleCurrentChange:function(e){this.page.pageNum=e,this.getOrderDetail()},getOrderDetail:function(){var e=this;this.loading=!0;var t={page:this.page,purchaseOrderNo:this.editDialog.param.purchaseOrderNo,skuCode:this.editDialog.param.skuCode};Object(h["y"])(t).then((function(t){e.loading=!1,e.orderDetail=[],1===t.ret.errcode?(e.total=t.total,e.orderDetail=t.order,console.log(e.orderDetail)):e.$message.error(t.message)})).catch((function(t){e.loading=!1,console.log(t)}))},exportOrder:function(){var e=this;this.exportLoading=!0;var t={purchaseOrderNo:this.editDialog.param.purchaseOrderNo,skuCode:this.editDialog.param.skuCode};Object(h["x"])(this.filterData(t)).then((function(t){if(1===t.ret.errcode){e.exportLoading=!1;var a=t.fileUrl;window.open(e.dealShowFileSrc(a))}else e.exportLoading=!1,e.$message.error(t.message)})).catch((function(t){e.exportLoading=!1,console.log(t)}))}}},re=ae,ie=(a("d48a"),Object(S["a"])(re,ee,te,!1,null,"efc9770e",null)),oe=ie.exports,se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-file"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.toggle,width:"900px","before-close":e.cancle,"close-on-click-modal":!1},on:{"update:visible":function(t){e.toggle=t}}},[a("div",[e._v("\n            上传：\n            "),e.fileUrl?e._e():a("el-upload",{staticClass:"upload-wrapper",attrs:{action:"",multiple:"","http-request":e.uploadFile,"show-file-list":!1}},[a("el-button",{attrs:{icon:"el-icon-upload2",loading:e.uploadLoading,disable:e.uploadLoading,size:"medium",plain:""}},[e._v("\n                    选择文件\n                ")])],1),a("span",{staticClass:"file-name"},[e._v(e._s(e.fileName))])],1),a("div",{staticClass:"notice"},[a("div",[e._v("注意：")]),a("div",[e._v("        1、导入字段包括："),a("i",{staticClass:"iconfont"},[e._v("")]),e._v("采购单号、供应商名称、"),a("i",{staticClass:"iconfont"},[e._v("")]),e._v("skuCode、商家商品Id、商家skuId、商品名称、商品链接、sku规格属性、"),a("i",{staticClass:"iconfont"},[e._v("")]),e._v("单价、系统数量、"),a("i",{staticClass:"iconfont"},[e._v("")]),e._v("采购数量、"),a("i",{staticClass:"iconfont"},[e._v("")]),e._v("运费、第三方订单号。")]),a("div",[e._v("        2、请确认导入的采购单状态为未采购，并且手动采购。")]),a("div",{staticClass:"download",on:{click:e.downloadTemp}},[e._v("下载导入模板")]),a("el-progress",{attrs:{percentage:e.percentage}}),a("div",{staticClass:"message"},[a("span",[e._v(e._s(e.message))])])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancle}},[e._v("关 闭")])],1)])],1)},ne=[],le={data:function(){return{dialogTitle:"导入确认采购",uploadLoading:!1,fileUrl:"",errorDialog:!1,percentage:0,fileName:"",message:""}},props:{dialogVisible:{type:Boolean,default:!1}},computed:{toggle:{get:function(){return this.dialogVisible},set:function(){}}},methods:{cancle:function(){this.fileUrl="",this.$emit("on-cancle")},uploadFile:function(e){var t=this;console.log(e),this.fileName=e.file.name,this.uploadLoading=!0;var a=new FormData,r={fileName:e.file.name,type:"other"};a.append("file",e.file),a.append("param",JSON.stringify(r));var i="/file/rest/uploadservices/uploadfile";Object(d["a"])(i,a).then((function(e){t.uploadLoading=!1,"600"===e.status?(t.fileUrl=e.original_link,console.log(t.fileUrl),t.getImportShip(e.original_link),t.percentage=100):t.$message.error("文件上传失败，请重试！")})).catch((function(e){console.log(e)}))},getImportShip:function(e){var t=this,a={uploadUrl:e};Object(h["m"])(a).then((function(e){1===e.ret.errcode?(t.message=e.message,t.$message.success("导入已提交，请去任务管理页查看进度")):(t.message=e.message,t.$message.error(e.message))}))},downloadTemp:function(){var e=this;Object(h["j"])({}).then((function(t){if(1===t.ret.errcode){var a=e.dealShowFileSrc(t.fileUrl);console.log(a),window.open("".concat(a))}}))},confirmUploadPresale:function(){this.fileUrl}}},ce=le,ue=(a("e5dc"),a("aeaf"),Object(S["a"])(ce,se,ne,!1,null,null,null)),de=ue.exports,pe=a("9576");function he(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=me(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,n=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return s=e.done,e},e:function(e){n=!0,o=e},f:function(){try{s||null==a.return||a.return()}finally{if(n)throw o}}}}function me(e,t){if(e){if("string"===typeof e)return ge(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?ge(e,t):void 0}}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var fe={components:{addEditPo:N,singleSkuEdit:I,cancelPurchaesNum:$,shippingInformation:M,comprehensiveDetails:G["a"],stockOutDetails:Q,originalOrderDetails:oe,confirmPurchase:Z["a"],UploadFile:de},mixins:[p["a"]],data:function(){return{backCategoryOptions:[],uploadDialog:!1,purchaseList:[],transferList:[],details:[],changeNo:"",expandNo:"",expands:[],dom:null,scrollTop:null,drop:!1,dropDownContent:"展开",dropDownIcon:"el-icon-arrow-down",loading:!1,tabActive:"ALL",tabTypeMap:{ALL:"全部",UNGROUP:"未分组",EXTERNAL_UN_PURCHASE:"待自动下单",EXTERNAL_PURCHASE_UN_PAY:"已自动下单未付款",UN_PURCHASE:"未采购（手动）",HAS_PURCHASE:"待发货",SHORTAGE:"缺货",ALL_DELIVER:"待入库",HAS_INCOME:"已入库",CANCEL:"已取消",WARNING:"预警订单"},externalStatus:{1:"待自动下单",2:"已下单未付款",3:"采购成功",4:"自动下单失败",5:"采购取消",0:""},purchaseOrderStatusMap:{WAIT_PURCHASE:"未采购",PURCHASED:"已采购",SHIPPED:"已发货",STORAGED:"已入库",CANCELED:"已取消"},queryData:{choseType:"1",value:"",purchaseOrderNo:"",refPurchase_orderNo:"",supplierId:"",supplierName:"",buyerId:"",purchaseOrderStatus:"",type:[],isUseFingoSystem:"",deliveWay:"",startTime:"",endTime:"",orderNo:"",thirdOrderNo:"",productId:"",logiCode:"",productName:"",skuCode:"",refPurchaseOrderNo:"",warehouseNo:"",isWarningSwith:null,timeList:[],incomeStatus:null,externalStatus:"",cateId:[],page:{pageSize:10,pageNum:1}},deliveWayList:[{value:"1",label:"海运"},{value:"2",label:"空运"}],exportLoading:!1,productOptionList:[{name:"skuCode",code:"1"},{name:"商品名称",code:"2"},{name:"第三方订单号",code:"3"},{name:"商品ID",code:"4"}],supplierLists:[],warehouseList:[],buyerList:[],page:1,pageSize:10,pagingSwitch:!0,total:0,showSearchParam:!1,importLoading:!1,uploadFileName:"".concat("file"),headers:this.$headers,load:!1,check:"",oneKeySync:{show:!1},wmsWarehouseList:[],List:{parcelAnomaly:"",total:0,detailList:[],productList:[],relList1:[],relList2:[],show:!1,param:{pageSize:10,pageNum:1}},deliver:{data:[],List:[],type:"",ships:[],show:!1,logisticsType:{DOMESTIC:"国内",INTERNATIONAL:"国际",LOCAL:"当地"},param:{supplierOrderNo:"",logisticsSingleCode:"",purchaseOrderNo:"",supplierId:"",fingoSkuCode:""}},logisticsCompany:y["a"],purchaseOrderSource:{SYSTEM:"系统",SUPPLEMENT:"补充单",ARTIFICIAL:"人工单"},orderSwitch:{false:"默认不排序",true:"按供应商名称，采购状态，创建时间排序"},logisticsType:{DOMESTIC:"国内",INTERNATIONAL:"国际",LOCAL:"当地"},automaticProcurementList:[{value:1,label:"待自动下单"},{value:2,label:"已下单未付款"},{value:3,label:"采购成功"},{value:4,label:"采购失败"},{value:5,label:"采购取消"},{value:6,label:"部分发货待处理"}],timeList:[],dataList:[],dataListNew:[],tranlist:[],accountList:[],supplierIds:[],param:{supplierIds:[],purchaseOrderNo:"",supplierName:"",buyerId:"",purchaseOrderProductSelectParam:"",refPurchaseOrderNo:"",purchaseOrderStatus:"",purchaseSource:"",WARNING:!1,queryFlag:"",synSwitch:!1},addDialog:{show:!1,type:"add",title:"新增采购订单",param:{forwarderName:"广州仓",deliveWay:"",forwarderCode:"6",warehouseNo:"",warehouseName:"",purchaseSource:"",supplierId:"",freight:"",isUse:"",purchaseOrderNo:"",purchaseOrderProductAddInfos:[{fingoSkuCode:"",purchaseCount:"",purchasePrice:""}]},rules:{forwarderCode:[{required:!0,message:"请选择中转仓",trigger:"change"}],deliveWay:[{required:!0,message:"请选择发货方式",trigger:"change"}],supplierId:[{required:!0,message:"请输入供应商id",trigger:"change"}],freight:[{required:!0,message:"请输入运费",trigger:"change"}],isUse:[{required:!0,message:"请选择是否推送供应商",trigger:"change"}],fingoSkuCode:[{required:!0,message:"请输入fingo商品码",trigger:"change"}],purchaseCount:[{required:!0,message:"请输入实际采购数量",trigger:"change"}],purchasePrice:[{required:!0,message:"请输入采购价格",trigger:"change"}],warehouseNo:[{required:!0,message:"请输入收货仓库",trigger:"change"}]}},editDialog:{confirmPurchase:{show:!1},stockOutDetails:{show:!1},Original:{show:!1},Supplement:{show:!1},cancelnum:{show:!1},show:!1,type:"edit",title:"采购订单编辑",param:{maxCount:"",incomeNum:"",storageCount:"",purchaseOrderNo:"",fingoSkuCode:"",purchaseOrderStatus:"",purchaseSource:"",purchasePrice:"",freight:"",deliveWay:"",forwarderCode:"",systemCount:"",purchaseCount:"",purchaseActualCount:"",logisticsSingle:"",thirdOrderNo:"",supplierId:"",synSwitch:!1,content:"",cancelCount:"",count:"",availableShipCount:"",warehouseName:"",warehouseNo:""}},deliverAlert:{show:!1,purchaseOrderNo:"",fingoSkuCode:"",logisticsSingle:[],synSwitch:!1,param:{logisticsSingleCode:""}},uploadLoading:!1,beginTime:"",endTime:"",exportNoImgLoading:!1,supplierQuery:{supplierName:"",page:{pageSize:20,pageNum:1}}}},computed:{nowEndDate:function(){return this.$store.state.globalNum.nowEndDate},lastMonthDate:function(){return this.$store.state.globalNum.lastMonthDate}},filters:{skuDescFilter:function(e){var t="";if(""===e)t="-";else{var a=JSON.parse(e),r=[];u.a.forEach(a,(function(e){r.push("".concat(e.attrName,": ").concat(e.valueName))})),t=r.join("\n")}return t}},created:function(){-1!==window.location.href.indexOf("?")&&(this.queryData.purchaseOrderNo=window.location.href.split("?")[1].split("=")[1]),this.queryData.purchaseOrderStatus=this.$route.query.purchaseOrderStatus,this.queryData.warehouseNo=this.$route.query.warehouseNo,this.queryData.type=this.$route.query.purchaseType,this.queryData.deliveWay=this.$route.query.deliveWay,this.beginTime=void 0===this.$route.query.lastMonthDate?"":Object(b["b"])(this.$route.query.lastMonthDate),this.endTime=void 0===this.$route.query.nowEndDate?"":Object(b["b"])(this.$route.query.nowEndDate),""!==this.beginTime||""!==this.endTime?this.queryData.timeList=[this.beginTime,this.endTime]:this.queryData.timeList=[this.lastMonthDate,this.nowEndDate],this.$route.query.purchaseOrderNo&&(this.queryData.purchaseOrderNo=this.$route.query.purchaseOrderNo),this.getPurchaseOrderList(),this.getBuyerList(),this.getTransferList(),this.wmsWarehouse(),this.getWarehouseList(),this.getSupplierList("")},mounted:function(){var e=this;this.scrollMonitor(),this.fetchCategory({level:1,cateType:2,resolve:function(t){e.backCategoryOptions=t}})},methods:(r={getBackSubCategory:function(e,t){if(0!=e.level){var a=e.value;this.fetchCategory({pid:parseInt(a),cateType:2,level:e.level+1,resolve:t})}},fetchCategory:function(e){var t=e.id,a=e.cateType,r=e.level,i=e.pid,o=e.page,s=e.resolve;Object(pe["V"])(this.filterData({pid:i,id:t,level:r,cateType:a,page:o})).then((function(e){if(1===e.ret.errcode){for(var t=0;t<e.categoryUnit.length;t++){e.categoryUnit[t]["levelValue"]=[];var i=e.categoryUnit[t].cateNameValue.find((function(e){return"cn"==e.languageCode}));e.categoryUnit[t]["cateName"]=i?i.name:"",e.categoryUnit[t]["leaf"]=2==a?r>2:r>1}s&&s(e.categoryUnit,e)}}))},getSupplierList:function(e){var t=this;this.supplierQuery.supplierName=e,""!=e&&(this.supplierQuery.page.pageNum=1),Object(v["i"])(this.filterData(this.supplierQuery)).then((function(a){1===a.ret.errcode&&(t.supplierLists=e?a.list:t.deleteObject([].concat(Object(l["a"])(t.supplierLists),Object(l["a"])(a.list))))}))},loadMore:function(){""==this.supplierQuery.supplierName&&(this.supplierQuery.page.pageNum++,this.getSupplierList(""))},deleteObject:function(e){for(var t=[],a={},r=0;r<e.length;r++){var i=Object.keys(e[r]);i.sort((function(e,t){return Number(e)-Number(t)}));for(var o="",s=0;s<i.length;s++)o+=JSON.stringify(i[s]),o+=JSON.stringify(e[r][i[s]]);a.hasOwnProperty(o)||(t.push(e[r]),a[o]=!0)}return t=t,t},uploadClick:function(){this.uploadDialog=!0},cancelUpload:function(){this.uploadDialog=!1},getWarehouseList:function(){var e=this,t={page:this.queryData.pageData};Object(m["U"])(this.filterData(t)).then((function(t){1===t.ret.errcode&&(e.warehouseList=t.list)})).catch((function(e){console.log(e)}))},rowClick:function(e,t,a){Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)},this.expands.indexOf(e.purchaseOrderNo)<0?(this.expands=[],this.expands.push(e.purchaseOrderNo)):this.expands.remove(e.purchaseOrderNo)},getRowKeys:function(e){return e.purchaseOrderNo},toggleRowExpansion:function(e){this.setStore("expandNo",e.purchaseOrderNo),this.changeNo!=e.purchaseOrderNo?(this.expands=[],this.expands.push(e.purchaseOrderNo),this.changeNo=e.purchaseOrderNo):(this.expands=[],this.changeNo="")},scrollMonitor:function(){var e=this;this.dom=this.$refs.table.bodyWrapper,this.dom.addEventListener("scroll",(function(){e.scrollTop=e.dom.scrollTop}))},buttonLocation:function(){this.expands.push(this.getStore("expandNo")),this.dom.scrollTop=this.getStore("scrollTop")},getCompanyName:function(e){var t=y["a"].find((function(t){return t.code==e}));return t?t.name:e},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="el-icon-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="el-icon-arrow-up"),this.drop=!this.drop},getBuyerList:function(){var e=this,t={page:{pageNum:1,pageSize:1e3},groupIds:[68,69,70]};Object(g["l"])(t).then((function(t){1===t.ret.errcode&&(e.buyerList=t.sysUserPb)})).catch((function(e){console.log(e)})),console.log(this.buyerList)}},Object(s["a"])(r,"getCompanyName",(function(e){var t=this.logisticsCompany.find((function(t){return t.code==e}));return t?t.name:e})),Object(s["a"])(r,"judgeTime",(function(e){return e.indexOf("订单")<0?"security":"warning"})),Object(s["a"])(r,"judgeStateTwo",(function(e){return 1==e?"warning":"security"})),Object(s["a"])(r,"judgeStateShortage",(function(e){return"STOCKOUT"==e?"warning":"security"})),Object(s["a"])(r,"switchTab",(function(){this.dom.scrollTop=0,this.queryData.incomeStatus=null,this.getPurchaseOrderList(this.tabActive)})),Object(s["a"])(r,"getConfirmPurchaseList",(function(e){var t=this;this.loading=!0;var a=e;Object(h["N"])(a).then((function(e){if(t.loading=!1,1===e.ret.errcode){console.log(e),t.purchaseList=e.list;for(var a=0;a<t.purchaseList.length;a++)t.details=t.purchaseList[a].details}})).catch((function(e){console.log(e),t.loading=!1}))})),Object(s["a"])(r,"getTransferList",(function(){var e=this;Object(m["n"])().then((function(t){1===t.ret.errcode&&(console.log(t),e.transferList=t.twhList)}))})),Object(s["a"])(r,"confirmPurchase",(function(e){this.editDialog.param={purchaseOrderNo:e.purchaseOrderNo,deliveWay:e.deliveWay,warehouseName:e.warehouseName,supplierName:e.supplierName,freight:e.freight,isUseFingoSystem:e.isUseFingoSystem},this.getConfirmPurchaseList(this.editDialog.param);var t=this.transferList.find((function(t){return 1==t.isDefault&&t.deliveWay==e.deliveWay}));t&&Object.assign(this.editDialog.param,{warehouseNo:t.transferId}),this.editDialog.confirmPurchase.show=!0})),Object(s["a"])(r,"confirmAllCancel",(function(e){var t=this;this.$confirm("确认取消此单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.allCancel(e);case 2:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消"})}))})),Object(s["a"])(r,"confirmhandleStockout",(function(e){this.editDialog.param={purchaseOrderNo:e.purchaseOrderNo,skuCode:e.skuCode,productName:e.productName,purchaseCount:e.purchaseCount,productCover:e.productCover,incomeNum:e.incomeNum,cancelCount:e.cancelCount,skuDesc:e.skuDesc,stockoutNum:e.stockoutNum},this.$refs.stockDetail.confirmhandleStockout(),this.editDialog.stockOutDetails.show=!0})),Object(s["a"])(r,"arraySpanMethod",(function(e){var t=e.row,a=(e.column,e.rowIndex,e.columnIndex),r=[0,1,2,3,22,23,24,25,26,27,31],i=r.find((function(e){return e==a}));if(i||0==a)return t.rowspan?{rowspan:t.rowspan,colspan:1}:{rowspan:0,colspan:0}})),Object(s["a"])(r,"resetSearch",(function(){Object.assign(this.queryData,{choseType:"1",value:"",purchaseOrderNo:"",refPurchase_orderNo:"",supplierId:"",supplierName:"",buyerId:"",purchaseOrderStatus:"",type:[],isUseFingoSystem:"",deliveWay:"",startTime:"",endTime:"",orderNo:"",thirdOrderNo:"",productId:"",logiCode:"",productName:"",skuCode:"",refPurchaseOrderNo:"",warehouseNo:"",isWarningSwith:null,timeList:[],incomeStatus:null,cateId:"",page:{pageSize:10,pageNum:1}}),this.getPurchaseOrderList()})),Object(s["a"])(r,"search",(function(){this.getPurchaseOrderList()})),Object(s["a"])(r,"handleSizeChange",(function(e){this.queryData.page.pageSize=e,this.getPurchaseOrderList()})),Object(s["a"])(r,"handleCurrentChange",(function(e){this.queryData.page.pageNum=e,this.getPurchaseOrderList()})),Object(s["a"])(r,"getListnew",(function(){this.getPurchaseOrderList()})),Object(s["a"])(r,"getPurchaseOrderList",(function(){var e=this;this.setStore("scrollTop",this.scrollTop),this.loading=!0;var t=this.queryData;switch(t.tabType=this.tabActive,this.queryData.choseType){case"1":t.skuCode=this.queryData.value,t.productName="",t.thirdOrderNo="",t.productId="";break;case"2":t.productName=this.queryData.value,t.skuCode="",t.thirdOrderNo="",t.productId="";break;case"3":t.thirdOrderNo=this.queryData.value,t.skuCode="",t.productName="",t.productId="";break;case"4":t.productId=this.queryData.value,t.thirdOrderNo="",t.skuCode="",t.productName="";break;default:break}t.incomeStatus=t.incomeStatus?parseInt(t.incomeStatus):null,t.startTime=t.timeList?t.timeList[0]:null,t.endTime=t.timeList?t.timeList[1]:null,this.dataList=[],Object(h["N"])(this.filterData(t)).then((function(t){if(console.log(t),e.loading=!1,1===t.ret.errcode){e.total=t.total,e.dataListNew=t.list;for(var a=t.list,r=0;r<a.length;r++){var i=a[r];if(i.details||(i.details=[]),0==i.details.length)e.dataList.push(Object.assign(i,{rowspan:1,itemKey:r+"_"}));else for(var o=0;o<i.details.length;o++){var n;0==o&&Object.assign(i.details[o],{rowspan:i.details.length}),Object.assign(i.details[o],(n={itemKey:r+"_"+o,purchaseOrderNo:i.purchaseOrderNo,refPurchaseOrderNo:i.refPurchaseOrderNo,supplierName:i.supplierName,buyerId:i.buyerId,buyerName:i.buyerName,purchaseOrderStatus:i.purchaseOrderStatus,purchaseType:i.purchaseType,isUseFingoSystem:i.isUseFingoSystem,warehouseNo:i.warehouseNo,warehouseName:i.warehouseName,retainTime:i.retainTime,freight:i.freight,isUse:i.isUseFingoSystem,deliveWay:i.deliveWay,createTime:i.createTime,updateTime:i.updateTime},Object(s["a"])(n,"purchaseOrderNo",i.purchaseOrderNo),Object(s["a"])(n,"purchaseOrderStatus",i.purchaseOrderStatus),Object(s["a"])(n,"supplierId",i.supplierId),Object(s["a"])(n,"isAbnormalProduct",i.isAbnormalProduct),Object(s["a"])(n,"incomeTime",i.incomeTime),Object(s["a"])(n,"allIncomeTime",i.allIncomeTime),Object(s["a"])(n,"purchaseAmount",i.purchaseAmount),Object(s["a"])(n,"refPurchaseOrderNo",i.refPurchaseOrderNo),Object(s["a"])(n,"details",i.details),Object(s["a"])(n,"isShip",i.isShip),n)),e.dataList.push(i.details[o])}}}else e.$message.error("获取失败！")})).catch((function(t){e.loading=!1,console.log(t)}))})),Object(s["a"])(r,"exportData",(function(e){this.param.purchaseOrderNo=e.purchaseOrderNo,this.timeList=this.timeList||[];var t="".concat("https://back.fingo.shop","/purchaseOrder/export?")+Object(f["d"])(this.filterData(Object.assign(this.param,{supplierIds:this.supplierIds.join(","),beginDate:this.timeList[0]?this.timeList[0]:null,endDate:this.timeList[1]?this.timeList[1]:null})));this.downLoadByUrl(t,"店小秘采购单.xls"),this.param.purchaseOrderNo=""})),Object(s["a"])(r,"exportOutOrderData",(function(){this.timeList=this.timeList||[];var e="".concat("https://back.fingo.shop","/purchaseOrder/shoppingListExport?")+Object(f["d"])(this.filterData(Object.assign(this.param,{supplierIds:this.supplierIds.join(","),beginDate:this.timeList[0]?this.timeList[0]:null,endDate:this.timeList[1]?this.timeList[1]:null}))),t=document.createElement("a");t.href=e,t.click()})),Object(s["a"])(r,"showEditDialog",(function(e,t){this.editDialog.type=t,"edit"==t?this.editDialog.title="采购单编辑":"makeup"==t&&(this.editDialog.title="补采购单"),this.editDialog.param.maxCount=e.stockoutNum,Object.assign(this.editDialog.param,{purchaseOrderNo:e.purchaseOrderNo||"",warehouseNo:e.warehouseNo||"",warehouseName:e.warehouseName||"",skuCode:e.skuCode||"",purchaseOrderStatus:e.purchaseOrderStatus||"",purchaseSource:e.purchaseSource||"",purchasePrice:e.purchasePrice||"",freight:e.freight||"",purchaseType:e.purchaseType||"",isUse:e.isUseFingoSystem||"",deliveWay:e.deliveWay||"",forwarderCode:e.forwarderCode||"",systemCount:e.systemCount||"",purchaseActualCount:e.purchaseActualCount||"",logisticsSingle:e.logisticsSingle||"",thirdOrderNo:e.thirdOrderNo||"",synSwitch:e.synSwitch,purchaseCount:e.purchaseCount,incomeNum:e.incomeNum,cancelCount:e.cancelCount,supplierId:e.supplierId||""}),this.editDialog.show=!0})),Object(s["a"])(r,"showOriginalDialog",(function(e){Object.assign(this.editDialog.param,{purchaseOrderNo:e.purchaseOrderNo||"",skuCode:e.skuCode||""}),this.$refs.originalDetail.getOrderDetail(),this.editDialog.Original.show=!0})),Object(s["a"])(r,"showCancelnum",(function(e){this.editDialog.param={purchaseOrderNo:e.purchaseOrderNo,supplierId:e.supplierId,supplierName:e.supplierName,skuCode:e.skuCode,systemCount:e.systemCount,purchaseCount:e.purchaseCount,incomeNum:e.incomeNum,shipCount:e.shipCount,cancelCount:e.cancelCount,count:e.stockoutNum},this.editDialog.cancelnum.show=!0})),Object(s["a"])(r,"showDialog",(function(e,t){if(this.addDialog.title="新增采购单",this.addDialog.type=e,Object.assign(this.addDialog.param,{purchaseOrderStatus:"",purchaseOrderNo:"",supplierId:"",freight:"",isUse:1,forwarderName:"广州仓",deliveWay:"",forwarderCode:"6",purchaseOrderProductAddInfos:[]}),console.log(this.addDialog.param),"edit"==e){this.addDialog.title="编辑采购单",this.addDialog.param.purchaseOrderNo=t.purchaseOrderNo,this.addDialog.param.thirdOrderNo=t.thirdOrderNo,this.addDialog.param.supplierId=t.supplierId,this.addDialog.param.freight=t.freight,this.addDialog.param.purchaseType=t.purchaseType,this.addDialog.param.isUse=t.isUseFingoSystem,this.addDialog.param.purchaseSource=t.purchaseSource,this.addDialog.param.forwarderCode=t.forwarderCode,this.addDialog.param.forwarderName=t.forwarderName,this.addDialog.param.deliveWay=t.deliveWay,this.addDialog.param.warehouseNo=t.warehouseNo,this.addDialog.param.warehouseName=t.warehouseName;for(var a=0;a<t.details.length;a++){var r=t.details[a];this.addDialog.param.purchaseOrderProductAddInfos.push({skuCode:r.skuCode,purchaseCount:r.purchaseCount,purchasePrice:r.productPurchasePrice,thirdOrderNo:r.refPurchaseOrderNo})}}console.log(this.addDialog.param),this.addDialog.show=!0})),Object(s["a"])(r,"clickToExportOrder",(function(){if(this.timeList&&2===this.timeList.length){var e=new Date(this.timeList[1])-new Date(this.timeList[0]),t=Math.floor(e/864e5);if(!this.hasPermission("BTN_PURCHASE_LIST_EXPORT")&&t>7)this.$message({type:"warning",message:"导出日期范围最多7天"});else{var a="".concat("https://back.fingo.shop","/purchaseOrder/purchaseOrderExport?")+Object(f["d"])(this.filterData(Object.assign(this.param,{startTime:this.timeList[0],endTime:this.timeList[1]}))),r=document.createElement("a");r.href=a,r.click()}}else this.$message({type:"warning",message:"请选择导出日期范围"})})),Object(s["a"])(r,"formatSeconds",(function(e){return Object(f["b"])(e)})),Object(s["a"])(r,"showDeliver",(function(e,t){if(this.deliver.param.purchaseOrderNo=e.purchaseOrderNo,this.deliver.ships=[],1==t){if(e.availableShipCount<=0)return this.$message.warning("未发货数量小于零,不可发货");this.deliver.ships.push({supplierId:e.supplierId,skuCode:e.skuCode,purchaseOrderNo:e.purchaseOrderNo,availableShipCount:e.availableShipCount,logiList:[{logisticsType:"DOMESTIC",logiCompany:"",logiCode:"",count:e.availableShipCount}]})}else{for(var a=0;a<e.details.length;a++)e.details[a].availableShipCount>0&&this.deliver.ships.push({supplierId:e.details[a].supplierId,skuCode:e.details[a].skuCode,purchaseOrderNo:e.details[a].purchaseOrderNo,availableShipCount:e.details[a].availableShipCount,logiList:[{logisticsType:"DOMESTIC",logiCompany:"",logiCode:"",count:e.details[a].availableShipCount}]});if(this.deliver.ships.length<=0)return this.$message.warning("未发货数量小于零,不可发货")}this.deliver.show=!0})),Object(s["a"])(r,"handleSizeChanges",(function(e,t){switch(this[t].param.pageSize=e,t){case"List":break}})),Object(s["a"])(r,"handleCurrentChanges",(function(e,t){switch(this[t].param.pageNum=e,t){case"List":break}})),Object(s["a"])(r,"clickToExportexportShip",(function(){var e="".concat("https://back.fingo.shop","/purchaseOrder/exportShipTemplate?")+Object(f["d"])(this.filterData(Object.assign(this.param,{supplierIds:this.supplierIds.join(","),pageNum:this.page,pageSize:this.pageSize,beginDate:this.timeList?this.timeList[0]:null,endDate:this.timeList?this.timeList[1]:null})));this.downLoadByUrl(e,"采购订单发货导出.xls")})),Object(s["a"])(r,"uploadError",(function(e){console.log(e),this.importLoading=!1})),Object(s["a"])(r,"uploadBefore",(function(){this.importLoading=!0})),Object(s["a"])(r,"handleStockout",(function(e){var t=this;this.loading=!0;var a={purchaseOrderNo:e.purchaseOrderNo,skuCode:e.skuCode,supplierId:e.supplierId};Object(h["R"])(a).then((function(e){1===e.ret.errcode?(t.getPurchaseOrderList(),t.loading=!1,t.$message.success("操作成功")):(t.loading=!1,t.$message.error(e.message))})).catch((function(e){t.loading=!1,console.log(e)}))})),Object(s["a"])(r,"handleEditSingleSku",(function(e){var t=this;console.log(e),this.loading=!0;var a={purchaseOrderNo:e.purchaseOrderNo,skuCode:e.skuCode,purchaseCount:Number(e.purchaseCount),purchasePrice:e.purchasePrice,thirdOrderNo:e.thirdOrderNo,freight:e.freight};Object(h["Q"])(this.filterData(a)).then((function(e){t.editDialog.show=!1,1===e.ret.errcode?(t.$message.success("更新成功！"),t.getPurchaseOrderList()):t.$message.error(e.message)})).catch((function(e){t.editDialog.show=!1,console.log(e)}))})),Object(s["a"])(r,"handleSingleMakeup",(function(e){var t=this;this.editDialog.show=!0;var a={purchaseOrderNo:e.purchaseOrderNo,skuCode:e.skuCode,supplierId:e.supplierId,purchaseCount:e.purchaseCount,purchasePrice:e.purchasePrice,thirdOrderNo:e.thirdOrderNo,freight:e.freight};Object(h["P"])(this.filterData(a)).then((function(e){t.editDialog.show=!1,1===e.ret.errcode?(t.$message.success("补单成功！"),t.getPurchaseOrderList()):t.$message.error(e.message)})).catch((function(e){t.editDialog.show=!1,console.log(e)}))})),Object(s["a"])(r,"handleStockOutDetails",(function(e){var t=this;this.stockOutDetails.show=!0;var a={purchaseOrderNo:e.purchaseOrderNo,skuCode:e.skuCode,count:e.count};Object(h["z"])(this.filterData(a)).then((function(e){t.stockOutDetails.show=!1,1===e.ret.errcode?(t.$message.success("缺货成功！"),t.getPurchaseOrderList()):t.$message.error(e.message)})).catch((function(e){t.stockOutDetails.show=!1,console.log(e)}))})),Object(s["a"])(r,"handleConfirmCancelPurchaseNum",(function(e){var t=this;this.loading=!0;var a={purchaseOrderNo:e.purchaseOrderNo,skuCode:e.skuCode,cancelCount:e.count};Object(h["M"])(this.filterData(a)).then((function(e){t.loading=!1,1===e.ret.errcode?(t.editDialog.cancelnum.show=!1,t.$message.success("操作成功！"),t.getPurchaseOrderList()):t.$message.error(e.message)})).catch((function(e){t.loading=!1,console.log(e)}))})),Object(s["a"])(r,"editEntireOrder",(function(e){Object.assign(this.addDialog.param,{purchaseOrderNo:"",supplierId:"",freight:"",purchaseType:"",isUse:null,forwarderName:"广州仓",deliveWay:"",forwarderCode:"6",purchaseOrderProductAddInfos:[]}),this.addDialog.param.type="editEntireOrder",this.addDialog.title="编辑采购单",this.addDialog.param.purchaseOrderNo=e.purchaseOrderNo,this.addDialog.param.thirdOrderNo=e.thirdOrderNo,this.addDialog.param.supplierId=e.supplierId,this.addDialog.param.freight=e.freight,this.addDialog.param.purchaseType=e.purchaseType,this.addDialog.param.isUse=e.isUseFingoSystem,this.addDialog.param.purchaseSource=e.purchaseSource,this.addDialog.param.forwarderCode=e.forwarderCode,this.addDialog.param.forwarderName=e.forwarderName,this.addDialog.param.deliveWay=e.deliveWay,this.addDialog.param.warehouseNo=e.warehouseNo,this.addDialog.param.warehouseName=e.warehouseName,this.addDialog.param.purchaseOrderStatus=e.purchaseOrderStatus;for(var t=0;t<e.details.length;t++){var a=e.details[t];this.addDialog.param.purchaseOrderProductAddInfos.push({skuCode:a.skuCode,purchaseCount:a.purchaseCount,purchasePrice:a.purchasePrice,thirdOrderNo:a.thirdOrderNo})}console.log(this.addDialog),this.addDialog.show=!0})),Object(s["a"])(r,"exportEntireOrder",(function(e){var t=this;this.loading=!0;var a={purchaseOrderNo:e.purchaseOrderNo};Object(h["E"])(a).then((function(e){if(t.loading=!1,1===e.ret.errcode){var a=e.fileUrl;window.open(t.dealShowFileSrc(a))}else t.$message.error(e.message)})).catch((function(e){t.loading=!1,console.log(e)}))})),Object(s["a"])(r,"ensurePurchase",(function(e){var t=this,a={purchaseOrderNo:e.purchaseOrderNo};Object(h["C"])(a).then((function(e){1===e.ret.errcode?(t.$message.success("采购成功！"),t.getPurchaseOrderList()):t.$message.error(e.message)})).catch((function(e){console.log(e)}))})),Object(s["a"])(r,"allCancel",(function(e){var t=this,a={purchaseOrderNo:e.purchaseOrderNo};Object(h["A"])(a).then((function(e){console.log(e),1===e.ret.errcode?(t.$message.success("整单取消成功！"),t.getPurchaseOrderList()):"EXTERNAL_PURCHASE_UN_PAY"===tabActive?t.$confirm("1688取消订单失败，请人工取消或退款。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}):"EXTERNAL_UN_PURCHASE"===tabActive?t.$confirm("采购单已取消，但第三方系统取消订单失败，请务必人工登录对方系统操作取消订单或退款。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}):t.$message.error(e.message)})).catch((function(e){console.log(e)}))})),Object(s["a"])(r,"showPurchaseOrderDetail",(function(e){this.List.show=!0,this.List.purchaseOrderNo=e.purchaseOrderNo;var t,a=he(e.details);try{for(a.s();!(t=a.n()).done;){var r=t.value;this.$refs.purchaseOrderDetail.getAllSkuDeliveryDetail(r.skuCode)}}catch(n){a.e(n)}finally{a.f()}var i,o=he(e.details);try{for(o.s();!(i=o.n()).done;){var s=i.value;this.$refs.purchaseOrderDetail.getAllSkuAbnormalDetail(s.skuCode)}}catch(n){o.e(n)}finally{o.f()}this.$refs.purchaseOrderDetail.getPurchaseOrderDetail(),this.$refs.purchaseOrderDetail.getPurchaseLogiList(),this.$refs.purchaseOrderDetail.getPurchaseAssociatedOrderList(),this.$refs.purchaseOrderDetail.getPurchaseStatusRate()})),Object(s["a"])(r,"exportPurchaseOrder",(function(e){var t=this,a=this.queryData;a.startTime=a.timeList?a.timeList[0]:null,a.endTime=a.timeList?a.timeList[1]:null,new Date(a.endTime).getTime()-new Date(a.startTime).getTime()<80352e5?("noImg"===e?(this.exportNoImgLoading=!0,a.exportImg=2):(this.exportLoading=!0,a.exportImg=1),Object(h["F"])(this.filterData(a)).then((function(e){1===e.ret.errcode?(t.exportLoading=!1,t.exportNoImgLoading=!1,t.$message.success("导出任务已建，请前往采购中心-任务列表下载")):(t.exportLoading=!1,t.exportNoImgLoading=!1,t.$message.error(e.message))})).catch((function(e){t.exportLoading=!1,console.log(e)}))):("noImg"===e?(this.exportNoImgLoading=!0,setTimeout((function(){t.exportNoImgLoading=!1}),2e3)):(this.exportLoading=!0,setTimeout((function(){t.exportLoading=!1}),2e3)),this.$message.warning("仅支持导出三个月的采购单数据，请调整创建时间"))})),Object(s["a"])(r,"exportShipOrder",(function(){var e=this;this.exportLoading=!0;var t=this.queryData;t.startTime=t.timeList?t.timeList[0]:null,t.endTime=t.timeList?t.timeList[1]:null,Object(h["D"])(this.filterData(t)).then((function(t){if(1===t.ret.errcode){e.exportLoading=!1;var a=t.fileUrl;window.open(e.dealShowFileSrc(a))}else e.exportLoading=!1,e.$message.error(t.message)})).catch((function(t){e.exportLoading=!1,console.log(t)}))})),Object(s["a"])(r,"uploadFile",(function(e){var t=this;this.uploadLoading=!0;var a=new FormData,r={fileName:e.file.name,type:"other"};a.append("file",e.file),a.append("param",JSON.stringify(r));var i="/file/rest/uploadservices/uploadfile";Object(d["a"])(i,a).then((function(e){"600"===e.status?t.importShipRequest(e.original_link):(t.$message.error("文件上传失败，请重试！"),t.uploadLoading=!1)})).catch((function(e){console.log(e)}))})),Object(s["a"])(r,"importShipRequest",(function(e){var t=this,a={fileUrl:e};Object(h["L"])(a).then((function(e){t.uploadLoading=!1,1===e.ret.errcode?(t.$message.success("导入成功"),t.getPurchaseOrderList()):t.$message.error("导入失败，请重试")})).catch((function(e){console.log(e),t.uploadLoading=!1}))})),r)},ve=fe,be=(a("4af2"),a("e7c0"),Object(S["a"])(ve,i,o,!1,null,"322ac583",null));t["default"]=be.exports},"9e53":function(e,t,a){},a3fb:function(e,t,a){},aeaf:function(e,t,a){"use strict";var r=a("87cf"),i=a.n(r);i.a},b4d7:function(e,t,a){},d48a:function(e,t,a){"use strict";var r=a("a3fb"),i=a.n(r);i.a},d5e8:function(e,t,a){"use strict";var r=a("9e53"),i=a.n(r);i.a},d984:function(e,t,a){},e5dc:function(e,t,a){"use strict";var r=a("e84b"),i=a.n(r);i.a},e7c0:function(e,t,a){"use strict";var r=a("571c"),i=a.n(r);i.a},e84b:function(e,t,a){},fe2d:function(e,t,a){"use strict";var r=a("d984"),i=a.n(r);i.a}}]);