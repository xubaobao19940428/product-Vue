(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dc8616c2"],{"0e45":function(e,t,a){},2148:function(e,t,a){"use strict";var n=a("3f15"),r=a.n(n);r.a},"3f15":function(e,t,a){},7647:function(e,t,a){},"7bf4":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"multi-upload-box"},[a("div",{staticClass:"multi-upload-show",on:{click:function(t){e.showDialog=!0}}},[a("div",[a("i",{staticClass:"el-icon-plus"}),a("img",{attrs:{src:e.getCnImgCover()}})])]),a("el-dialog",{attrs:{title:"添加多语言图片",width:"700px","append-to-body":"",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t},close:function(t){e.showDialog=!1}}},[a("div",{staticClass:"multi-upload-wrapper"},[a("div",{staticClass:"all-tip"},[a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:e.handleSameAll}},[e._v("同步所有")]),e._v(" *将当前图片同步到其他所有语言项（已上传的会被覆盖）\n            ")],1),a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleTabChange},model:{value:e.curLanguage,callback:function(t){e.curLanguage=t},expression:"curLanguage"}},e._l(e.languageList,(function(t,n){return a("el-tab-pane",{key:n,attrs:{name:t.code}},[a("span",{attrs:{slot:"label"},slot:"label"},["cn"==t.code||"en"==t.code?a("i",{staticClass:"required"},[e._v("*")]):e._e(),e._v(" "+e._s(t.desc))]),a("div",{staticClass:"upload-tips"},[a("span",[e._v("上传图片：")]),a("em",[e._v("支持上传.jpg/.png/.gif格式的文件，请保持各语言版本一致")])]),e.showDialog&&e.curLanguage===t.code?a("c-upload",{attrs:{limit:e.limit,accept:e.accept,refsName:t.code+"fileUpload",fileList:e.curImgUrl,getType:e.getType,signCode:t.code},on:{setData:e.setFileList}}):e._e(),a("div",{staticClass:"all-tip"},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.handleSameEmpty}},[e._v("同步至未上传图片项")]),e._v(" *将当前图片同步到其他未上传图片的语言项\n                    ")],1)],1)})),1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)])],1)},r=[],i=(a("20d6"),a("ac6a"),a("28a5"),a("7f7f"),a("7514"),a("c5f6"),a("f09b")),o={props:{propFileList:{type:Array,default:function(){return[]}},limit:{type:Number,default:1},accept:String,getType:String},data:function(){return{param:{name:""},showDialog:!1,rules:{name:[{required:!0,message:"不能为空",trigger:"change"}]},fileList:[],curLanguage:"cn",curImgUrl:""}},watch:{propFileList:{handler:function(e){var t=this;console.log(e),e&&this.$nextTick((function(){t.fileList=JSON.parse(JSON.stringify(e)),t.handleTabChange()}))},deep:!0}},components:{cUpload:i["a"]},computed:{languageList:function(){return this.$store.state.dict.languageList}},created:function(){this.fileList=JSON.parse(JSON.stringify(this.propFileList)),this.handleTabChange()},methods:{handleTabChange:function(){var e=this,t=this.fileList.find((function(t){return t.languageCode===e.curLanguage}));this.curImgUrl=t?t.name:""},getCnImgCover:function(){var e=this.propFileList.find((function(e){return"cn"==e.languageCode}));return e?this.dealShowFileSrc(e.name.split(",")[0]):""},handleSameAll:function(){var e=this;this.curImgUrl?(this.fileList=[],this.languageList.forEach((function(t){e.fileList.push({languageCode:t.code,name:e.curImgUrl})})),this.$message.success("同步成功")):this.$message.warning("请先上传当前项的图片")},handleSameEmpty:function(){var e=this;this.curImgUrl?(this.languageList.forEach((function(t){var a=e.fileList.findIndex((function(e){return e.languageCode==t.code}));-1===a&&e.fileList.push({languageCode:t.code,name:e.curImgUrl})})),this.$message.success("同步成功")):this.$message.warning("请先上传当前项的图片")},setFileList:function(e){console.log(e);var t=this.fileList.findIndex((function(t){return t.languageCode==e.signCode}));-1!=t?this.fileList[t].name=e.data:this.fileList.push({languageCode:e.signCode,name:e.data}),this.handleTabChange()},getCurrentLangFile:function(e){var t=this.fileList.find((function(t){return t.languageCode==e}));return t?t.name:""},handleClose:function(){this.fileList=JSON.parse(JSON.stringify(this.propFileList)),this.curLanguage="cn",this.handleTabChange(),this.showDialog=!1},confirm:function(){var e=this.fileList.filter((function(e){return"cn"==e.languageCode&&e.name||"en"==e.languageCode&&e.name}));if(e.length<2)return this.$message.warning("中文和英文图片不能为空");this.showDialog=!1,this.$emit("setData",this.fileList)}}},c=o,s=(a("ce00"),a("2877")),l=Object(s["a"])(c,n,r,!1,null,"423ff198",null);t["a"]=l.exports},a13d:function(e,t,a){"use strict";var n=a("7647"),r=a.n(n);r.a},ce00:function(e,t,a){"use strict";var n=a("0e45"),r=a.n(n);r.a},da71:function(e,t,a){"use strict";a("6762"),a("ac6a"),a("456d"),a("55dd");var n=a("ed08"),r=a("5c96"),i=a("8237"),o="https://shg.fingo.shop/api/proxyboss",c=[],s=window.axios.create({timeout:45e3});function l(e){var t=e.method,a=e.serverName,l=e.interfaceName,u=e.data,d=e.$header,m=e.baseUrl,f=e.noToast,g=e.timeoutNoToast,p=u?JSON.parse(JSON.stringify(u)):{},h=(new Date).getTime();Object.assign(p,{timestamp:h});var v=i(Object(n["d"])(Object.keys(p).sort())),b=localStorage.adminUserInfo?JSON.parse(localStorage.adminUserInfo):null,y={"Content-Type":"application/json;charset=utf-8","Language-Code":"cn","Operator-ID":b?b.id:null,"Device-Type":"boss",Signature:v,serverName:a,interfaceName:l,"Country-Code":"MY"};return d&&Object.assign(y,d),Object.assign(u,{sign:v,operationId:b?b.id:null,timestamp:h,operation:b?b.account:""}),console.log("".concat(l)),console.log(u),s({url:m||o,method:t||"post",data:u,headers:y}).then((function(e){if(console.log("".concat(l)),console.log(e.data),200!==e.status){var t=new Error("服务器异常");throw t}var a=e.data;if(0===a.ret.errCode)return a;if(c.includes(a.ret.errCode))console.log("errcode, 特殊处理");else{var n=a.ret.msg?a.ret.msg:a.ret.errName;if(g&&-1===a.ret.errCode)return a;f||r["Message"].warning(n||"哇哦，服务器出错啦，请稍候再试~")}return a})).catch((function(e){throw r["Message"].warning("哇哦，服务器出错啦，请稍候再试~"),e}))}t["a"]=l},dc82:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"m",(function(){return i})),a.d(t,"B",(function(){return o})),a.d(t,"d",(function(){return c})),a.d(t,"l",(function(){return s})),a.d(t,"w",(function(){return l})),a.d(t,"a",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"g",(function(){return m})),a.d(t,"o",(function(){return f})),a.d(t,"t",(function(){return g})),a.d(t,"c",(function(){return p})),a.d(t,"k",(function(){return h})),a.d(t,"i",(function(){return v})),a.d(t,"f",(function(){return b})),a.d(t,"n",(function(){return y})),a.d(t,"p",(function(){return w})),a.d(t,"b",(function(){return N})),a.d(t,"h",(function(){return C})),a.d(t,"C",(function(){return S})),a.d(t,"r",(function(){return O})),a.d(t,"v",(function(){return k})),a.d(t,"x",(function(){return I})),a.d(t,"s",(function(){return j})),a.d(t,"y",(function(){return L})),a.d(t,"q",(function(){return _})),a.d(t,"z",(function(){return x})),a.d(t,"A",(function(){return D})),a.d(t,"D",(function(){return P})),a.d(t,"u",(function(){return T}));var n=a("da71");function r(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IConfigService.AddOrEdit",data:e})}function i(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IConfigService.GetByKeyword",data:e})}function o(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IProductService.QueryByPage",data:e})}function c(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IProductService.Add",data:e})}function s(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IProductService.Edit",data:e})}function l(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IProductService.RemoveById",data:e})}function u(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IBoxService.Add",data:e})}function d(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IBoxService.Edit",data:e})}function m(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IBoxService.RemoveById",data:e})}function f(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IBoxService.QueryByPage",data:e})}function g(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IPrizeService.Query",data:e})}function p(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IPrizeService.Add",data:e})}function h(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IPrizeService.Edit",data:e})}function v(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IPrizeService.RemoveById",data:e})}function b(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IRuleBoxService.BonusPoolsUpdate",data:e,noToast:!0})}function y(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IBoxService.Query",data:e})}function w(e){return Object(n["a"])({serverName:"market-gold",interfaceName:"IRuleService.QueryByPage",data:e})}function N(e){return Object(n["a"])({serverName:"market-gold",interfaceName:"IRuleService.Add",data:e})}function C(e){return Object(n["a"])({serverName:"market-gold",interfaceName:"IRuleService.RemoveById",data:e})}function S(e){return Object(n["a"])({serverName:"market-gold",interfaceName:"IRuleService.Edit",data:e})}function O(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IRuleService.Query",data:e})}function k(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IRuleService.RemoveById",data:e})}function I(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IRuleService.BathAdd",data:e})}function j(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IRuleBoxService.QueryBath",data:e})}function L(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IRuleBoxService.BathAdd",data:e,timeoutNoToast:!0})}function _(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IActivityService.QueryByPage",data:e})}function x(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IActivityService.BathAdd",data:e})}function D(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IActivityService.Add",data:e})}function P(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IActivityService.Edit",data:e})}function T(e){return Object(n["a"])({serverName:"market-center",interfaceName:"IActivityService.RemoveById",data:e})}},f75c:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"raffle-operator-wrapper app-container"},[a("div",{staticClass:"raffle-operator__header"},[a("h5",[e._v(e._s("add"===e.type?"新建抽奖":"编辑抽奖"))])]),a("div",{staticClass:"raffle-operatore__content"},[a("el-form",[a("el-card",{staticClass:"card-common"},[a("div",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[e._v("奖池设置")]),a("el-form-item",{staticClass:"is-required",attrs:{label:"奖池清单："}},[a("div",{staticClass:"tip"},[e._v("请将用户抽奖可能出现的所有结果（含未中奖的反馈）列举在下方；奖品清单允许修改且每次投放时系统将以最新为准")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],style:{width:"90%"},attrs:{data:e.luckPrizeInfo,"header-cell-style":{background:"#F5F7FA",color:"#606266"},border:"","show-summary":""}},[a("el-table-column",{attrs:{label:"奖品ID",align:"center",prop:"id"}}),a("el-table-column",{attrs:{label:"奖品名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                "+e._s(e.formatItem(t.row.name))+"\n                            ")]}}])}),a("el-table-column",{attrs:{label:"奖品类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                "+e._s(e.luckPrizeTypeMap[t.row.type])+"\n                            ")]}}])}),a("el-table-column",{attrs:{label:"奖品值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                "+e._s(t.row.content)+"\n                            ")]}}])}),a("el-table-column",{attrs:{label:"图片",align:"center","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("img",{staticClass:"previewImage",attrs:{src:e.dealShowFileSrc(e.formatItem(t.row.icon))}}),a("img",{staticClass:"thumbnail",attrs:{slot:"reference",src:e.dealShowFileSrc(e.formatItem(t.row.icon))},slot:"reference"})])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-edit icon mr10",on:{click:function(a){return e.handleEdit(t.row,t.$index)}}}),a("i",{staticClass:"el-icon-close icon",on:{click:function(a){return e.handleDelete(t.row,t.$index)}}})]}}])})],1),a("el-button",{attrs:{type:"text"},on:{click:e.handleAdd}},[e._v("再加一种奖品")])],1)],1)],1)],1),a("div",{staticClass:"raffle-operator__footer"},[a("el-button",{staticClass:"foot-btn",attrs:{type:"primary"},on:{click:e.handleCancel}},[e._v("返 回")])],1),e.awardShow?a("award-dialog",{attrs:{luckPrizeTypeMap:e.luckPrizeTypeMap,"dialog-visible":e.awardShow,awardData:e.awardData,countryCode:e.countryCode,boxId:e.boxId,awardType:e.awardType},on:{close:function(t){e.awardShow=!1},save:e.handlePrizeItemSave}}):e._e()],1)},r=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),o=a("5880"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"award-manage-dialog",attrs:{title:"奖品管理",width:"650px",visible:e.dialogVisible,"close-on-click-modal":!1},on:{close:e.handleClose}},[a("el-form",{ref:"awardManageForm",attrs:{"label-width":"100px","label-position":"right",model:e.param,rules:e.rules}},[a("el-form-item",{attrs:{label:"选择类型：",prop:"type"}},[a("el-select",{staticStyle:{width:"90%"},attrs:{disabled:"edit"===e.awardType},model:{value:e.param.type,callback:function(t){e.$set(e.param,"type",t)},expression:"param.type"}},e._l(e.luckPrizeTypeMap,(function(e,t){return a("el-option",{key:t,attrs:{value:parseInt(t),label:e}})})),1)],1),a("el-form-item",{attrs:{label:"奖品名称：",prop:"name"}},[a("ul",{staticClass:"lang-list"},e._l(e.param.name,(function(t,n){return a("li",{key:n,staticClass:"flex mar-b-10"},[a("span",{staticClass:"text label-title"},[e._v(e._s(e.getLangName(n))+"：")]),a("el-input",{staticClass:"flex1",model:{value:e.param.name[n],callback:function(t){e.$set(e.param.name,n,t)},expression:"param.name[key]"}})],1)})),0)]),1==e.param.type?a("el-form-item",{attrs:{label:"优惠券ID：",prop:"content"}},[a("el-input",{model:{value:e.param.content,callback:function(t){e.$set(e.param,"content",t)},expression:"param.content"}})],1):2==e.param.type?a("el-form-item",{attrs:{label:"积分金额：",prop:"content"}},[a("el-input",{model:{value:e.param.content,callback:function(t){e.$set(e.param,"content",t)},expression:"param.content"}})],1):3==e.param.type?a("el-form-item",{attrs:{label:"商品ID：",prop:"content"}},[a("el-input",{model:{value:e.param.content,callback:function(t){e.$set(e.param,"content",t)},expression:"param.content"}})],1):e._e(),a("el-form-item",{attrs:{label:"图片："}},[a("multi-lang-file-upload",{attrs:{propFileList:e.imgList},on:{setData:e.setImg}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small",loading:e.pending},on:{click:e.handleConfirm}},[e._v("确 定")])],1)],1)},s=[],l=(a("7514"),a("7f7f"),a("c5f6"),a("7bf4")),u=a("dc82"),d={props:{dialogVisible:Boolean,awardData:Object,luckPrizeTypeMap:[Array,Object],awardType:String,countryCode:String,boxId:[String,Number]},components:{multiLangFileUpload:l["a"]},data:function(){return{param:{type:1,content:"",name:{},icon:""},imgList:[],pending:!1,rules:{type:[{required:!0,message:"必填",trigger:"change"}],content:[{validator:function(e,t,a){var n=/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/;console.log(!n.test(t)),t.length<0?a(new Error("不能为空")):n.test(t)?a():a(new Error("请输入合法数字"))}}],name:[{required:!0,message:"必填",trigger:"change"}]}}},computed:{languageList:function(){return this.$store.state.dict.languageList}},mounted:function(){if(this.awardData&&Object.keys(this.awardData).length>0){Object.assign(this.param,this.awardData),this.param.name=JSON.parse(this.param.name);var e=JSON.parse(this.param.icon);for(var t in e)this.imgList.push({languageCode:t,name:e[t]})}this.init()},methods:{init:function(){for(var e=0;e<this.languageList.length;e++){var t=this.languageList[e].code,a=this.param.name[t];a||this.$set(this.param.name,t,"")}},getLangName:function(e){var t=this.languageList.find((function(t){return t.code==e}));return t?t.desc:""},setImg:function(e){this.imgList=e},handleClose:function(){this.$emit("close")},handleConfirm:function(){var e=this;if(!this.param.name["cn"]||!this.param.name["en"])return this.$message.warning("中英文奖品名称不能为空");var t=this.imgList.filter((function(e){return"cn"==e.languageCode&&e.name||"en"==e.languageCode&&e.name}));if(t.length<2)return this.$message.warning("中英文图片不能为空");for(var a={},n=0;n<this.imgList.length;n++)this.imgList[n].name&&(a[this.imgList[n].languageCode]=this.imgList[n].name);var r=JSON.parse(JSON.stringify(this.param));r.name=this.filterData(r.name),r.icon=JSON.stringify(this.filterData(a)),r.countryCode=this.countryCode,r.boxId=this.boxId,this.$refs.awardManageForm.validate((function(t){if(t){var a=u["c"];"edit"==e.awardType&&(a=u["k"]),e.pending=!0,a(e.filterData(r)).then((function(t){e.pending=!1,0===t.ret.errCode&&e.$emit("save")})).catch((function(){e.pending=!1}))}}))}}},m=d,f=(a("2148"),a("2877")),g=Object(f["a"])(m,c,s,!1,null,"5facb332",null),p=g.exports;function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b={data:function(){return{type:"",luckPrizeTypeMap:{1:"优惠券",2:"积分",3:"商品"},luckPrizeInfo:[],awardShow:!1,boxId:null,awardType:"add",countryCode:"MY",awardData:{},loading:!1}},components:{awardDialog:p},created:function(){var e=this.$route.query||{};this.type=e.type,e.id&&(this.boxId=e.id,this.getDetail()),this.countryCode=e.countryCode?e.countryCode:"MY"},computed:v({},Object(o["mapState"])({countryList:function(e){return e.dict.countryList},languageList:function(e){return e.dict.languageList}})),methods:{handleCancel:function(){this.$router.push({name:"shake",query:{curTab:"prizeProduct"}})},formatItem:function(e){var t=JSON.parse(e);return t["cn"]?t["cn"]:t["en"]},handleAdd:function(){this.awardData={},this.awardShow=!0,this.awardType="add"},handleEdit:function(e){this.awardData=e,this.awardShow=!0,this.awardType="edit"},handleDelete:function(e,t){var a=this;this.$confirm("是否删除该奖品","提示",{type:"warning"}).then((function(){Object(u["i"])({id:e.id}).then((function(e){0===e.ret.errCode&&a.luckPrizeInfo.splice(t,1)}))})).catch((function(){a.$message("已取消删除")}))},getDetail:function(){var e=this;this.loading=!0,Object(u["t"])({boxId:this.boxId}).then((function(t){e.loading=!1,0===t.ret.errCode&&(e.luckPrizeInfo=t.data)})).catch((function(){e.loading=!1}))},handlePrizeItemSave:function(){this.awardShow=!1,this.getDetail()}}},y=b,w=(a("a13d"),Object(f["a"])(y,n,r,!1,null,"67d11093",null));t["default"]=w.exports}}]);