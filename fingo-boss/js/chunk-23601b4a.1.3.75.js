(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23601b4a"],{"03b7":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"work-order-dialog",attrs:{title:"关闭工单",width:"700px",visible:e.showDialog},on:{close:function(t){return e.closeDialog()}}},[a("common-detail",{attrs:{workOrderNo:e.workOrderNo,collapseArray:e.collapseArray}}),a("el-collapse",{model:{value:e.collapseArray,callback:function(t){e.collapseArray=t},expression:"collapseArray"}},[a("el-collapse-item",{attrs:{title:"操作",name:"4"}},[a("el-form",{ref:"closeWorkOrder",attrs:{"label-width":"80px",rules:e.rules,model:e.params}},[a("el-form-item",{attrs:{label:""}},[a("el-radio-group",{on:{change:e.clearValidate},model:{value:e.dealType,callback:function(t){e.dealType=t},expression:"dealType"}},e._l(e.typeList,(function(t,r){return a("el-radio",{key:r,attrs:{label:r}},[e._v(e._s(t))])})),1)],1),0==e.dealType?a("el-form-item",{attrs:{label:"跟进补充：",prop:"dealConetent"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入跟进补充",rows:2},model:{value:e.params.dealConetent,callback:function(t){e.$set(e.params,"dealConetent",t)},expression:"params.dealConetent"}})],1):a("el-form-item",{attrs:{label:"关闭备注："}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入关闭备注",maxLength:"2000",rows:2},model:{value:e.params.dealConetent,callback:function(t){e.$set(e.params,"dealConetent",t)},expression:"params.dealConetent"}})],1),a("el-form-item",{attrs:{label:"上传附件："}},[e.showDialog?a("c-upload",{attrs:{fileList:e.params.dealPic,limit:30,listType:"text"},on:{setData:e.setCoverImg}}):e._e()],1),1==e.dealType?a("el-form-item",{attrs:{label:"抄送："}},[a("el-select",{attrs:{"remote-method":e.getAdminUserList,placeholder:"请选择",size:"medium",clearable:"",filterable:"",remote:""},model:{value:e.params.ccManagerId,callback:function(t){e.$set(e.params,"ccManagerId",t)},expression:"params.ccManagerId"}},e._l(e.adminUserList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.realName,value:e.id}})})),1)],1):e._e()],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog()}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmCloseItem}},[e._v("确 定")])],1)],1)},o=[],l=a("f1ca"),s=a("6d47"),i=a("403c"),n=a("f09b"),c={props:{showDialog:{type:Boolean,default:!1},collapseArray:Array,workOrderNo:String},mixins:[i["a"]],components:{commonDetail:l["a"],cUpload:n["a"]},data:function(){return{params:{dealConetent:"",dealPic:"",ccManagerId:""},rules:{dealConetent:[{required:!0,message:"不能为空",trigger:"change"}]},dealType:"",typeList:{0:"跟进补充",1:"关闭工单"},imgList:[],uploadFileUrl:"".concat("https://temp.fingo.shop/fingo/product_manage/ImageUpload"),uploadFileName:"".concat("file"),headers:this.$headers}},watch:{workOrderNo:function(e){e&&(this.params={dealConetent:"",dealPic:"",ccManagerId:""},this.clearValidate())}},methods:{clearValidate:function(){this.$refs["closeWorkOrder"]&&this.$refs["closeWorkOrder"].clearValidate()},confirmCloseItem:function(){var e=this;this.$refs["closeWorkOrder"].validate((function(t){if(t){var a=s["g"];1==e.dealType&&(a=s["e"]),a(e.filterData(Object.assign(e.params,{workOrderNo:e.workOrderNo}))).then((function(t){console.log(t),1===t.ret.errcode&&(e.$message.success("设置成功"),e.closeDialog())}))}}))},setCoverImg:function(e){this.params.dealPic=e.data},closeDialog:function(){this.$emit("close")}}},d=c,m=(a("3d4e"),a("2877")),p=Object(m["a"])(d,r,o,!1,null,null,null);t["a"]=p.exports},"06c9":function(e,t,a){},"13cf":function(e,t,a){"use strict";var r=a("d5eb"),o=a.n(r);o.a},"3d4e":function(e,t,a){"use strict";var r=a("06c9"),o=a.n(r);o.a},4055:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"工单详情页",width:"700px",visible:e.showDialog},on:{close:function(t){return e.closeDialog()}}},[a("common-detail",{attrs:{workOrderNo:e.workOrderNo,collapseArray:e.collapseArray}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog()}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.closeDialog()}}},[e._v("确 定")])],1)],1)},o=[],l=a("f1ca"),s={props:{showDialog:{type:Boolean,default:!1},collapseArray:Array,workOrderNo:String},data:function(){return{}},components:{commonDetail:l["a"]},methods:{closeDialog:function(){this.$emit("close")}}},i=s,n=a("2877"),c=Object(n["a"])(i,r,o,!1,null,null,null);t["a"]=c.exports},a723:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.switchTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"未解决",name:"1"}},[e.hasPermission("BTN_CREATED_WORD_ORDER_ADD")?a("el-button",{staticClass:"mar-b-10",attrs:{icon:"el-icon-plus",type:"primary",size:"medium"},on:{click:function(t){e.addDialog.show=!0}}},[e._v("新建工单\n            ")]):e._e()],1),a("el-tab-pane",{attrs:{label:"待关闭",name:"2"}}),a("el-tab-pane",{attrs:{label:"已关闭",name:"3"}},[a("el-form",{attrs:{inline:"","label-width":"90px"}},[a("el-form-item",{attrs:{label:"关键字："}},[a("el-input",{attrs:{placeholder:"请输入关键字",size:"medium"},model:{value:e.param.selectParam,callback:function(t){e.$set(e.param,"selectParam",t)},expression:"param.selectParam"}})],1),a("el-form-item",{attrs:{label:"用户ID："}},[a("el-input",{attrs:{placeholder:"请输入用户ID",size:"medium"},model:{value:e.param.userId,callback:function(t){e.$set(e.param,"userId",t)},expression:"param.userId"}})],1),a("el-form-item",{attrs:{label:"手机号："}},[a("el-input",{attrs:{placeholder:"请输入用户手机号",size:"medium"},model:{value:e.param.userMobile,callback:function(t){e.$set(e.param,"userMobile",t)},expression:"param.userMobile"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.closeDrop,expression:"closeDrop"}]},[a("el-form-item",{attrs:{label:"关闭日期："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"timestamp","start-placeholder":"时间起","end-placeholder":"时间止","default-time":["00:00:00","23:59:59"]},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),a("el-form-item",{staticClass:"filter-item",staticStyle:{"margin-left":"20px"}},[a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"medium"},on:{click:function(t){return e.getList(1)}}},[e._v("搜索\n                    ")]),a("el-button",{attrs:{icon:"el-icon-refresh-left",size:"medium"},on:{click:e.resetSearch}},[e._v("重置\n                    ")]),a("el-link",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",underline:!1},on:{click:function(t){return e.dropDown("closeDrop")}}},[e._v("\n                        "+e._s(e.closeDrop?"收起":"展开")+"\n                        "),a("i",{class:e.closeDrop?"el-icon-arrow-up":"el-icon-arrow-down"})])],1)],1)],1),a("el-tab-pane",{attrs:{label:"不分派任务",name:"4"}},[a("el-form",{attrs:{inline:"","label-width":"90px"}},[a("el-form-item",{attrs:{label:"关键字："}},[a("el-input",{attrs:{placeholder:"请输入关键字",size:"medium"},model:{value:e.param.selectParam,callback:function(t){e.$set(e.param,"selectParam",t)},expression:"param.selectParam"}})],1),a("el-form-item",{attrs:{label:"用户ID："}},[a("el-input",{attrs:{placeholder:"请输入用户ID",size:"medium"},model:{value:e.param.userId,callback:function(t){e.$set(e.param,"userId",t)},expression:"param.userId"}})],1),a("el-form-item",{attrs:{label:"手机号："}},[a("el-input",{attrs:{placeholder:"请输入用户手机号",size:"medium"},model:{value:e.param.userMobile,callback:function(t){e.$set(e.param,"userMobile",t)},expression:"param.userMobile"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.drop,expression:"drop"}]},[a("el-form-item",{attrs:{label:"关闭日期："}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"timestamp","start-placeholder":"时间起","end-placeholder":"时间止","default-time":["00:00:00","23:59:59"]},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1),a("el-form-item",{staticClass:"filter-item",staticStyle:{"margin-left":"20px"}},[a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"medium"},on:{click:function(t){return e.getList(1)}}},[e._v("搜索\n                    ")]),a("el-button",{attrs:{icon:"el-icon-refresh-left",size:"medium"},on:{click:e.resetSearch}},[e._v("重置\n                    ")]),a("el-link",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",underline:!1},on:{click:function(t){return e.dropDown("drop")}}},[e._v("\n                        "+e._s(e.dropDownContent)+"\n                        "),a("i",{class:e.dropDownIcon})])],1)],1)],1)],1),a("div",{staticClass:"main-content-wrapper"},[a("el-table",{attrs:{border:"",height:"100%",data:e.dataList}},[a("el-table-column",{attrs:{prop:"workOrderNo",label:"工单ID",fixed:"left",align:"center","min-width":"150px"}}),3==e.activeName?[a("el-table-column",{attrs:{prop:"createDate",label:"关闭时间","min-width":"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e._f("formatTime")(t.row.createDate))+"\n                    ")]}}],null,!1,1068022498)})]:[a("el-table-column",{attrs:{prop:"createDate",label:"创建时间","min-width":"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e._f("formatTime")(t.row.createDate))+"\n                    ")]}}])})],a("el-table-column",{attrs:{prop:"userId",label:"用户ID"}}),a("el-table-column",{attrs:{prop:"userNickName",label:"客户姓名"}}),a("el-table-column",{attrs:{prop:"tagName","min-width":"120px",label:"标签"}}),a("el-table-column",{attrs:{label:"紧急程度"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.getNameByKey(t.row.emergencyLevel,"emergencyLevel"))+"\n                ")]}}])}),a("el-table-column",{attrs:{prop:"createManagerName",label:"创建人"}}),a("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasPermission("BTN_CREATED_WORD_ORDER_CLOSE")&&2==e.activeName?a("el-button",{attrs:{plain:"",type:"primary",size:"danger"},on:{click:function(a){return e.showWorkOrderDialog("closeDialog",t.row)}}},[e._v("关闭工单")]):e._e(),!e.hasPermission("BTN_CREATED_WORD_ORDER_DETAIL")||1!=e.activeName&&3!=e.activeName&&4!=e.activeName?e._e():a("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(a){return e.showWorkOrderDialog("detailDialog",t.row)}}},[e._v("查看详情")])]}}])})],2)],1),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{"current-page":e.param.page.pageNum,"page-sizes":[5,10,20,50],"page-size":e.param.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totals},on:{"size-change":e.handleSizeChange,"current-change":e.getList}})],1),a("work-order-edit",{attrs:{showDialog:e.addDialog.show},on:{confirm:e.confirmAddWorkOrder,close:function(t){e.addDialog.show=!1}}}),a("close-work-order",{attrs:{showDialog:e.closeDialog.show,collapseArray:["2","4"],workOrderNo:e.closeDialog.workOrderNo},on:{close:function(t){return e.closeWorkOrderDialog("closeDialog")}}}),a("work-order-detail",{attrs:{showDialog:e.detailDialog.show,collapseArray:["1","2","3"],workOrderNo:e.detailDialog.workOrderNo},on:{close:function(t){return e.closeWorkOrderDialog("detailDialog")}}})],1)},o=[],l=a("03b7"),s=a("4055"),i=a("9a1b"),n=a("403c"),c=a("6d47"),d={data:function(){return{drop:!1,closeDrop:!1,dropDownContent:"展开",dropDownIcon:"el-icon-arrow-down",activeName:"1",totals:0,param:{selectParam:"",userId:"",userMobile:"",page:{pageSize:10,pageNum:1,pagingSwitch:!0}},timeList:[],dataList:[],addDialog:{show:!1},closeDialog:{show:!1,workOrderNo:""},detailDialog:{show:!1,workOrderNo:""}}},mixins:[n["a"]],components:{closeWorkOrder:l["a"],workOrderDetail:s["a"],workOrderEdit:i["a"]},computed:{nowEnd:function(){return this.$store.state.globalNum.nowEnd},lastMonth:function(){return this.$store.state.globalNum.lastMonth}},created:function(){this.timeList=[this.lastMonth,this.nowEnd],this.getList()},methods:{dropDown:function(e){"drop"===e&&(this.drop?(this.dropDownContent="展开",this.dropDownIcon="el-icon-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="el-icon-arrow-up")),this[e]=!this[e]},handleSizeChange:function(e){this.param.page.pageSize=e,this.getList()},switchTab:function(){this.getList(1)},getList:function(e){var t=this;this.param.page.pageNum=e||this.param.page.pageNum,this.timeList=this.timeList?this.timeList:[];var a=null;localStorage.adminUserInfo&&(a=JSON.parse(localStorage.adminUserInfo)),Object(c["o"])(this.filterData(Object.assign(this.param,{doDispatch:4!=this.activeName?1:2,createManagerId:a?a.id:null,workOrderStatus:4==this.activeName?null:parseInt(this.activeName),startDate:this.timeList[0]?this.timeList[0]:null,endDate:this.timeList[1]?this.timeList[1]:null,orderDateType:0,selectDateType:3==this.activeName?3:0}))).then((function(e){console.log(e),1===e.ret.errcode&&(t.dataList=e.data,t.totals=e.total)}))},closeWorkOrderDialog:function(e){this[e].show=!1,this[e].workOrderNo="",this.getList()},showWorkOrderDialog:function(e,t){this[e].show=!0,this[e].workOrderNo=t.workOrderNo},confirmAddWorkOrder:function(){this.addDialog.show=!1,this.getList()},resetSearch:function(){this.param={selectParam:"",userId:"",userMobile:"",page:{pageSize:10,pageNum:1,pagingSwitch:!0}},this.timeList=[]}}},m=d,p=a("2877"),u=Object(p["a"])(m,r,o,!1,null,null,null);t["default"]=u.exports},d5eb:function(e,t,a){},f1ca:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-work-order-info"},[Object.keys(e.detailInfo).length>0?a("el-collapse",{model:{value:e.collapseArray,callback:function(t){e.collapseArray=t},expression:"collapseArray"}},[a("el-collapse-item",{attrs:{title:"属性",name:"1"}},[a("div",{staticClass:"flex-between"},[a("span",[e._v("工单来源："+e._s(e.sourceList[e.detailInfo.workOrderSource]))]),a("span",[e._v("标签："+e._s(e.detailInfo.tagName))]),a("span",[e._v("紧急程度："+e._s(e.getNameByKey(e.detailInfo.emergencyLevel,"emergencyLevel")))]),a("span",[e._v("创建人："+e._s(e.detailInfo.createManagerName))])])]),a("el-collapse-item",{attrs:{title:"详情",name:"2"}},[a("div",{staticClass:"flex-between"},[a("span",[e._v("用户昵称："+e._s(e.detailInfo.userNickName))]),a("span",[e._v("用户ID："+e._s(e.detailInfo.userId))]),a("span",[e._v("用户手机号："+e._s(e.detailInfo.userMobile))])]),a("div",{staticClass:"mar-t-10"},[e._v("工单内容："+e._s(e.detailInfo.workOrderDescribe)+" ")]),a("div",{staticClass:"mar-t-10"},[e._v("订单号："+e._s(e.detailInfo.orderNo)+" ")]),a("div",[e._v("子订单："+e._s(e.detailInfo.subOrderNo))]),e.detailInfo.workOrderSource?a("div",{staticClass:"mar-t-10"},[e._v("工单来源："+e._s(e.sourceList[e.detailInfo.workOrderSource])+" ")]):e._e(),e.detailInfo.workOrderPic?a("div",{staticClass:"flex align-center mar-t-10"},[a("span",[e._v("附件：")]),e._l(e.formatImg(e.detailInfo.workOrderPic),(function(t){return a("div",{key:t},[e.isImg(t)?a("img",{staticClass:"list-img-box",attrs:{src:e.dealShowFileSrc(t)},on:{click:function(a){return e.previewImg([t],0)}}}):a("a",{staticClass:"file-a",attrs:{download:"文件",href:e.dealShowFileSrc(t)}},[e._v(e._s(e.getFileName(t)))])])}))],2):e._e(),e.detailInfo.workOrderContent?a("div",{staticClass:"mar-t-10"},[e._v("备注事项："+e._s(e.detailInfo.workOrderContent))]):e._e()]),a("el-collapse-item",{attrs:{name:"3"}},[a("template",{slot:"title"},[a("div",{staticClass:"flex-between"},[a("span",[e._v("处理进度")]),a("span",[e._v(e._s(e.getDealInfo()))])])]),a("el-timeline",e._l(e.detailInfo.processRecords,(function(t,r){return a("el-timeline-item",{key:r,attrs:{timestamp:e.WorkOrderDealTypeEnum[t[0].dealType],placement:"top"}},[a("el-card",[a("div",{staticClass:"flex-between"},[a("span",[e._v("\n                                处理人："+e._s(t[0].dealManagerName)+"\n                            ")]),a("span",[e._v(e._s(e._f("formatTime")(t[0].createDate)))])]),e._l(t,(function(t,r){return 0!=r?a("div",{key:r},[a("div",{staticClass:"flex-between"},[a("span",[7==t.dealType?[e._v("\n                                      抄送："+e._s(t.dealManagerName)+"\n                                  ")]:2==t.dealType?[e._v("\n                                     "+e._s(t.dealContent)+"\n                                 ")]:e._e()],2),a("span",[e._v(e._s(e._f("formatTime")(t.createDate)))])]),t.dealPic?a("div",{staticClass:"flex align-center mar-t-10"},[a("span",[e._v("附件：")]),e._l(e.formatImg(t.dealPic),(function(t){return a("div",{key:t},[e.isImg(t)?a("img",{staticClass:"list-img-box",attrs:{src:e.dealShowFileSrc(t)},on:{click:function(a){return e.previewImg([t],0)}}}):a("a",{staticClass:"file-a",attrs:{download:"文件",href:e.dealShowFileSrc(t)}},[e._v(e._s(e.getFileName(t)))])])}))],2):e._e()]):e._e()})),t[0].dealContent?a("div",[e._v("处理说明："+e._s(t[0].dealContent))]):e._e(),t[0].dealPic?a("div",{staticClass:"flex align-center mar-t-10"},[a("span",[e._v("附件：")]),e._l(e.formatImg(t[0].dealPic),(function(t){return a("div",{key:t},[e.isImg(t)?a("img",{staticClass:"list-img-box",attrs:{src:e.dealShowFileSrc(t)},on:{click:function(a){return e.previewImg([t],0)}}}):a("a",{staticClass:"file-a",attrs:{download:"文件",href:e.dealShowFileSrc(t)}},[e._v(e._s(e.getFileName(t)))])])}))],2):e._e(),t[0].dealEvaluation&&t[0].dealEvaluation.length>0?a("div",[e._v("\n                            工单评价："+e._s(e.WorkOrderEvaluationEnum[t[0].dealEvaluation])+"\n                            "),e._l(t[0].dealEvaluation,(function(t,r){return a("span",{key:r,staticClass:"mar-l-10"},[e._v(e._s(e.WorkOrderEvaluationEnum[t]))])}))],2):e._e()],2)],1)})),1)],2)],1):e._e(),a("image-preview",{directives:[{name:"show",rawName:"v-show",value:e.image.show,expression:"image.show"}],attrs:{close:e.closePreview,index:e.image.index,list:e.image.list}})],1)},o=[],l=(a("ac6a"),a("456d"),a("6762"),a("28a5"),a("c229")),s=a("8866"),i=a("6d47"),n=a("403c"),c=["bmp","jpg","png","jpeg","gif","tiff","pcx"],d={props:{workOrderNo:String,collapseArray:Array},data:function(){return{detailInfo:{},image:{show:!1,index:0,list:[]}}},mixins:[n["a"]],components:{imagePreview:l["a"]},watch:{workOrderNo:function(e){e&&this.getWorkOrderDetail()}},created:function(){this.getWorkOrderDetail()},methods:{getWorkOrderDetail:function(){var e=this;Object(i["k"])({workOrderNo:this.workOrderNo}).then((function(t){if(console.log(t),1===t.ret.errcode){for(var a={},r=0;r<t.workOrderView.processRecords.length;r++)a[t.workOrderView.processRecords[r].processNo]||(a[t.workOrderView.processRecords[r].processNo]=[]),a[t.workOrderView.processRecords[r].processNo].push(t.workOrderView.processRecords[r]);t.workOrderView.processRecords=a,e.detailInfo=t.workOrderView}}))},isImg:function(e){var t=e.split(".");return c.includes(t[t.length-1])},getFileName:function(e){var t=e.split("/");return t[t.length-1]||"文件"},getDealInfo:function(){var e="";if(Object.keys(this.detailInfo.processRecords).length>0){var t=Object.keys(this.detailInfo.processRecords)[Object.keys(this.detailInfo.processRecords).length-1];e="当前进度：";var a=this.detailInfo.processRecords[t][0];e+=this.WorkOrderDealStatus[a.dealStatus],e+=" "+a.dealManagerName,e+=" "+Object(s["b"])(a.createDate)}return e},previewImg:function(e,t){this.image.list=e,this.image.index=t,this.image.show=!0},closePreview:function(){this.image.index=0,this.image.show=!1}}},m=d,p=(a("13cf"),a("2877")),u=Object(p["a"])(m,r,o,!1,null,null,null);t["a"]=u.exports}}]);