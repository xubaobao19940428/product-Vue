(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47b907c5"],{"399e":function(e,t,a){},4127:function(e,t,a){"use strict";var r=a("d233"),n=a("b313"),s={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},i=Date.prototype.toISOString,o={delimiter:"&",encode:!0,encoder:r.encode,encodeValuesOnly:!1,serializeDate:function(e){return i.call(e)},skipNulls:!1,strictNullHandling:!1},l=function e(t,a,n,s,i,l,c,u,d,p,m,h){var f=t;if("function"===typeof c)f=c(a,f);else if(f instanceof Date)f=p(f);else if(null===f){if(s)return l&&!h?l(a,o.encoder):a;f=""}if("string"===typeof f||"number"===typeof f||"boolean"===typeof f||r.isBuffer(f)){if(l){var y=h?a:l(a,o.encoder);return[m(y)+"="+m(l(f,o.encoder))]}return[m(a)+"="+m(String(f))]}var v,g=[];if("undefined"===typeof f)return g;if(Array.isArray(c))v=c;else{var b=Object.keys(f);v=u?b.sort(u):b}for(var k=0;k<v.length;++k){var C=v[k];i&&null===f[C]||(g=Array.isArray(f)?g.concat(e(f[C],n(a,C),n,s,i,l,c,u,d,p,m,h)):g.concat(e(f[C],a+(d?"."+C:"["+C+"]"),n,s,i,l,c,u,d,p,m,h)))}return g};e.exports=function(e,t){var a=e,i=t?r.assign({},t):{};if(null!==i.encoder&&void 0!==i.encoder&&"function"!==typeof i.encoder)throw new TypeError("Encoder has to be a function.");var c="undefined"===typeof i.delimiter?o.delimiter:i.delimiter,u="boolean"===typeof i.strictNullHandling?i.strictNullHandling:o.strictNullHandling,d="boolean"===typeof i.skipNulls?i.skipNulls:o.skipNulls,p="boolean"===typeof i.encode?i.encode:o.encode,m="function"===typeof i.encoder?i.encoder:o.encoder,h="function"===typeof i.sort?i.sort:null,f="undefined"!==typeof i.allowDots&&i.allowDots,y="function"===typeof i.serializeDate?i.serializeDate:o.serializeDate,v="boolean"===typeof i.encodeValuesOnly?i.encodeValuesOnly:o.encodeValuesOnly;if("undefined"===typeof i.format)i.format=n["default"];else if(!Object.prototype.hasOwnProperty.call(n.formatters,i.format))throw new TypeError("Unknown format option provided.");var g,b,k=n.formatters[i.format];"function"===typeof i.filter?(b=i.filter,a=b("",a)):Array.isArray(i.filter)&&(b=i.filter,g=b);var C,O=[];if("object"!==typeof a||null===a)return"";C=i.arrayFormat in s?i.arrayFormat:"indices"in i?i.indices?"indices":"repeat":"indices";var D=s[C];g||(g=Object.keys(a)),h&&g.sort(h);for(var S=0;S<g.length;++S){var x=g[S];d&&null===a[x]||(O=O.concat(l(a[x],x,D,u,d,p?m:null,b,h,f,y,k,v)))}var w=O.join(c),T=!0===i.addQueryPrefix?"?":"";return w.length>0?T+w:""}},4328:function(e,t,a){"use strict";var r=a("4127"),n=a("9e6a"),s=a("b313");e.exports={formats:s,parse:n,stringify:r}},"5c0b":function(e,t,a){"use strict";var r=a("88ee"),n=a.n(r);n.a},6471:function(e,t,a){"use strict";a.d(t,"s",(function(){return n})),a.d(t,"t",(function(){return s})),a.d(t,"u",(function(){return i})),a.d(t,"v",(function(){return o})),a.d(t,"w",(function(){return l})),a.d(t,"y",(function(){return c})),a.d(t,"z",(function(){return u})),a.d(t,"x",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"k",(function(){return h})),a.d(t,"h",(function(){return f})),a.d(t,"f",(function(){return y})),a.d(t,"d",(function(){return v})),a.d(t,"n",(function(){return g})),a.d(t,"i",(function(){return b})),a.d(t,"j",(function(){return k})),a.d(t,"m",(function(){return C})),a.d(t,"l",(function(){return O})),a.d(t,"c",(function(){return D})),a.d(t,"e",(function(){return S})),a.d(t,"q",(function(){return x})),a.d(t,"r",(function(){return w})),a.d(t,"p",(function(){return T})),a.d(t,"o",(function(){return P})),a.d(t,"g",(function(){return j}));var r=a("284b");function n(e){var t=r["a"].create("CancelTimingTaskReq",e);return Object(r["a"])("chat","PushTaskService.CancelTimingTask",t,"pushtask.CancelTimingTaskResp")}function s(e){var t=r["a"].create("CreatePushTaskReq",e);return Object(r["a"])("chat","PushTaskService.CreatePushTask",t,"pushtask.CreatePushTaskResp")}function i(e){var t=r["a"].create("DeletePushTaskReq",e);return Object(r["a"])("chat","PushTaskService.DeletePushTask",t,"pushtask.DeletePushTaskResp")}function o(e){var t=r["a"].create("EditPushTaskReq",e);return Object(r["a"])("chat","PushTaskService.EditPushTask",t,"pushtask.EditPushTaskResp")}function l(e){var t=r["a"].create("EditUserGroupReq",e);return Object(r["a"])("chat","PushTaskService.EditUserGroup",t,"pushtask.EditUserGroupResp")}function c(e){var t=r["a"].create("SendPushReq",e);return Object(r["a"])("chat","PushTaskService.SendPush",t,"pushtask.SendPushResp")}function u(e){var t=r["a"].create("SendTimingTaskNowReq",e);return Object(r["a"])("chat","PushTaskService.SendTimingTaskNow",t,"pushtask.SendTimingTaskNowResp")}function d(e){var t=r["a"].create("SearchPushTaskOrRecordReq",e);return Object(r["a"])("chat","PushTaskService.SearchPushTaskOrRecord",t,"pushtask.SearchPushTaskOrRecordResp")}function p(e){var t=r["a"].create("AddUserGroupBySpeRep",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.AddUserGroupBySpe",t,"datahouse.AddUserGroupBySpeResp")}function m(e){var t=r["a"].create("AddUserGroupByGroupReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.AddUserGroupByGroup",t,"datahouse.AddUserGroupByGroupResp")}function h(e){var t=r["a"].create("GetUserGroupInfoReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.GetUserGroupInfo",t,"datahouse.GetUserGroupInfoResp")}function f(e){var t=r["a"].create("GetUserGroupDetailInfoReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.GetUserGroupDetailInfo",t,"datahouse.GetUserGroupDetailInfoResp")}function y(e){var t=r["a"].create("EditUserGroupInfoReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.EditUserGroupInfo",t,"datahouse.EditUserGroupInfoResp")}function v(e){var t=r["a"].create("DeleteUserGroupInfoReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.DeleteUserGroupInfo",t,"datahouse.DeleteUserGroupInfoResp")}function g(e){var t=r["a"].create("GetUserPropertyListReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.GetUserPropertyList",t,"datahouse.GetUserPropertyListResp")}function b(e){var t=r["a"].create("GetUserGroupIdToExcelReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.GetUserGroupIdToExcel",t,"datahouse.GetUserGroupIdToExcelResp")}function k(e){var t=r["a"].create("GetUserGroupIdTotalReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.GetUserGroupIdTotal",t,"datahouse.GetUserGroupIdTotalResp")}function C(e){var t=r["a"].create("GetUserIdsExcelOnEditPageReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.GetUserIdsExcelOnEditPage",t,"datahouse.GetUserIdsExcelOnEditPageResp")}function O(e){var t=r["a"].create("GetUserIdsCountOnEditPageReq",e);return Object(r["a"])("datahouse","PushTaskUserGroupService.GetUserIdsCountOnEditPage",t,"datahouse.GetUserIdsCountOnEditPageResp")}function D(e){var t=r["a"].create("CreateAppVersionReq",e);return Object(r["a"])("chat","AppVersionBossService.CreateAppVersion",t,"CreateAppVersionResp")}function S(e){var t=r["a"].create("EditAppVersionReq",e);return Object(r["a"])("chat","AppVersionBossService.EditAppVersion",t,"EditAppVersionResp")}function x(e){var t=r["a"].create("SearchCurrentAppVersionInfoReq",e);return Object(r["a"])("chat","AppVersionBossService.SearchCurrentAppVersionInfo",t,"SearchCurrentAppVersionInfoResp")}function w(e){var t=r["a"].create("SearchLowestAppVersionInfoReq",e);return Object(r["a"])("chat","AppVersionBossService.SearchLowestAppVersionInfo",t,"SearchLowestAppVersionInfoResp")}function T(e){var t=r["a"].create("SearchAppVersionInfoWithPageReq",e);return Object(r["a"])("chat","AppVersionBossService.SearchAppVersionInfoWithPage",t,"SearchAppVersionInfoWithPageResp")}function P(e){var t=r["a"].create("PublishAppVersionOrNotReq",e);return Object(r["a"])("chat","AppVersionBossService.PublishAppVersionOrNot",t,"PublishAppVersionOrNotResp")}function j(e){var t=r["a"].create("GetAppVersionDetailReq",e);return Object(r["a"])("chat","AppVersionBossService.GetAppVersionDetail",t,"GetAppVersionDetailResp")}},"66fb":function(e,t,a){},7235:function(e,t,a){"use strict";var r=a("8f07"),n=a.n(r);n.a},"761b":function(e,t,a){"use strict";var r=a("7f7c"),n=a.n(r);n.a},"7f7c":function(e,t,a){},"88ee":function(e,t,a){},"8f07":function(e,t,a){},"983c":function(e,t,a){"use strict";var r=a("399e"),n=a.n(r);n.a},"9e6a":function(e,t,a){"use strict";var r=a("d233"),n=Object.prototype.hasOwnProperty,s={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:r.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},i=function(e,t){for(var a={},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,o=r.split(t.delimiter,i),l=0;l<o.length;++l){var c,u,d=o[l],p=d.indexOf("]="),m=-1===p?d.indexOf("="):p+1;-1===m?(c=t.decoder(d,s.decoder),u=t.strictNullHandling?null:""):(c=t.decoder(d.slice(0,m),s.decoder),u=t.decoder(d.slice(m+1),s.decoder)),n.call(a,c)?a[c]=[].concat(a[c]).concat(u):a[c]=u}return a},o=function(e,t,a){for(var r=t,n=e.length-1;n>=0;--n){var s,i=e[n];if("[]"===i)s=[],s=s.concat(r);else{s=a.plainObjects?Object.create(null):{};var o="["===i.charAt(0)&&"]"===i.charAt(i.length-1)?i.slice(1,-1):i,l=parseInt(o,10);!isNaN(l)&&i!==o&&String(l)===o&&l>=0&&a.parseArrays&&l<=a.arrayLimit?(s=[],s[l]=r):s[o]=r}r=s}return r},l=function(e,t,a){if(e){var r=a.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/,i=/(\[[^[\]]*])/g,l=s.exec(r),c=l?r.slice(0,l.index):r,u=[];if(c){if(!a.plainObjects&&n.call(Object.prototype,c)&&!a.allowPrototypes)return;u.push(c)}var d=0;while(null!==(l=i.exec(r))&&d<a.depth){if(d+=1,!a.plainObjects&&n.call(Object.prototype,l[1].slice(1,-1))&&!a.allowPrototypes)return;u.push(l[1])}return l&&u.push("["+r.slice(l.index)+"]"),o(u,t,a)}};e.exports=function(e,t){var a=t?r.assign({},t):{};if(null!==a.decoder&&void 0!==a.decoder&&"function"!==typeof a.decoder)throw new TypeError("Decoder has to be a function.");if(a.ignoreQueryPrefix=!0===a.ignoreQueryPrefix,a.delimiter="string"===typeof a.delimiter||r.isRegExp(a.delimiter)?a.delimiter:s.delimiter,a.depth="number"===typeof a.depth?a.depth:s.depth,a.arrayLimit="number"===typeof a.arrayLimit?a.arrayLimit:s.arrayLimit,a.parseArrays=!1!==a.parseArrays,a.decoder="function"===typeof a.decoder?a.decoder:s.decoder,a.allowDots="boolean"===typeof a.allowDots?a.allowDots:s.allowDots,a.plainObjects="boolean"===typeof a.plainObjects?a.plainObjects:s.plainObjects,a.allowPrototypes="boolean"===typeof a.allowPrototypes?a.allowPrototypes:s.allowPrototypes,a.parameterLimit="number"===typeof a.parameterLimit?a.parameterLimit:s.parameterLimit,a.strictNullHandling="boolean"===typeof a.strictNullHandling?a.strictNullHandling:s.strictNullHandling,""===e||null===e||"undefined"===typeof e)return a.plainObjects?Object.create(null):{};for(var n="string"===typeof e?i(e,a):e,o=a.plainObjects?Object.create(null):{},c=Object.keys(n),u=0;u<c.length;++u){var d=c[u],p=l(d,n[d],a);o=r.merge(o,p,a)}return r.compact(o)}},b072:function(e,t,a){"use strict";a.d(t,"e",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"i",(function(){return h})),a.d(t,"c",(function(){return f})),a.d(t,"g",(function(){return y})),a.d(t,"b",(function(){return v})),a.d(t,"j",(function(){return g})),a.d(t,"f",(function(){return b})),a.d(t,"h",(function(){return k})),a.d(t,"d",(function(){return C}));var r=a("a18c"),n=a("4328"),s=a.n(n),i=a("5c96"),o=window.axios,l="https://gyrfalcon.fingo.shop",c=localStorage.adminUserInfo?JSON.parse(localStorage.adminUserInfo):null,u=o.create({baseUrl:l,timeout:45e3,method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json;charset=UTF-8","Operator-ID":c?c.id:null}});u.interceptors.request.use((function(e){var t=e.headers["Content-Type"];for(var a in e.data)null!==e.data[a]&&void 0!==e.data[a]||delete e.data[a];return t.indexOf("application/x-www-form-urlencoded")>=0&&(e.data=s.a.stringify(e.data)),e.url=e.baseUrl+e.url,e}),(function(e){return Promise.resolve(e)})),u.interceptors.response.use((function(e){if(200!==e.status){var t=new Error("服务器异常");throw t}switch(e.data.code){case 1:return e.data;case 704:localStorage.getItem("adminToken")&&i["Message"].warning("ErrorMsg: ".concat((e.data.msg,e.data.msg),", ErrorCode: ").concat(e.data.code)),localStorage.clear(),r["a"].push({name:"login"});break;case 1009:return e.data;default:throw i["Message"].error(e.data.msg),new Error(e.data.msg)}}),(function(e){throw e.message&&i["Message"].error(e.message),e}));var d=u;function p(e){return d("/strategy/findByName",{data:e})}function m(e){return d("/strategy/add",{data:e})}function h(e){return d("/strategy/edit",{data:e})}function f(e){return d("/strategy/delete/".concat(e),{method:"delete"})}function y(e){return d("/strategytask/search",{data:e})}function v(e){return d("/strategytask/add",{data:e})}function g(e){return d("/strategytask/edit",{data:e})}function b(e){return d("/strategytask/detail",{data:e})}function k(e){return d("/strategytask/trigger/".concat(e))}function C(e){return d("/strategytask/emailTest",{data:e})}},b313:function(e,t,a){"use strict";var r=String.prototype.replace,n=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return r.call(e,n,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},ca2e:function(e,t,a){"use strict";var r=a("d66c"),n=a.n(r);n.a},d233:function(e,t,a){"use strict";var r=Object.prototype.hasOwnProperty,n=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function(e){var t;while(e.length){var a=e.pop();if(t=a.obj[a.prop],Array.isArray(t)){for(var r=[],n=0;n<t.length;++n)"undefined"!==typeof t[n]&&r.push(t[n]);a.obj[a.prop]=r}}return t},i=function(e,t){for(var a=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)"undefined"!==typeof e[r]&&(a[r]=e[r]);return a},o=function e(t,a,n){if(!a)return t;if("object"!==typeof a){if(Array.isArray(t))t.push(a);else{if("object"!==typeof t)return[t,a];(n.plainObjects||n.allowPrototypes||!r.call(Object.prototype,a))&&(t[a]=!0)}return t}if("object"!==typeof t)return[t].concat(a);var s=t;return Array.isArray(t)&&!Array.isArray(a)&&(s=i(t,n)),Array.isArray(t)&&Array.isArray(a)?(a.forEach((function(a,s){r.call(t,s)?t[s]&&"object"===typeof t[s]?t[s]=e(t[s],a,n):t.push(a):t[s]=a})),t):Object.keys(a).reduce((function(t,s){var i=a[s];return r.call(t,s)?t[s]=e(t[s],i,n):t[s]=i,t}),s)},l=function(e,t){return Object.keys(t).reduce((function(e,a){return e[a]=t[a],e}),e)},c=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},u=function(e){if(0===e.length)return e;for(var t="string"===typeof e?e:String(e),a="",r=0;r<t.length;++r){var s=t.charCodeAt(r);45===s||46===s||95===s||126===s||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122?a+=t.charAt(r):s<128?a+=n[s]:s<2048?a+=n[192|s>>6]+n[128|63&s]:s<55296||s>=57344?a+=n[224|s>>12]+n[128|s>>6&63]+n[128|63&s]:(r+=1,s=65536+((1023&s)<<10|1023&t.charCodeAt(r)),a+=n[240|s>>18]+n[128|s>>12&63]+n[128|s>>6&63]+n[128|63&s])}return a},d=function(e){for(var t=[{obj:{o:e},prop:"o"}],a=[],r=0;r<t.length;++r)for(var n=t[r],i=n.obj[n.prop],o=Object.keys(i),l=0;l<o.length;++l){var c=o[l],u=i[c];"object"===typeof u&&null!==u&&-1===a.indexOf(u)&&(t.push({obj:i,prop:c}),a.push(u))}return s(t)},p=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},m=function(e){return null!==e&&"undefined"!==typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))};e.exports={arrayToObject:i,assign:l,compact:d,decode:c,encode:u,isBuffer:m,isRegExp:p,merge:o}},d66c:function(e,t,a){},f3f7:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container detail-wrap"},[a("div",{staticClass:"title"},[e._v("\n        "+e._s(e.taskId?"copy"==e.addType?"新建":"编辑":"新建")+"任务\n        "),a("span",[e._v(e._s("timing"==e.taskType?"定时型":"周期型")+"任务")])]),a("div",{staticClass:"filter-container"},[a("el-form",{attrs:{inline:"",model:e.baseFormData}},[a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"任务名称："}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入",size:"medium"},model:{value:e.baseFormData.taskName,callback:function(t){e.$set(e.baseFormData,"taskName",t)},expression:"baseFormData.taskName"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"任务国家："}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择",size:"medium"},on:{change:e.changeExecuteTime},model:{value:e.baseFormData.taskCountry,callback:function(t){e.$set(e.baseFormData,"taskCountry",t)},expression:"baseFormData.taskCountry"}},[a("el-option",{attrs:{label:"马来西亚",value:"MY"}}),a("el-option",{attrs:{label:"泰国",value:"TH"}}),a("el-option",{attrs:{label:"新加坡",value:"SG"}}),a("el-option",{attrs:{label:"印度尼西亚",value:"ID"}})],1)],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"目标用户组："}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择",size:"medium",filterable:"",remote:"","reserve-keyword":"","remote-method":e.getGetUserGroupInfo},on:{change:e.changeUserGroup},model:{value:e.baseFormData.userGroupId,callback:function(t){e.$set(e.baseFormData,"userGroupId",t)},expression:"baseFormData.userGroupId"}},e._l(e.userGroupIdOption,(function(e){return a("el-option",{key:e.userGroupId,attrs:{label:e.userGroupName,value:e.userGroupId}})})),1)],1),a("br"),"timing"==e.taskType?a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"任务执行时间："}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择",size:"medium",type:"datetime","value-format":"timestamp","picker-options":e.pickerOptions},on:{change:e.changeExecuteTime},model:{value:e.baseFormData.executionTime,callback:function(t){e.$set(e.baseFormData,"executionTime",t)},expression:"baseFormData.executionTime"}}),a("span",{staticClass:"tip"},[e._v("（ 对应国家执行时间 "+e._s(e.baseFormData.executionTime?e.nationTime:"")+" ）")])],1):e._e(),"period"==e.taskType?a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"任务生效周期："}},[a("el-date-picker",{attrs:{"start-placeholder":"请选择","end-placeholder":"请选择",size:"medium",type:"datetimerange","value-format":"timestamp","picker-options":e.pickerOptions},on:{change:e.changeExecuteTime},model:{value:e.baseFormData.periodExecuteTime,callback:function(t){e.$set(e.baseFormData,"periodExecuteTime",t)},expression:"baseFormData.periodExecuteTime"}})],1):e._e(),"period"==e.taskType?a("el-form-item",{staticClass:"filter-item",staticStyle:{display:"block"},attrs:{required:"",label:"生效时间："}},[a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.periodUnit,callback:function(t){e.periodUnit=t},expression:"periodUnit"}},[a("el-option",{attrs:{label:"每天",value:"day"}}),a("el-option",{attrs:{label:"每周",value:"week"}}),a("el-option",{attrs:{label:"每月",value:"month"}})],1),"week"==e.periodUnit?a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.validCron.week,callback:function(t){e.$set(e.validCron,"week",t)},expression:"validCron.week"}},[a("el-option",{attrs:{label:"一",value:"2"}}),a("el-option",{attrs:{label:"二",value:"3"}}),a("el-option",{attrs:{label:"三",value:"4"}}),a("el-option",{attrs:{label:"四",value:"5"}}),a("el-option",{attrs:{label:"五",value:"6"}}),a("el-option",{attrs:{label:"六",value:"7"}}),a("el-option",{attrs:{label:"日",value:"1"}})],1):e._e(),"month"==e.periodUnit?a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.validCron.month,callback:function(t){e.$set(e.validCron,"month",t)},expression:"validCron.month"}},e._l(e.days,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),"month"==e.periodUnit?a("span",[e._v("日 ")]):e._e(),a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.validCron.hour,callback:function(t){e.$set(e.validCron,"hour",t)},expression:"validCron.hour"}},e._l(e.hours,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v("时 \n                "),a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.validCron.minute,callback:function(t){e.$set(e.validCron,"minute",t)},expression:"validCron.minute"}},e._l(e.minutes,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),e._v("分\n            ")],1):e._e()],1)],1),a("channel",{ref:"channel",attrs:{check:e.checkData,pushData:e.pushData,messageData:e.messageData,emailData:e.emailData}}),a("controller",{ref:"controller",attrs:{check:e.checkData,datas:e.controllerData,unit:e.controllerUnit,showUpload:e.showUpload}}),a("div",{staticClass:"action-box"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("保存")]),a("el-button",{on:{click:function(){e.$router.go(-1)}}},[e._v("取消")])],1)],1)},n=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),i=(a("5df3"),a("1c4c"),a("c32d")),o=a.n(i),l=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("div",{staticClass:"channel"},[r("div",{staticClass:"title"},[t._v("触达渠道")]),r("div",{staticClass:"add"},[r("el-button",{attrs:{type:"primary",size:"medium",disabled:t.selectedPush},on:{click:function(){e.selectedPush=!0}}},[r("i",{staticClass:"iconfont"},[t._v("")]),t._v(" 添加PUSH\n        ")]),r("el-button",{attrs:{type:"primary",size:"medium",disabled:t.selectedMessage},on:{click:function(){e.selectedMessage=!0}}},[r("i",{staticClass:"iconfont"},[t._v("")]),t._v(" 添加短信\n        ")]),r("el-button",{attrs:{type:"primary",size:"medium",disabled:t.selectedEmail},on:{click:function(){e.selectedEmail=!0}}},[r("i",{staticClass:"iconfont"},[t._v("")]),t._v(" 添加邮件\n        ")])],1),r("div",{staticClass:"channel-container"},[r("div",{staticClass:"channel-wrap",style:"width: "+t.countWidth()+"px"},[r("push-card",{directives:[{name:"show",rawName:"v-show",value:t.selectedPush,expression:"selectedPush"}],ref:"pushCard",attrs:{selectedPush:t.selectedPush,onDelete:function(){e.selectedPush=!1},datas:t.pushData}}),r("message-card",{directives:[{name:"show",rawName:"v-show",value:t.selectedMessage,expression:"selectedMessage"}],ref:"messageCard",attrs:{onDelete:function(){e.selectedMessage=!1},datas:t.messageData}}),r("email-card",{directives:[{name:"show",rawName:"v-show",value:t.selectedEmail,expression:"selectedEmail"}],ref:"emailCard",attrs:{onDelete:function(){e.selectedEmail=!1},datas:t.emailData}})],1)])])},c=[],u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"channel-item"},[a("div",{staticClass:"clearfix channel-header-title",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("PUSH")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{icon:"el-icon-delete",type:"text"},on:{click:e.deleteCard}})],1),a("div",{staticClass:"channel-item-title"},[e._v("PUSH配置")]),a("el-form",{attrs:{inline:"",model:e.optionFormData}},[a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"推送渠道："}},[a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.optionFormData.pushChannel,callback:function(t){e.$set(e.optionFormData,"pushChannel",t)},expression:"optionFormData.pushChannel"}},e._l(e.pushChannelOption,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"消息分类："}},[a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.optionFormData.pushType,callback:function(t){e.$set(e.optionFormData,"pushType",t)},expression:"optionFormData.pushType"}},e._l(e.pushTypeOption,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("br"),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"跳转："}},[a("el-radio-group",{on:{change:e.changePushLinkType},model:{value:e.optionFormData.redirect,callback:function(t){e.$set(e.optionFormData,"redirect",t)},expression:"optionFormData.redirect"}},[a("el-radio",{attrs:{label:3}},[e._v("不跳转")]),a("el-radio",{attrs:{label:1}},[e._v("链接")]),a("el-radio",{attrs:{label:2}},[e._v("应用内页面")])],1)],1),1==e.optionFormData.redirect?a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"跳转链接："}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入",size:"medium"},model:{value:e.optionFormData.redirectLink,callback:function(t){e.$set(e.optionFormData,"redirectLink",t)},expression:"optionFormData.redirectLink"}})],1):e._e(),2==e.optionFormData.redirect?a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"跳转链接："}},[a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.optionFormData.appLink,callback:function(t){e.$set(e.optionFormData,"appLink",t)},expression:"optionFormData.appLink"}},e._l(e.actionTypeList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),a("br"),a("el-form-item",{staticClass:"filter-item",attrs:{label:"PUSH图片："}},[e.selectedPush?a("div",{staticClass:"upload-image-box"},[a("c-upload",{attrs:{accept:"image/jpeg, image/jpg, image/png, image/gif",fileList:e.optionFormData.picUrl,limit:1},on:{setData:e.setPushPic}}),a("div",{staticClass:"default-img"},[a("span",[e._v("默认图片：")]),a("img",{attrs:{src:e.dealShowFileSrc(e.defaultImage)}})])],1):e._e()])],1),a("div",{staticClass:"channel-item-title"},[e._v("PUSH内容")]),a("el-form",{attrs:{inline:"",model:e.pushContentVOS,"label-width":"115px"}},[a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"PUSH模板："}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.optionFormData.pushTemplateCode,callback:function(t){e.$set(e.optionFormData,"pushTemplateCode",t)},expression:"optionFormData.pushTemplateCode"}},e._l(e.pushModelOption,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"标题（中文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.cn.title,callback:function(t){e.$set(e.pushContentVOS.cn,"title",t)},expression:"pushContentVOS.cn.title"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"内容（中文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.cn.content,callback:function(t){e.$set(e.pushContentVOS.cn,"content",t)},expression:"pushContentVOS.cn.content"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"标题（英文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.en.title,callback:function(t){e.$set(e.pushContentVOS.en,"title",t)},expression:"pushContentVOS.en.title"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"内容（英文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.en.content,callback:function(t){e.$set(e.pushContentVOS.en,"content",t)},expression:"pushContentVOS.en.content"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"标题（马来文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.ms.title,callback:function(t){e.$set(e.pushContentVOS.ms,"title",t)},expression:"pushContentVOS.ms.title"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"内容（马来文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.ms.content,callback:function(t){e.$set(e.pushContentVOS.ms,"content",t)},expression:"pushContentVOS.ms.content"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"标题（泰文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.th.title,callback:function(t){e.$set(e.pushContentVOS.th,"title",t)},expression:"pushContentVOS.th.title"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"内容（泰文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.th.content,callback:function(t){e.$set(e.pushContentVOS.th,"content",t)},expression:"pushContentVOS.th.content"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"标题（印尼文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.id.title,callback:function(t){e.$set(e.pushContentVOS.id,"title",t)},expression:"pushContentVOS.id.title"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"内容（印尼文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.pushContentVOS.id.content,callback:function(t){e.$set(e.pushContentVOS.id,"content",t)},expression:"pushContentVOS.id.content"}})],1)],1)],1)},d=[],p=a("f09b");function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var f={name:"pushCard",components:{cUpload:p["a"]},props:{datas:{type:Object,default:null},onDelete:{type:Function,default:function(){}},showUpload:{type:Boolean,default:!1},selectedPush:Boolean},data:function(){return{optionFormData:{pushChannel:"",pushType:"",redirect:"",redirectLink:"",appLink:"",picUrl:"",pushTemplateCode:""},pushContentVOS:{cn:{title:"",content:""},en:{title:"",content:""},ms:{title:"",content:""},th:{title:"",content:""},id:{title:"",content:""}},pushChannelOption:[{id:1,name:"站内和站外"},{id:2,name:"站内"},{id:3,name:"站外"}],pushTypeOption:[{value:"PROMOTION_CODE_SALE",label:"促销活动"},{value:"PROMOTION_CODE_COUPON",label:"优惠券"},{value:"PROMOTION_CODE_MEMBER_ACTIVITY",label:"会员活动"}],actionTypeList:[{label:"我的收益",value:"MY_INCOME"},{label:"我的团队",value:"MY_TEAM"},{label:"我的优惠券",value:"MY_COUPON"},{label:"我的收藏",value:"MY_COLLECTION"}],pushModelOption:[{id:0,name:"自定义"}],defaultImage:"https://file.fingo.shop/upload/picture/2020-06/29/original/18442521870559353503744_original_6666x6666.png",isShowUpload:!0}},watch:{datas:function(e){if(e){this.optionFormData.picUrl=e.picUrl,this.optionFormData.pushChannel=e.pushChannel,this.optionFormData.pushTemplateCode=e.pushTemplateCode,this.optionFormData.pushType=e.pushType,this.optionFormData.redirect=e.redirect,1==e.redirect?this.optionFormData.redirectLink=e.redirectLink:2==e.redirect&&(this.optionFormData.appLink=e.redirectLink);for(var t=0;t<e.pushContentVOS.length;t++){var a=e.pushContentVOS[t];this.pushContentVOS[a.language].title=a.title,this.pushContentVOS[a.language].content=a.content}}},showUpload:function(e){this.isShowUpload=e}},methods:{getChunkData:function(){var e="";return 1==this.optionFormData.redirect?e=this.optionFormData.redirectLink.trim():2==this.optionFormData.redirect&&(e=this.optionFormData.appLink),h(h({},this.optionFormData),{},{pushContentVOS:this.pushContentVOS,picUrl:this.optionFormData.picUrl?this.optionFormData.picUrl:this.defaultImage,redirectLink:e})},setPushPic:function(e){this.optionFormData.picUrl=e.data},deleteCard:function(){var e=this;this.$confirm("是否删除此触达渠道？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.optionFormData={pushChannel:"",pushType:"",redirect:"",redirectLink:"",picUrl:"",pushTemplateCode:""},e.pushContentVOS={cn:{title:"",content:""},en:{title:"",content:""},ms:{title:"",content:""},th:{title:"",content:""},id:{title:"",content:""}},e.onDelete()})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))}}},y=f,v=(a("761b"),a("2877")),g=Object(v["a"])(y,u,d,!1,null,"3b2bbac2",null),b=g.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"channel-item"},[a("div",{staticClass:"clearfix channel-header-title",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("短信")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{icon:"el-icon-delete",type:"text"},on:{click:e.deleteCard}})],1),a("div",{staticClass:"channel-item-title"},[e._v("短信渠道")]),a("div",{staticClass:"tip"},[e._v("注意：若推送的用户组内有包含印尼的用户，因成本问题，触达渠道最好不要配短信")]),a("el-form",{attrs:{inline:"",model:e.smsContentVOs,"label-width":"115px"}},[a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"短信模板："}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.smsTemplateCode,callback:function(t){e.smsTemplateCode=t},expression:"smsTemplateCode"}},e._l(e.smsTemplateCodeOption,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"内容（中文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:e.maxLength,"show-word-limit":""},model:{value:e.smsContentVOs.cn.content,callback:function(t){e.$set(e.smsContentVOs.cn,"content",t)},expression:"smsContentVOs.cn.content"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"内容（英文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:e.maxLength,"show-word-limit":""},model:{value:e.smsContentVOs.en.content,callback:function(t){e.$set(e.smsContentVOs.en,"content",t)},expression:"smsContentVOs.en.content"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"内容（马来文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:e.maxLength,"show-word-limit":""},model:{value:e.smsContentVOs.ms.content,callback:function(t){e.$set(e.smsContentVOs.ms,"content",t)},expression:"smsContentVOs.ms.content"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"内容（泰文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:e.maxLength,"show-word-limit":""},model:{value:e.smsContentVOs.th.content,callback:function(t){e.$set(e.smsContentVOs.th,"content",t)},expression:"smsContentVOs.th.content"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"内容（印尼文）："}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium",type:"textarea",maxlength:e.maxLength,"show-word-limit":""},model:{value:e.smsContentVOs.id.content,callback:function(t){e.$set(e.smsContentVOs.id,"content",t)},expression:"smsContentVOs.id.content"}})],1),a("el-form-item",{staticClass:"filter-item"},[a("el-checkbox",{staticStyle:{width:"115px","text-align":"right","font-weight":"inherit"},model:{value:e.redirectLinkShow,callback:function(t){e.redirectLinkShow=t},expression:"redirectLinkShow"}},[e._v("跳转链接  ")]),a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.redirectLinkShow,expression:"redirectLinkShow"}],staticStyle:{width:"400px"},attrs:{placeholder:"请输入",size:"medium"},on:{input:e.handleChangeRedirectLink},model:{value:e.redirectLink,callback:function(t){e.redirectLink=t},expression:"redirectLink"}})],1)],1)],1)},C=[],O={name:"messageCard",props:{datas:{type:Object,default:null},onDelete:{type:Function,default:function(){}}},data:function(){return{smsTemplateCode:"",redirectLink:"",maxLength:"500",redirectLinkShow:!1,smsContentVOs:{cn:{content:""},en:{content:""},ms:{content:""},th:{content:""},id:{content:""}},smsTemplateCodeOption:[{id:0,name:"自定义"}]}},watch:{datas:function(e){if(e){this.smsTemplateCode=e.smsTemplateCode,this.redirectLink=e.redirectLink;for(var t=0;t<e.smsContentVOs.length;t++){var a=e.smsContentVOs[t];this.smsContentVOs[a.language].content=a.content}}}},methods:{getChunkData:function(){var e=this.redirectLink?1:3;return this.redirectLinkShow&&!this.redirectLink?(this.$message.error("请填写短信跳转链接"),null):{smsTemplateCode:this.smsTemplateCode,smsContentVOs:this.smsContentVOs,redirectLink:this.redirectLink.trim(),redirect:e}},deleteCard:function(){var e=this;this.$confirm("是否删除此触达渠道？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.smsTemplateCode="",e.smsContentVOs={cn:{content:""},en:{content:""},ms:{content:""},th:{content:""},id:{content:""}},e.onDelete()})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleChangeRedirectLink:function(e){this.maxLength=e.length?460:500}}},D=O,S=(a("5c0b"),Object(v["a"])(D,k,C,!1,null,"69d48035",null)),x=S.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"channel-item"},[a("div",{staticClass:"clearfix channel-header-title",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("邮件")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{icon:"el-icon-delete",type:"text"},on:{click:e.deleteCard}})],1),a("div",{staticClass:"channel-item-title"},[e._v("邮件渠道")]),a("div",{staticClass:"tip"},[e._v("说明：内容样式需要先去三方后台配置，完成配置后将模版ID输入下方输入框点击测试模版，会发一条邮件到操作员的企业邮箱中，可验证发送内容")]),a("el-form",{ref:"emailForm",attrs:{inline:"",model:e.queryData,"label-width":"115px"}},[a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"邮件模板ID："}},[a("el-input",{attrs:{placeholder:"请输入模版ID"},model:{value:e.queryData.id,callback:function(t){e.$set(e.queryData,"id",t)},expression:"queryData.id"}})],1),a("el-form-item",{staticClass:"filter-item",attrs:{required:"",label:"测试接收地址："}},[a("el-input",{attrs:{placeholder:"填写接收的邮件地址"},on:{input:e.handleInput},model:{value:e.queryData.email,callback:function(t){e.$set(e.queryData,"email",t)},expression:"queryData.email"}})],1),a("el-form-item",[e.showBtn?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.testClick}},[e._v("测试模版")]),e.showBtn?a("div",{staticClass:"diabel-test"},[a("el-button",{attrs:{type:"info",disabled:""}},[e._v("测试模版")]),a("div",{staticClass:"disable-time"},[e._v(e._s(e.time)+"  "+e._s("S"))])],1):e._e()],1)],1),a("div",[a("div",[e._v("测试结果："),a("span",{style:e.testSuccess?"color: #70B603;":"color: #D9001B;"},[e._v(e._s(e.testResult))])])])],1)},T=[],P=a("b072"),j={props:{datas:{type:Object,default:null},onDelete:{type:Function,default:function(){}}},data:function(){return{queryData:{id:"",emial:""},time:30,showBtn:!1,testResult:"",testSuccess:!0}},watch:{datas:function(e){e&&(this.queryData.id=e.templateId,this.queryData.emailAddress=e.emailAddress)}},methods:{getChunkData:function(){return{templateId:this.queryData.id?this.queryData.id.trim():"",emailAddress:this.queryData.emailAddress?this.queryData.emailAddress.trim():""}},sendEmail:function(){var e=/^\w+@[a-z0-9]+\.[a-z]{2,4}$/;return!(""!=this.queryData.email&&!e.test(this.queryData.email.trim()))||(this.$message({message:"邮箱格式不正确",type:"error"}),this.queryData.email="",!1)},testClick:function(){var e=this;if(this.queryData.id)if(this.queryData.email){if(this.sendEmail()){this.showBtn=!0;var t=this,a=setInterval((function(){t.time--,0==e.time&&(clearInterval(a),e.time=30,e.showBtn=!1)}),1e3);Object(P["d"])({emailAddress:this.queryData.email,templateId:this.queryData.id}).then((function(t){clearInterval(a),1009==t.code?(e.testSuccess=!1,e.testResult=t.msg):(e.testSuccess=!0,e.testResult="successful"),e.time=30,e.showBtn=!1}))}}else this.$message.error("请填写测试接收地址");else this.$message.error("请填写邮件模板ID")},deleteCard:function(){var e=this;this.$confirm("是否删除此触达渠道？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.queryData.id="",e.queryData.emailAddress="",e.onDelete()})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleInput:function(){this.testResult=""}}},F=j,U=(a("ca2e"),Object(v["a"])(F,w,T,!1,null,"52c079e2",null)),V=U.exports;var G={name:"channel",components:{PushCard:b,MessageCard:x,EmailCard:V},props:{pushData:{type:Object,default:null},messageData:{type:Object,default:null},emailData:{type:Object,default:null},check:{type:Function,default:function(){}}},data:function(){return{selectedPush:!1,selectedMessage:!1,selectedEmail:!1,messageData:null}},watch:{pushData:function(e){e&&(this.selectedPush=!0)},messageData:function(e){e&&(this.selectedMessage=!0)},emailData:function(e){e&&(this.selectedEmail=!0)}},methods:{getChunkData:function(){var e=this,t=function(e){return!e&&0!==e},a=this.selectedPush?this.$refs.pushCard.getChunkData():{},r=this.selectedMessage?this.$refs.messageCard.getChunkData():{},n=this.selectedEmail?this.$refs.emailCard.getChunkData():null;if(this.selectedPush||this.selectedMessage||this.selectedEmail){var s=[];this.selectedPush&&s.push(1),this.selectedMessage&&s.push(2),this.selectedEmail&&s.push(3);var i=Object.assign({},{pushSetting:a},{smsSetting:r},{emailSetting:n}),o=!0,l=s.indexOf(1)<0,c=s.indexOf(2)<0,u=s.indexOf(3)<0;l&&delete i.pushSetting,c&&delete i.smsSetting,u&&delete i.emailSetting;var d={pushChannel:[{test:t,errMsg:"请选择push推送渠道"}],pushType:[{test:t,errMsg:"请选择push消息分类"}],redirect:[{test:t,errMsg:"请选择push跳转方式"}],pushTemplateCode:[{test:t,errMsg:"请选择push模版"}]},p={templateId:[{test:t,errMsg:"请填写邮件模板ID"}]},m=function(){var t=i.smsSetting.smsContentVOs,a=i.smsSetting.smsTemplateCode;i.smsSetting.redirectLink;return a||0===a?t.cn.content?!!t.en.content||(e.$message.error("请输入短信内容（英文）"),!1):(e.$message.error("请输入短信内容（中文）"),!1):(e.$message.error("请选择短信模板"),!1)},h=function(){var t=i.pushSetting.pushContentVOS;return t.cn.title?t.cn.content?t.en.title&&t.en.content?t.ms.title&&!t.ms.content?(e.$message.error("请输入push内容（马来文）"),!1):!t.ms.title&&t.ms.content?(e.$message.error("请输入push标题（马来文）"),!1):t.th.title&&!t.th.content?(e.$message.error("请输入push内容（泰文）"),!1):!t.th.title&&t.th.content?(e.$message.error("请输入push标题（泰文）"),!1):t.id.title&&!t.id.content?(e.$message.error("请输入push内容（印尼文）"),!1):!(!t.id.title&&t.id.content)||(e.$message.error("请输入push标题（印尼文）"),!1):(e.$message.error("请输入push内容（英文）"),!1):(e.$message.error("请输入push内容（中文）"),!1):(e.$message.error("请输入push标题（中文）"),!1)},f=function(){var e=[],t=i.pushSetting.pushContentVOS;for(var a in t)t[a].title&&t[a].content&&e.push({language:a,title:t[a].title,content:t[a].content});i.pushSetting.pushContentVOS=e},y=function(){var e=[],t=i.smsSetting.smsContentVOs;for(var a in t)t[a].content&&e.push({language:a,content:t[a].content});i.smsSetting.smsContentVOs=e};return!l&&c&&u?(o=this.check(i.pushSetting,d)&&h(),f()):l&&!c&&u?(o=m(),y()):l&&c&&!u?o=this.check(i.emailSetting,p):l||c||!u?l||u||!c?!l||u||c?(o=this.check(i.pushSetting,d)&&h()&&m()&&this.check(i.emailSetting,p),f(),y()):(o=m()&&this.check(i.emailSetting,p),y()):(o=this.check(i.pushSetting,d)&&h()&&this.check(i.emailSetting,p),f()):(o=this.check(i.pushSetting,d)&&h()&&m(),f(),y()),this.selectedPush&&o&&3!=i.pushSetting.redirect&&!i.pushSetting.redirectLink&&(o=!1,this.$message.error("请输入push跳转链接")),o?i:null}return this.$message.error("请选择触达渠道"),null},countWidth:function(){var e=[];return this.selectedPush&&e.push(1),this.selectedMessage&&e.push(2),this.selectedEmail&&e.push(3),610*e.length}}},q=G,_=(a("7235"),Object(v["a"])(q,l,c,!1,null,"dea12434",null)),I=_.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"controller"},[a("div",{staticClass:"title"},[e._v("发送控制")]),a("el-form",{attrs:{inline:"",model:e.controllerFormData}},[a("el-form-item",{staticClass:"filter-item",attrs:{required:""}},[a("el-radio-group",{model:{value:e.controllerFormData.taskStatus,callback:function(t){e.$set(e.controllerFormData,"taskStatus",t)},expression:"controllerFormData.taskStatus"}},[a("el-radio",{attrs:{label:1}},[e._v("关闭")]),a("el-radio",{attrs:{label:2}},[e._v("开启")])],1)],1),a("br"),2==e.controllerFormData.taskStatus?a("el-form-item",{staticClass:"filter-item",attrs:{label:"单人发送频次：",required:""}},[a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"时间间隔",size:"medium"},on:{change:function(t){e.controllerFormData.sendNum=t<0?0:t}},model:{value:e.controllerFormData.sendNum,callback:function(t){e.$set(e.controllerFormData,"sendNum",t)},expression:"controllerFormData.sendNum"}}),e._v(" \n            "),a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:e.controllerFormData.frequencyUnit,callback:function(t){e.$set(e.controllerFormData,"frequencyUnit",t)},expression:"controllerFormData.frequencyUnit"}},[a("el-option",{attrs:{value:"hour",label:"小时"}}),a("el-option",{attrs:{value:"day",label:"日"}}),a("el-option",{attrs:{value:"week",label:"周"}}),a("el-option",{attrs:{value:"month",label:"月"}})],1)],1):e._e()],1),a("div",{staticClass:"tip"},[e._v("满足限制条件的用户，任务执行时不会被发送")]),a("div",{staticClass:"tip-red"},[e._v("这里的发送频次指的是目标用户，若被其他任务触达后，多少时间内允许此任务触达")])],1)},$=[],R={name:"Controller",props:{datas:{type:String,default:null},unit:{type:String,default:null},check:{type:Function,default:function(){}}},data:function(){return{controllerFormData:{taskStatus:1,sendNum:"",frequencyUnit:""}}},watch:{datas:function(e){if(e)switch(this.controllerFormData.taskStatus=2,this.controllerFormData.frequencyUnit=this.unit,this.unit){case"month":this.controllerFormData.sendNum=e/60/60/24/30;break;case"week":this.controllerFormData.sendNum=e/60/60/24/7;break;case"day":this.controllerFormData.sendNum=e/60/60/24;break;case"hour":this.controllerFormData.sendNum=e/60/60;break;default:break}}},methods:{getChunkData:function(){var e=function(e){return!e},t=2!=this.controllerFormData.taskStatus||this.check(this.controllerFormData,{sendNum:[{test:e,errMsg:"请选择时间间隔"}],frequencyUnit:[{test:e,errMsg:"请选择单人发送频次单位"}]}),a=0;switch(this.controllerFormData.frequencyUnit){case"hour":a=3600*this.controllerFormData.sendNum;break;case"day":a=86400*this.controllerFormData.sendNum;break;case"week":a=604800*this.controllerFormData.sendNum;break;case"month":a=2592e3*this.controllerFormData.sendNum;break;default:break}return t?1==this.controllerFormData.taskStatus?{pushFrequency:0,frequencyUnit:this.controllerFormData.frequencyUnit}:{pushFrequency:a,frequencyUnit:this.controllerFormData.frequencyUnit}:null}}},A=R,L=(a("983c"),Object(v["a"])(A,E,$,!1,null,"07bb463a",null)),N=L.exports,M=a("6471");function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var H={name:"strategyTaskDetail",data:function(){return{strategyCode:"",taskType:"",taskCode:"",addType:"",baseFormData:{taskName:"",taskCountry:"",userGroupId:"",userGroupName:"",executionTime:"",periodExecuteTime:""},periodUnit:"",validCron:{week:"一",month:1,hour:22,minute:"00"},userGroupIdOption:[],nationTime:"",pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},days:Array.from(Array(31),(function(e,t){var a="",r=t+1;return a=r<10?"0"+r:r,a})),hours:Array.from(Array(24),(function(e,t){var a="";return a=t<10?"0"+t:t,a})),minutes:Array.from(Array(60),(function(e,t){var a="";return a=t<10?"0"+t:t,a})),pushData:null,messageData:null,emailData:null,controllerData:null,controllerUnit:null,showUpload:!0,taskStatus:1}},components:{Channel:I,Controller:N},mounted:function(){this.strategyCode=this.$route.query.strategyCode,this.taskType=this.$route.query.type,this.taskCode=this.$route.query.taskCode,this.addType=this.$route.query.edit,this.taskCode?(this.showUpload=!1,this.getDetailData()):this.getGetUserGroupInfo()},methods:{submit:function(){var e=this,t=this.getBaseData();if(t){var a=this.$refs.channel.getChunkData();if(a){var r=this.$refs.controller.getChunkData();if(r){a.pushSetting&&a.pushSetting.appLink&&delete a.pushSetting.appLink;var n=function(t){t.strategyCode=e.strategyCode,Object(P["b"])(t).then((function(t){e.$message.success("操作成功"),e.$router.push({path:"strategyTaskList",query:{strategyCode:e.strategyCode}})})).catch((function(e){}))},s=function(t){t.strategyCode=e.strategyCode,t.taskCode=e.taskCode,Object(P["j"])(t).then((function(t){e.$message.success("操作成功"),e.$router.push({path:"strategyTaskList",query:{strategyCode:e.strategyCode}})})).catch((function(e){}))},i=function(t){e.taskCode&&"copy"!=e.addType?s(B(B({},t),{},{status:e.taskStatus})):n(t)};if("timing"==this.taskType){var o=B(B(B({},t),a),r);i(o)}else if("period"==this.taskType){var l=t.periodExecuteTime[0],c=t.periodExecuteTime[1];delete t.periodExecuteTime;var u=B(B(B({validPeriodStartTime:l,validPeriodEndTime:c},t),a),r);i(u)}}}}},getBaseData:function(){var e=this.baseFormData,t=this.validCron,a=function(e){return!e},r=function(e){return e<=Date.now()},n={taskName:[{test:a,errMsg:"请填写任务名称"}],taskCountry:[{test:a,errMsg:"请选择任务国家"}],userGroupId:[{test:a,errMsg:"请选择目标用户组"}]},s={executionTime:[{test:a,errMsg:"请选择任务执行时间"},{test:r,errMsg:"任务执行时间必须大于当前时间"}]},i=!0;if(e.taskType="period"==this.taskType?2:1,"timing"==this.taskType)delete e.periodExecuteTime,i=this.checkData(e,B(B({},n),s));else if(delete e.executionTime,i=this.checkData(e,B(B({},n),{},{periodExecuteTime:[{test:a,errMsg:"请选择任务生效周期"}]})),!this.periodUnit)return this.$message.error("请选择生效时间单位"),!1;switch(this.periodUnit){case"day":delete t.week,delete t.month;break;case"week":delete t.month;break;case"month":delete t.week;break;default:break}return!!i&&(this.periodUnit?B(B({},e),{},{validCron:JSON.stringify(t)}):e)},getDetailData:function(){var e=this;Object(P["f"])({strategyCode:this.taskCode}).then((function(t){e.showUpload=!0,e.taskStatus=t.data.status,e.setTaskDetail(t.data)})).catch((function(t){e.showUpload=!0}))},getGetUserGroupInfo:function(e){var t=this;Object(M["k"])({page:{pageNum:1,pageSize:500,pagingSwitch:!0},userGroupName:e}).then((function(e){1===e.ret.errcode&&(t.userGroupIdOption=e.userGroupInfo,t.searchLoading=!1)}))},setTaskDetail:function(e){if(this.getGetUserGroupInfo(e.userGroupName),this.baseFormData.taskName="copy"==this.addType?"":e.taskName,this.baseFormData.taskCountry=e.taskCountry,this.baseFormData.userGroupId=e.userGroupId,this.baseFormData.userGroupName=e.userGroupName,"period"==this.taskType&&e.validCron){var t=JSON.parse(e.validCron);t.month?this.periodUnit="month":t.week?this.periodUnit="week":this.periodUnit="day",this.validCron=t,this.baseFormData.periodExecuteTime=[e.validPeriodStartTime,e.validPeriodEndTime]}else this.baseFormData.executionTime=e.executionTime,this.changeExecuteTime();this.pushData=e.pushSetting,this.messageData=e.smsSetting,this.emailData=e.emailSetting,this.controllerData=e.pushFrequency,this.controllerUnit=e.frequencyUnit},changeExecuteTime:function(){var e=this.baseFormData.executionTime-0;this.nationTime="TH"==this.baseFormData.taskCountry||"ID"==this.baseFormData.taskCountry?o()(e).utcOffset(7).format("YYYY-MM-DD HH:mm:SS"):o()(e).format("YYYY-MM-DD HH:mm:SS")},changeUserGroup:function(e){for(var t=0;t<this.userGroupIdOption.length;t++){var a=this.userGroupIdOption[t];if(a.userGroupId==e){this.baseFormData.userGroupName=a.userGroupName;break}}},checkData:function(e,t){var a="";for(var r in e){var n=!1;if(t.hasOwnProperty(r))for(var s=0;s<t[r].length;s++)if(n=t[r][s].test(e[r]),n){a=t[r][s].errMsg;break}if(n)break}return!a||(this.$message.error(a),!1)}}},Y=H,W=(a("fbe3"),Object(v["a"])(Y,r,n,!1,null,"f8b456f2",null));t["default"]=W.exports},fbe3:function(e,t,a){"use strict";var r=a("66fb"),n=a.n(r);n.a}}]);