(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43967880"],{"21d1":function(e,t,a){},"2deb":function(e,t,a){},"418f":function(e,t,a){"use strict";var r=a("21d1"),i=a.n(r);i.a},"68b0":function(e,t,a){"use strict";var r=a("2deb"),i=a.n(r);i.a},b388:function(e,t,a){},d64b:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{on:{"tab-click":e.handleTabChange},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"下单失败",name:"CREATE_ERROR"}}),a("el-tab-pane",{attrs:{label:"待付款",name:"WAIT_PAY"}}),a("el-tab-pane",{attrs:{label:"待付款异常",name:"WAIT_PAY_ERROR"}}),a("el-tab-pane",{attrs:{label:"已付款",name:"PAY_SUCCESS"}})],1),a("div",{staticClass:"filter-container"},[a("el-form",{ref:"purchaseOrderFilter",attrs:{inline:"",model:e.queryData,"label-width":"80px",size:"medium"}},["CREATE_ERROR"==e.activeName?a("el-form-item",{attrs:{label:"失败原因："}},[a("el-select",{attrs:{clearable:""},model:{value:e.queryData.createFailReason,callback:function(t){e.$set(e.queryData,"createFailReason",t)},expression:"queryData.createFailReason"}},e._l(e.faliReason,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.name}})})),1)],1):e._e(),"WAIT_PAY_ERROR"==e.activeName?a("el-form-item",{attrs:{label:"失败原因："}},[a("el-select",{attrs:{clearable:""},model:{value:e.queryData.payFailReason,callback:function(t){e.$set(e.queryData,"payFailReason",t)},expression:"queryData.payFailReason"}},e._l(e.faliReason,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.name}})})),1)],1):e._e(),a("el-form-item",{staticClass:"product",attrs:{label:"商品：",prop:"value"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入",size:"medium",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getAutoPurchaseOrderList()}},model:{value:e.queryData.value,callback:function(t){e.$set(e.queryData,"value",t)},expression:"queryData.value"}},[a("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.queryData.choseType,callback:function(t){e.$set(e.queryData,"choseType",t)},expression:"queryData.choseType"}},e._l(e.productOptionList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.code}})})),1)],1)],1),a("el-form-item",{attrs:{label:"采购单号："}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入采购单号",size:"medium"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getAutoPurchaseOrderList()}},model:{value:e.queryData.purchaseOrderNo,callback:function(t){e.$set(e.queryData,"purchaseOrderNo",t)},expression:"queryData.purchaseOrderNo"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.drop,expression:"drop"}]},[a("el-form-item",{attrs:{label:"供应商："}},[a("el-select",{directives:[{name:"el-select-loadmore",rawName:"v-el-select-loadmore",value:e.loadMore,expression:"loadMore"}],attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"","remote-method":e.getSupplierList,placeholder:"请输入供应商"},on:{change:function(t){return e.getAutoPurchaseOrderList()}},model:{value:e.queryData.supplierId,callback:function(t){e.$set(e.queryData,"supplierId",t)},expression:"queryData.supplierId"}},e._l(e.supplierLists,(function(e,t){return a("el-option",{key:t,attrs:{label:e.supplierName,value:e.supplierId}})})),1)],1),a("el-form-item",{staticClass:"filter-item",attrs:{label:"后台类目：",prop:"cateId"}},[a("el-cascader",{staticClass:"normalOperatorBox",staticStyle:{width:"300px"},attrs:{clearable:"",filterable:"",props:{label:"cateName",children:"levelValue",value:"cateId",lazy:!0,lazyLoad:e.getBackSubCategory,checkStrictly:!0,emitPath:!1},placeholder:"请选择商品后台分组",options:e.backCategoryOptions,size:"medium"},on:{change:e.setBackCateId},model:{value:e.queryData.cateId,callback:function(t){e.$set(e.queryData,"cateId",t)},expression:"queryData.cateId"}})],1),a("el-form-item",{attrs:{label:"订单号："}},[a("el-input",{attrs:{placeholder:"请输入订单号",clearable:"",size:"medium"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getAutoPurchaseOrderList()}},model:{value:e.queryData.orderNo,callback:function(t){e.$set(e.queryData,"orderNo",t)},expression:"queryData.orderNo"}})],1),a("el-form-item",{attrs:{label:"创建时间："}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",size:"medium",type:"daterange",clearable:"","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:e.queryData.timeList,callback:function(t){e.$set(e.queryData,"timeList",t)},expression:"queryData.timeList"}})],1),"CREATE_ERROR"!=e.activeName?a("el-form-item",{attrs:{label:"第三方订单号：","label-width":"120px"}},[a("el-input",{attrs:{placeholder:"请输入第三方订单号",size:"medium"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getAutoPurchaseOrderList()}},model:{value:e.queryData.thirdNo,callback:function(t){e.$set(e.queryData,"thirdNo",t)},expression:"queryData.thirdNo"}})],1):e._e()],1),a("div",[a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"medium"},on:{click:function(t){return e.getAutoPurchaseOrderList(1)}}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh-left",size:"medium"},on:{click:function(t){return e.resetSearch()}}},[e._v("重置")]),"CREATE_ERROR"==e.activeName&&e.hasPermission("BTN_BATCH_\bAUTO_PURCHASE_1688")?a("el-button",{attrs:{icon:"el-icon-s-check",type:"primary",size:"medium"},on:{click:function(t){return e.autoPurchase(!1)}}},[e._v("批量自动采购")]):e._e(),"WAIT_PAY"==e.activeName&&e.hasPermission("BTN_\bBEFORE_PAY_CKECK_1688")?a("el-button",{attrs:{icon:"el-icon-s-check",type:"primary",size:"medium"},on:{click:e.validtorPay}},[e._v("付款前校验")]):e._e(),"WAIT_PAY_ERROR"==e.activeName&&e.hasPermission("BTN_BATCH_PAY_CAN_PURCHASE_1688")?a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.openConfirmDialog}},[e._v("批量可付款")]):e._e(),"CREATE_ERROR"==e.activeName?a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.autoPurchase(!0)}}},[e._v("现货价下单")]):e._e(),a("el-link",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",underline:!1},on:{click:e.dropDown}},[e._v("\n            "+e._s(e.dropDownContent)+"\n            "),a("i",{class:e.dropDownIcon})])],1)],1)],1)],1),a("div",{staticClass:"main-content-wrapper"},["CREATE_ERROR"==e.activeName||"WAIT_PAY_ERROR"==e.activeName?a("pay-fail-table",{attrs:{loadingFail:e.loading,tableData:e.tableData,type:e.activeName},on:{"open-edit":e.openEditDialog,"open-detail":e.showPurchaseOrderDetail,"on-select":e.hasSelectOrderList,"on-success-purchase":e.successPurchase,"on-cancel":e.cancelPurchaseOrder}}):e._e(),"WAIT_PAY"==e.activeName||"PAY_SUCCESS"==e.activeName?a("pay-success-table",{attrs:{loadingSuccess:e.loadingSuccess,tableData:e.tableData,type:e.activeName},on:{"open-edit":e.openEditDialog,"open-detail":e.showPurchaseOrderDetail,"on-cancel":e.cancelPurchaseOrder}}):e._e()],1),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{"page-size":e.queryData.page.pageSize,"page-sizes":[10,20,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("comprehensive-details",{ref:"purchaseOrderDetail",attrs:{List:e.List},on:{getList:e.getListnew}}),a("edit-supplier",{ref:"editDialog",attrs:{editSupplierDialog:e.editSupplierDialog,detailType:e.activeName,pruchaseEditForm:e.pruchaseEditForm,purchaseOrderNo:e.purchaseOrderNo,dialogTitle:e.dialogTitle},on:{"on-cancel-supplier-dialog":e.closeSupplierDialog,"on-confirm-success":e.autoPurchaseSuccess}}),a("before-confirm-payment",{attrs:{confirmDialogVisible:e.confirmDialogVisible,paymentLoading:e.paymentLoading,noConformDialog:e.noConformDialog,submitConformDialog:e.submitConformDialog,checkContent:e.checkContent},on:{"on-cancel":e.cancelConfirm}}),a("confirm-payment",{attrs:{dialogConfirm:e.dialogConfirm,hasSelectTotal:e.hasSelectOrder.length},on:{"on-cancel":e.cancelConfirmDialog,"on-success":e.confirmPay}}),e.editDialog.confirmPurchase.show?a("confirm-purchase",{ref:"confirmPurchase",attrs:{editDialog:e.editDialog,purchaseList:e.purchaseList,details:e.details,transferList:e.transferList},on:{getList:e.getListnew}}):e._e()],1)},i=[],o=(a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("6b54"),a("75fc")),n=(a("7514"),a("ac6a"),a("7f7f"),a("345d")),s=a("9576"),l=a("9d52"),c=a("2ef0"),u=a.n(c),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit_supplier_dialog"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.editSupplierDialog,width:"1200px",top:"5vh","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.editSupplierDialog=t}}},[a("div",[a("el-form",{attrs:{inline:"",model:e.editForm}},[a("el-form-item",{attrs:{label:"供应商："}},["CREATE_ERROR"==e.detailType||"WAIT_PAY_ERROR"==e.detailType?a("el-select",{directives:[{name:"el-select-loadmore",rawName:"v-el-select-loadmore",value:e.loadMore,expression:"loadMore"}],attrs:{size:"small",filterable:"",clearable:"",remote:"","reserve-keyword":"","remote-method":e.getSupplierList,placeholder:"请输入供应商"},on:{clear:e.clearSelect},model:{value:e.editForm.supplierId,callback:function(t){e.$set(e.editForm,"supplierId",t)},expression:"editForm.supplierId"}},e._l(e.supplierLists,(function(e,t){return a("el-option",{key:t,attrs:{label:e.supplierName,value:e.supplierId}})})),1):a("span",[e._v(e._s(e.editForm.supplierName))])],1),a("el-form-item",{attrs:{label:"采购金额："}},[a("span",[e._v(e._s(e.editForm.purchaseAmount))])]),a("el-form-item",{attrs:{label:"运费："}},[a("span",[e._v(e._s(e.editForm.freight))])]),a("div",{staticClass:"form_button"},["CREATE_ERROR"==e.detailType||"WAIT_PAY_ERROR"==e.detailType?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.SyncNowRelationN}},[e._v("一键同步第三方订单号")]):e._e(),"CREATE_ERROR"==e.detailType?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addProduct}},[e._v("新增商品")]):e._e()],1),e._l(e.editForm.skuList,(function(t,r){return a("div",{key:r,staticClass:"form_data"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"form_data_noline1"},[a("span",{staticClass:"form_index"},[e._v(e._s(r+1))]),a("el-image",{staticStyle:{width:"120px",height:"120px"},attrs:{src:e.dealShowFileSrc(t.skuCover),fit:e.fit}}),a("div",{staticClass:"product_detail"},[a("el-form-item",{attrs:{label:"商品："}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.productId+","+t.skuName,placement:"top"}},[a("span",{staticStyle:{display:"block",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"200px"}},[e._v(e._s(t.productId+","+t.skuName))])])],1),a("el-form-item",{attrs:{label:"规格："}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.skuCode+","+t.skuValues,placement:"top"}},[a("span",{staticStyle:{display:"block",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"200px"}},[e._v(e._s(t.skuCode+","+t.skuValues))])])],1),a("el-form-item",{attrs:{label:"链接："}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.skuLink,placement:"top"}},[a("a",{staticStyle:{color:"#66b1ff",display:"block",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"200px","font-size":"12px"},attrs:{href:t.skuLink,target:"_blank"}},[e._v(e._s(t.skuLink))])])],1)],1)],1),a("div",{staticClass:"form_data_noline"},[a("el-form-item",{attrs:{label:"采购单价："}},[a("span",[e._v(e._s(t.supplyPrice))])]),a("el-form-item",{attrs:{label:"系统数量："}},[a("span",[e._v(e._s(t.sysCount))])]),a("el-form-item",{attrs:{label:"采购数量："}},["CREATE_ERROR"!=e.detailType&&"WAIT_PAY_ERROR"!=e.detailType||2!=t.cancelStatus?e._e():a("el-input",{attrs:{size:"small",oninput:"value=value.replace(/[^\\d]/g,'')"},model:{value:t.purchaseCount,callback:function(a){e.$set(t,"purchaseCount",a)},expression:"item.purchaseCount"}}),"WAIT_PAY"==e.detailType||"PAY_SUCCESS"==e.detailType||1==t.cancelStatus?a("span",[e._v(e._s(t.purchaseCount))]):e._e()],1)],1),a("div",{staticClass:"form_data_noline"},["WAIT_PAY"!=e.detailType&&"PAY_SUCCESS"!=e.detailType?a("el-form-item",{attrs:{label:"失败原因：","label-width":"120px"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.failReason,placement:"top"}},[a("p",{staticStyle:{color:"#66b1ff",display:"block",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"140px","font-size":"14px"}},[e._v(e._s(t.failReason))])])],1):e._e(),"CREATE_ERROR"!=e.detailType&&"WAIT_PAY_ERROR"!=e.detailType||2!=t.cancelStatus?e._e():a("el-form-item",{attrs:{label:"第三方订单号：","label-width":"120px"}},[a("el-input",{attrs:{size:"small"},on:{input:e.changeValue},model:{value:t.thirdNo,callback:function(a){e.$set(t,"thirdNo",a)},expression:"item.thirdNo"}})],1),"WAIT_PAY"==e.detailType||"PAY_SUCCESS"==e.detailType||1==t.cancelStatus?a("el-form-item",{attrs:{label:"第三方订单号：","label-width":"120px"}},[a("span",[e._v(e._s(t.thirdNo))])]):e._e()],1),a("div",{staticClass:"form_data_online2"},[1==t.cancelStatus?a("div",{staticClass:"cancel_reson"},[a("p",[e._v("已取消"+e._s("("+e.returnReason(t.cancelReason)+")"))])]):e._e(),"CREATE_ERROR"!=e.detailType&&"WAIT_PAY_ERROR"!=e.detailType||2!=t.cancelStatus?e._e():a("el-form-item",{staticClass:"padding_form_item"},[a("el-select",{staticStyle:{width:"150px"},attrs:{size:"small",placeholder:"请选择取消原因"},on:{change:e.changeValue},model:{value:t.cancelReason,callback:function(a){e.$set(t,"cancelReason",a)},expression:"item.cancelReason"}},e._l(e.createFailReason,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),"CREATE_ERROR"!=e.detailType&&"WAIT_PAY_ERROR"!=e.detailType||2!=t.cancelStatus?e._e():a("div",{staticClass:"product_button",staticStyle:{"margin-top":"5px"}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.updateData(r,t.skuCode)}}},[e._v("更新单价")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.cancelPurchase(r,t.skuCode)}}},[e._v("取消采购")])],1)],1)],1)])],1)}))],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["CREATE_ERROR"==e.detailType?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addAutoPurchaseUpdate(1)}}},[e._v("发起自动采购")]):e._e(),"WAIT_PAY_ERROR"==e.detailType?a("el-button",{attrs:{type:"primary"},on:{click:e.confirmPurchase}},[e._v("可付款")]):e._e(),"CREATE_ERROR"==e.detailType||"WAIT_PAY_ERROR"==e.detailType?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addAutoPurchaseUpdate(2)}}},[e._v("确 定")]):e._e(),"CREATE_ERROR"!=e.detailType&&"WAIT_PAY_ERROR"!=e.detailType?a("el-button",{attrs:{type:"primary"},on:{click:e.handleClose}},[e._v("确 定")]):e._e(),a("el-button",{on:{click:e.handleClose}},[e._v("取 消")])],1)]),a("add1688Po",{attrs:{show:e.dialogProduct},on:{"on-cancel":e.cancelAddProduct,"on-save-skuOrder":e.addSkuOrder}})],1)},p=[],h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新增商品",visible:e.show,width:"1300px","close-on-click-modal":!1,"before-close":e.cancel},on:{"update:visible":function(t){e.show=t}}},[a("el-form",{ref:"addDialog",attrs:{"label-position":"right",model:e.addDialog,rules:e.addDialogRules,inline:!0,size:"small"}},[e._l(e.addDialog.purchaseOrderProductAddInfos,(function(t,r){return a("el-form-item",{key:r,staticClass:"filter-item"},[a("el-form-item",{attrs:{label:"SKUcode:",prop:"purchaseOrderProductAddInfos."+r+".skuCode",rules:[{required:!0,message:"skuCode不能为空"}]}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入商品SKUcode"},on:{blur:function(a){return e.getSkuInfo(t.skuCode,r)}},model:{value:t.skuCode,callback:function(a){e.$set(t,"skuCode",a)},expression:"item.skuCode"}})],1),a("el-form-item",{attrs:{label:"采购数量:",prop:"purchaseOrderProductAddInfos."+r+".purchaseCount",rules:[{required:!0,message:"采购数量不能为空"}]}},[a("el-input-number",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入采购数量",oninput:"value=value.replace(/[^\\d]/g,'')",min:1},model:{value:t.purchaseCount,callback:function(a){e.$set(t,"purchaseCount",a)},expression:"item.purchaseCount"}})],1),a("el-form-item",{attrs:{label:"采购单价:"}},[a("span",[e._v(e._s(t.supplyPrice))])]),a("el-form-item",{attrs:{label:"规格:"}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.standardAttr,placement:"top"}},[a("span",{staticStyle:{display:"inline-block","vertical-align":"middle",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"100px"}},[e._v(e._s(t.standardAttr))])]),a("el-image",{staticStyle:{width:"60px",height:"60px","vertical-align":"text-top",top:"-20px"},attrs:{src:e.dealShowFileSrc(t.skuCover),fit:e.fit}})],1),a("el-form-item",{attrs:{label:"商品ID:"}},[a("span",[e._v(e._s(t.productId))])]),a("el-form-item",{attrs:{label:"第三方订单号:"}},[a("el-input",{attrs:{placeholder:"请输入第三方单号"},model:{value:t.thirdOrderNo,callback:function(a){e.$set(t,"thirdOrderNo",a)},expression:"item.thirdOrderNo"}})],1),a("el-form-item",[a("div",{staticClass:"delete-box",on:{click:function(t){return e.deleteProducts(r)}}},[a("i",{staticClass:"el-icon-circle-close"})])])],1)})),a("div",[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.addProducts()}}},[e._v("+ 新 增")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.SyncNowRelationN}},[e._v("一键同步第三方单号")])],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.addLoading,size:"small"},on:{click:e.addPurchase}},[e._v("确 定")])],1)])],1)},m=[],f=(a("96cf"),a("3b8d")),g=a("0cd8"),y=a("e3c6"),v=a("e77f"),b={name:"add1688Po",props:{show:{type:Boolean,default:!1}},mixins:[y["a"]],data:function(){return{addLoading:!1,supplierList:[],addDialog:{purchaseOrderProductAddInfos:[]},addDialogRules:{},url:"https://file-dev.fingo.shop/fingo/product/2020-04/23/original/18375497627287491969024_original_1920x1080.jpg"}},watch:{show:{handler:function(e,t){e||(this.addDialog.purchaseOrderProductAddInfos=[])}}},mounted:function(){},components:{},methods:{checkNum:function(e){e<=0&&this.$alert("采购数量不能为小于等于零")},deleteProducts:function(e){this.addDialog.purchaseOrderProductAddInfos.splice(e,1)},addProducts:function(){this.addDialog.purchaseOrderProductAddInfos.push({skuCode:"",purchaseCount:"",purchasePrice:"",thirdOrderNo:"",skuCover:"",standardAttr:"",productName:"",productId:"",supplyPrice:"",skuLink:""})},isRepeat:function(e){var t={};for(var a in e){if(t[e[a].skuCode])return!0;t[e[a].skuCode]=!0}return!1},addPurchase:function(){var e=this;this.$refs["addDialog"].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var r,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=5;break}if(r=e.addDialog.purchaseOrderProductAddInfos.filter((function(e){return e.skuCode&&""!=e.purchaseCount})),r.length>0){for(i=0;i<e.addDialog.purchaseOrderProductAddInfos.length;i++)e.addDialog.purchaseOrderProductAddInfos[i].purchaseCount<0&&e.$message.warning("采购数量异常");e.isRepeat(r)?e.$message.warning("skuCode不能相同"):(o=e.addDialog.purchaseOrderProductAddInfos,{},e.$emit("on-save-skuOrder",o))}else e.$message.warning("商品信息不能为空");t.next=6;break;case 5:return t.abrupt("return",!1);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},SyncNowRelationN:function(){for(var e=0;e<this.addDialog.purchaseOrderProductAddInfos.length;e++)this.addDialog.purchaseOrderProductAddInfos[e].thirdOrderNo=this.addDialog.purchaseOrderProductAddInfos[0].thirdOrderNo},changeWareHouse:function(e){},savePurchaseOrder:function(e){var t=this;this.addLoading=!0,Object(g["O"])(this.filterData(e)).then((function(e){t.addLoading=!1,1===e.ret.errcode?(t.$message.success("操作成功！"),t.addDialog.show=!1,t.$emit("getList"),t.reset()):t.$message.error(e.message)})).catch((function(e){t.addLoading=!1,console.log(e)}))},cancel:function(){this.$emit("on-cancel"),this.reset(),this.addDialog.purchaseOrderProductAddInfos=[]},reset:function(){this.$refs.addDialog.resetFields()},getSkuInfo:function(e,t){var a=this,r={skuCode:e};Object(v["g"])(this.filterData(r)).then((function(e){1===e.ret.errcode&&(console.log(e),e.sku?(a.addDialog.purchaseOrderProductAddInfos[t].skuCover=e.sku.skuCover,a.addDialog.purchaseOrderProductAddInfos[t].standardAttr=e.sku.standardAttr,a.addDialog.purchaseOrderProductAddInfos[t].productName=e.sku.nameCn,a.addDialog.purchaseOrderProductAddInfos[t].productId=e.sku.productId,a.addDialog.purchaseOrderProductAddInfos[t].supplyPrice=e.sku.supplyPrice,a.addDialog.purchaseOrderProductAddInfos[t].skuLink=e.sku.skuLink):a.$message.warning("无匹配的sku信息"))})).catch((function(e){console.log(e)}))}}},O=b,C=(a("418f"),a("2877")),S=Object(C["a"])(O,h,m,!1,null,"0885181e",null),k=S.exports,R={components:{add1688Po:k},name:"editSupplier",props:{editSupplierDialog:{type:Boolean,default:!1},dialogTitle:{type:String,default:"编辑采购单"},detailType:{type:String,default:"1"},purchaseOrderNo:{type:String,default:""},pruchaseEditForm:{type:Object,default:function(){return{}}}},data:function(){return{createFailReason:[{value:"SELLER_UN_SUPPORT",label:"卖家未授权分销"},{value:"SKU_STOCK_OUT",label:"SKU缺货"},{value:"SKU_OFF_THE_SHELF",label:"商品下架"},{value:"SKU_ATTRIBUTE_ERROR",label:"SKU规格名称不一致"},{value:"SKU_PRICE_HIGHT",label:"商品价格高于供货价"},{value:"SKU_LIMIT_NUM",label:"商品限购"},{value:"SKU_OFFER_PREHEATING",label:"商品参加活动"},{value:"FINGO_SKU_ERROR",label:"FINGO商品异常"},{value:"1688_SYSTEM_ERROR",label:"1688系统问题"},{value:"PAY_TYPE_UN_SUPPORT",label:"交易方式不支持"},{value:"SKU_TRACE_ERROR",label:"溯源失败"},{value:"OTHER",label:"其他原因"}],supplierLists:[],dialogProduct:!1,editForm:{supplierName:"",purchaseAmount:"",freight:"",supplierId:"",skuList:[]},supplierQuery:{supplierName:"",page:{pageSize:20,pageNum:1}}}},computed:{},watch:{pruchaseEditForm:{handler:function(e,t){e&&(this.editForm=Object.assign(this.editForm,e))},deep:!0}},methods:{changeValue:function(){this.$forceUpdate()},handleClose:function(){this.$emit("on-cancel-supplier-dialog")},updateData:function(e,t){var a=this,r={purchaseOrderNo:this.purchaseOrderNo,skuCode:t};Object(g["f"])(r).then((function(t){1==t.ret.errcode&&(a.editForm.skuList[e].supplyPrice=t.price)})).catch((function(e){console.log(e)}))},getSupplierList:function(e){var t=this;this.supplierQuery.supplierName=e,""!=e&&(this.supplierQuery.page.pageNum=1),Object(n["i"])(this.filterData(this.supplierQuery)).then((function(a){1===a.ret.errcode&&(t.supplierLists=e?a.list:t.deleteObject([].concat(Object(o["a"])(t.supplierLists),Object(o["a"])(a.list))))}))},clearSelect:function(){this.getSupplierList("")},loadMore:function(){""==this.supplierQuery.supplierName&&(this.supplierQuery.page.pageNum++,this.getSupplierList(""))},addProduct:function(){this.dialogProduct=!0},cancelAddProduct:function(){this.dialogProduct=!1},SyncNowRelationN:function(){var e=this;console.log(this.editForm.skuList),""==this.editForm.skuList[0].thirdNo?this.$message.warning("请填写第三方订单号"):_.forEach(this.editForm.skuList,(function(t,a){e.editForm.skuList[a].thirdNo=e.editForm.skuList[0].thirdNo,e.$forceUpdate()}))},cancelPurchase:function(e,t){var a=this;if(""==this.editForm.skuList[e].cancelReason)this.$message.error("请挑选当前SKU的取消原因");else{var r={purchaseOrderNo:this.purchaseOrderNo,skuCode:t,cancelReason:this.editForm.skuList[e].cancelReason};Object(g["e"])(r).then((function(t){if(1==t.ret.errcode){a.editForm.skuList[e].cancelStatus=1;var r=a.editForm.skuList[e];a.$set(a.editForm.skuList,e,r),a.$message.success("取消采购成功")}})).catch((function(e){console.log(e)}))}},addSkuOrder:function(e){var t=this;console.log(e),this.dialogProduct=!1,_.forEach(e,(function(e){e.skuValues=e.standardAttr,e.cancelStatus=2,e.skuName=e.productName,e.thirdNo=e.thirdOrderNo,e.cancelReason="",t.editForm.skuList.push(e)}))},addAutoPurchaseUpdate:function(e){var t=this,a=[];_.forEach(this.editForm.skuList,(function(e){a.push({skuCode:e.skuCode,purchaseCount:e.purchaseCount,thirdNo:e.thirdNo})}));var r={supplierId:this.editForm.supplierId,purchaseOrderNo:this.purchaseOrderNo,sku:a,isPurchase:1==e?1:2};Object(g["g"])(r).then((function(a){1==a.ret.errcode&&(t.$message({type:"success",message:2==e?"保存成功":"自动采购成功"}),t.$emit("on-confirm-success"))})).catch((function(e){console.log(e)}))},confirmPurchase:function(){var e=this,t={purchaseOrders:[this.purchaseOrderNo]};Object(g["h"])(t).then((function(t){1==t.ret.errcode&&(e.$message.success("可付款成功"),e.$emit("on-confirm-success"))})).catch((function(e){console.log(e)}))},returnReason:function(e){var t="";return _.forEach(this.createFailReason,(function(a){a.value==e&&(t=a.label)})),t}}},D=R,w=(a("eea5"),Object(C["a"])(D,d,p,!1,null,"cf0b0a72",null)),A=w.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"confirm_payment"},[a("el-dialog",{attrs:{title:"正在校验",visible:e.confirmDialogVisible,width:"30%","show-close":!1,"before-close":e.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.confirmDialogVisible=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.paymentLoading,expression:"paymentLoading"}],staticStyle:{height:"40px",width:"100%"},attrs:{id:"progress"}}),a("p",{staticStyle:{color:"#f56c6c","font-size":"14px","font-weight":"900","margin-bottom":"10px"}},[e._v("付款前校验中,请勿关闭页面")]),a("span",{staticClass:"tips",staticStyle:{"font-size":"12px"}},[e._v("说明：系统每次选取30个采购单执行付款前校验")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:e.handleClose}},[e._v("取消提交")])],1)]),a("el-dialog",{attrs:{visible:e.noConformDialog,width:"30%","show-close":!1,"before-close":e.noHandleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.noConformDialog=t}}},[a("p",{staticStyle:{"line-height":"40px"}},[e._v("\n      校验通过\n      "),a("span",{staticStyle:{color:"#409EFF","font-weight":"900"}},[e._v("0")]),e._v("单,请前往待付款异常标签页处理\n    ")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.noHandleClose}},[e._v("关 闭")])],1)]),a("el-dialog",{attrs:{title:"确认付款",visible:e.submitConformDialog,width:"800px","show-close":!1,"before-close":e.submitHandleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.submitConformDialog=t}}},[a("p",{staticStyle:{color:"#f56c6c","font-size":"14px","font-weight":"900","margin-bottom":"10px"}},[e._v("支付过程中,请勿关闭页面")]),a("div",e._l(e.checkContent,(function(t,r){return a("div",{key:r,staticClass:"payment_link1"},[a("ul",[a("li",[e._v("\n            校验通过\n            "),a("span",{staticClass:"weight_font"},[e._v(e._s(t.sum))]),e._v("单\n          ")]),a("li",[e._v("\n            合计采购总额：\n            "),a("span",{staticClass:"weight_font"},[e._v(e._s(t.purchaseAmount))])]),a("li",[e._v("\n            含运费：\n            "),a("span",{staticClass:"weight_font"},[e._v(e._s(t.freight))])]),-1!=t.checkPayNo.indexOf("KJB")?a("li",[a("el-button",{attrs:{type:"primary",size:"small",disabled:e.crossPay},on:{click:function(a){return e.goToPayment(t.checkPayNo,"1")}}},[e._v("生成跨境宝付款链接")])],1):a("li",[a("el-button",{attrs:{type:"primary",size:"small",disabled:e.alipay},on:{click:function(a){return e.goToPayment(t.checkPayNo,"2")}}},[e._v("生成支付宝付款链接")])],1)])])})),0),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.submitHandleClose}},[e._v("关 闭")])],1)])],1)},P=[],E={name:"beforeConfirmPayment",props:{confirmDialogVisible:{type:Boolean,default:!1},paymentLoading:{type:Boolean,default:!0},noConformDialog:{type:Boolean,default:!1},submitConformDialog:{type:Boolean,default:!1},checkContent:{type:Array,default:function(){return[]}}},data:function(){return{alipay:!1,crossPay:!1}},computed:{},watch:{},methods:{handleClose:function(){this.$emit("on-cancel","confirm")},noHandleClose:function(){this.$emit("on-cancel","noConfirm")},submitHandleClose:function(){this.$emit("on-cancel","submitConfirm"),this.alipay=!1,this.crossPay=!1},goToPayment:function(e,t){var a=this,r={checkPayNo:e};Object(g["k"])(r).then((function(e){1==e.ret.errcode&&("1"===t?a.crossPay=!0:a.alipay=!0,window.open(e.payUrl))}))}},mounted:function(){}},T=E,I=(a("68b0"),Object(C["a"])(T,N,P,!1,null,"a5994e32",null)),L=I.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingFail,expression:"loadingFail"}],ref:"tableRef",staticStyle:{width:"100%","overflow-y":"scroll"},attrs:{data:e.tableData,height:"100%"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{key:Math.random(),attrs:{type:"selection",width:"55",align:"center",fixed:"left"}}),a("el-table-column",{attrs:{label:"采购单号",width:"200",align:"center",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.purchaseOrderNo))]}}])}),"WAIT_PAY_ERROR"==e.type?a("el-table-column",{attrs:{label:"第三方订单号",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.thirdNo))]}}],null,!1,1312074367)}):e._e(),a("el-table-column",{attrs:{prop:"supplierName",label:"供应商名称",width:"200",align:"center"}}),a("el-table-column",{attrs:{prop:"purchaseType",label:"采购来源",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"purchaseAmount",label:"采购总金额",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"freight",label:"运费",align:"center",width:"100"}}),a("el-table-column",{key:Math.random(),attrs:{prop:"failReason",label:"失败原因",align:"center",width:"200"}}),a("el-table-column",{attrs:{label:"采购单状态",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["WAIT_PURCHASE"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{effect:"dark",type:"warning",size:"mini"}},[e._v("未采购")]):e._e(),"PURCHASED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{effect:"dark",size:"mini"}},[e._v("待发货")]):e._e(),"STOCKOUT"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v("缺货")]):e._e(),"SHIPPED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"success",effect:"dark",size:"mini"}},[e._v("待入库")]):e._e(),"STORAGED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{effect:"dark",size:"mini"}},[e._v("已入库")]):e._e(),"CANCLE"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("取消")]):e._e(),"CANCELED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("已取消")]):e._e(),a("div",[e._v(e._s(t.row.externalStatus))])]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"采购单创建时间",align:"center",width:"200"}}),a("el-table-column",{attrs:{label:"整单操作",align:"center",fixed:"right",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"order-btn-box"},[e.hasPermission("BTN_SKU_PURCHASE_1688_ORDER_EDIT")?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.openEditDialog(t.row,"edit")}}},[e._v("编辑")]):e._e(),e.hasPermission("BTN_ALL__1688_VIEW_DETAILS")?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.showPurchaseOrderDetail(t.row)}}},[e._v("查看详情")]):e._e(),e.hasPermission("BTN_ALL_1688_CANCEL")?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.confirmAllCancel(t.row)}}},[e._v("整单取消")]):e._e(),e.hasPermission("BTN_PURCHASE_1688_LIST_EXPORT")?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.exportEntireOrder(t.row)}}},[e._v("导出")]):e._e()],1)]}}])})],1)},$=[],q={name:"payFailTable",props:{tableData:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},type:{type:String,default:"CREATE_ERROR"}},data:function(){return{loading:!1,loadingFail:!1,hasSelectOrder:[],externalStatus:{1:"待自动下单",2:"已下单未付款",3:"采购成功",4:"自动下单失败",5:"采购取消",0:""}}},computed:{},watch:{},methods:{handleSelectionChange:function(e){this.hasSelectOrder=e,this.$emit("on-select",e)},openEditDialog:function(e,t){this.$emit("open-edit",{data:e,type:t})},showPurchaseOrderDetail:function(e){this.$emit("open-detail",e)},confirmAllCancel:function(e){var t=this;this.$confirm("确认取消此单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.allCancel(e);case 2:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消"})}))},allCancel:function(e){var t=this,a={purchaseOrderNo:e.purchaseOrderNo};Object(g["A"])(a).then((function(e){console.log(e),1===e.ret.errcode?(t.$message.success("整单取消成功！"),t.$emit("on-cancel")):"EXTERNAL_PURCHASE_UN_PAY"===tabActive?t.$confirm("1688取消订单失败，请人工取消或退款。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}):"EXTERNAL_UN_PURCHASE"===tabActive?t.$confirm("采购单已取消，但第三方系统取消订单失败，请务必人工登录对方系统操作取消订单或退款。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}):t.$message.error(e.message)})).catch((function(e){console.log(e)}))},confirmPurchase:function(e){var t=this;console.log(e);var a={purchaseNo:[e.purchaseOrderNo]};Object(g["a"])(a).then((function(e){1==e.ret.errcode&&(t.$message.success("自动采购成功"),t.$emit("on-success-purchase"))}))},exportEntireOrder:function(e){var t=this;this.loading=!0;var a={purchaseOrderNo:e.purchaseOrderNo};Object(g["E"])(a).then((function(e){if(t.loading=!1,1===e.ret.errcode){var a=e.fileUrl;window.open(t.dealShowFileSrc(a))}else t.$message.error(e.message)})).catch((function(e){t.loading=!1,console.log(e)}))}}},U=q,z=Object(C["a"])(U,x,$,!1,null,"1cc0df02",null),F=z.exports,j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingSuccess,expression:"loadingSuccess"}],ref:"tableRef",staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"100%"}},[a("el-table-column",{attrs:{label:"采购单号",width:"200",align:"center",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.purchaseOrderNo))]}}])}),a("el-table-column",{attrs:{label:"第三方订单号",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.thirdNo))]}}])}),a("el-table-column",{attrs:{prop:"supplierName",label:"供应商名称",width:"200",align:"center"}}),a("el-table-column",{attrs:{prop:"purchaseType",label:"采购来源",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"purchaseAmount",label:"采购总金额",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"freight",label:"运费",align:"center",width:"100"}}),a("el-table-column",{attrs:{label:"采购单状态",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["WAIT_PURCHASE"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{effect:"dark",type:"warning",size:"mini"}},[e._v("未采购")]):e._e(),"PURCHASED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{effect:"dark",size:"mini"}},[e._v("待发货")]):e._e(),"STOCKOUT"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v("缺货")]):e._e(),"SHIPPED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"success",effect:"dark",size:"mini"}},[e._v("待入库")]):e._e(),"STORAGED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{effect:"dark",size:"mini"}},[e._v("已入库")]):e._e(),"CANCLE"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("取消")]):e._e(),"CANCELED"===t.row.purchaseOrderStatus?a("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("已取消")]):e._e(),a("div",[e._v(e._s(t.row.externalStatus))])]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"采购单创建时间",align:"center",width:"200"}}),a("el-table-column",{attrs:{label:"整单操作",align:"center",fixed:"right",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"order-btn-box"},[e.hasPermission("BTN_ALL__1688_SKU_VIEW_DETAILS")?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.openEditDialog(t.row,"sku")}}},[e._v("SKU详情")]):e._e(),e.hasPermission("BTN_ALL__1688_VIEW_DETAILS")?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.showPurchaseOrderDetail(t.row)}}},[e._v("查看详情")]):e._e(),e.hasPermission("BTN_ALL_1688_CANCEL")&&"PAY_SUCCESS"!=e.type?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.confirmAllCancel(t.row)}}},[e._v("整单取消")]):e._e(),e.hasPermission("BTN_PURCHASE_1688_LIST_EXPORT")?a("el-button",{attrs:{type:"text",size:"mini",loading:e.loading},on:{click:function(a){return e.exportEntireOrder(t.row)}}},[e._v("导出")]):e._e()],1)]}}])})],1)},B=[],Y={name:"paySuccessTable",props:{tableData:{type:Array,default:function(){return[]}},loadingSuccess:{type:Boolean,default:!1},type:{type:String,default:"WAIT_PAY"}},data:function(){return{loading:!1,externalStatus:{1:"待自动下单",2:"已下单未付款",3:"采购成功",4:"自动下单失败",5:"采购取消",0:""}}},computed:{},watch:{},methods:{openEditDialog:function(e,t){this.$emit("open-edit",{data:e,type:t})},showPurchaseOrderDetail:function(e){this.$emit("open-detail",e)},confirmAllCancel:function(e){var t=this;this.$confirm("确认取消此单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.allCancel(e);case 2:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消"})}))},allCancel:function(e){var t=this,a={purchaseOrderNo:e.purchaseOrderNo};Object(g["A"])(a).then((function(e){console.log(e),1===e.ret.errcode?(t.$message.success("整单取消成功！"),t.$emit("on-cancel")):"EXTERNAL_PURCHASE_UN_PAY"===tabActive?t.$confirm("1688取消订单失败，请人工取消或退款。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}):"EXTERNAL_UN_PURCHASE"===tabActive?t.$confirm("采购单已取消，但第三方系统取消订单失败，请务必人工登录对方系统操作取消订单或退款。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}):t.$message.error(e.message)})).catch((function(e){console.log(e)}))},exportEntireOrder:function(e){var t=this;this.loading=!0;var a={purchaseOrderNo:e.purchaseOrderNo};Object(g["E"])(a).then((function(e){if(t.loading=!1,1===e.ret.errcode){var a=e.fileUrl;window.open(t.dealShowFileSrc(a))}else t.$message.error(e.message)})).catch((function(e){t.loading=!1,console.log(e)}))}}},H=Y,W=Object(C["a"])(H,j,B,!1,null,"b060813e",null),K=W.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"confirm_payment"},[a("el-dialog",{attrs:{title:"确认可付款",visible:e.dialogConfirm,width:"700px","show-close":!1,"close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogConfirm=t}}},[a("p",{staticStyle:{"line-height":"40px"}},[e._v("\n      已选中\n      "),a("span",{staticStyle:{color:"#409EFF",padding:"0 10px"}},[e._v(e._s(e.hasSelectTotal))]),e._v("单,确认可支付1688订单？\n    ")]),a("span",{staticClass:"tips",staticStyle:{"font-size":"14px"}},[e._v("说明：商品有起批量问题的采购单，付款后采购单的采购数量以您录入的数量为准，请知悉！")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.confirmSelect}},[e._v("确 认")]),a("el-button",{attrs:{size:"medium"},on:{click:e.handleClose}},[e._v("取 消")])],1)])],1)},M=[],Q=(a("c5f6"),{props:{hasSelectTotal:{type:Number,default:0},dialogConfirm:{type:Boolean,default:!1}},name:"confirmPayment",data:function(){return{}},computed:{},watch:{},methods:{handleClose:function(){this.$emit("on-cancel")},confirmSelect:function(){this.$emit("on-success")}}}),G=Q,X=Object(C["a"])(G,V,M,!1,null,"41c86b4c",null),J=X.exports,Z=a("17ef"),ee=a("84a3");function te(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=ae(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return n=e.done,e},e:function(e){s=!0,o=e},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}function ae(e,t){if(e){if("string"===typeof e)return re(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?re(e,t):void 0}}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var ie={},oe={name:"supplier1688Order",components:{comprehensiveDetails:l["a"],editSupplier:A,beforeConfirmPayment:L,payFailTable:F,paySuccessTable:K,confirmPayment:J,confirmPurchase:Z["a"]},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},faliReason:[{name:"订单状态错误",value:"1"},{name:"运费不一致",value:"2"},{name:"总金额不一致",value:"3"},{name:"SKU单价不一致",value:"4"},{name:"SKU数量不一致",value:"5"},{name:"SKU规格名称不一致",value:"6"},{name:"商品有起批量",value:"7"},{name:"商品下架",value:"8"},{name:"SKU缺货",value:"9"},{name:"SKU价格高于供货价",value:"10"},{name:"商品限购",value:"11"},{name:"卖家未授权分销",value:"12"},{name:"1688系统异常",value:"13"},{name:"交易方式不支持",value:"14"},{name:"FINGO系统异常",value:"15"},{name:"其他原因",value:"0"}],dialogTitle:"编辑采购单",purchaseOrderNo:"",percentage:0,dialogConfirm:!1,confirmDialogVisible:!1,paymentLoading:!1,noConformDialog:!1,submitConformDialog:!1,exportLoading:!1,exportNoImgLoading:!1,editSupplierDialog:!1,activeName:"CREATE_ERROR",drop:!1,total:0,loading:!1,loadingSuccess:!1,dropDownContent:"展开",dropDownIcon:"el-icon-arrow-down",tableData:[],supplierLists:[],queryData:{createFailReason:"",supplierId:"",skuCode:"",productName:"",productId:"",skuId:"",choseType:"",purchaseOrderNo:"",orderNo:"",timeList:[],value:"",cateId:"",thirdNo:"",startDate:"",endDate:"",tabType:"CREATE_ERROR",page:{pageSize:20,pageNum:1}},backCategoryOptions:[],supplierQuery:{supplierName:"",page:{pageSize:20,pageNum:1}},productOptionList:[{name:"skuCode",code:"1"},{name:"商品名称",code:"2"},{name:"skuID",code:"3"},{name:"商品ID",code:"4"}],List:{parcelAnomaly:"",total:0,detailList:[],productList:[],relList1:[],relList2:[],show:!1,param:{pageSize:10,pageNum:1}},hasSelectOrder:[],pruchaseEditForm:{},checkContent:[],purchaseList:[],details:[],transferList:[],editDialog:{confirmPurchase:{show:!1},stockOutDetails:{show:!1},Original:{show:!1},Supplement:{show:!1},cancelnum:{show:!1},show:!1,type:"edit",title:"采购订单编辑",param:{maxCount:"",incomeNum:"",storageCount:"",purchaseOrderNo:"",fingoSkuCode:"",purchaseOrderStatus:"",purchaseSource:"",purchasePrice:"",freight:"",deliveWay:"",forwarderCode:"",systemCount:"",purchaseCount:"",purchaseActualCount:"",logisticsSingle:"",thirdOrderNo:"",supplierId:"",synSwitch:!1,content:"",cancelCount:"",count:"",availableShipCount:"",warehouseName:"",warehouseNo:""}}}},computed:{},watch:{},mounted:function(){var e=this;this.getSupplierList(""),this.fetchCategory({level:1,cateType:2,resolve:function(t){e.backCategoryOptions=t}}),this.getAutoPurchaseOrderList()},methods:{getTransferList:function(){var e=this;Object(ee["n"])().then((function(t){1===t.ret.errcode&&(console.log(t),e.transferList=t.twhList)}))},successPurchase:function(){this.getAutoPurchaseOrderList()},autoPurchaseSuccess:function(){this.editSupplierDialog=!1,this.getAutoPurchaseOrderList()},cancelPurchaseOrder:function(){this.getAutoPurchaseOrderList()},resetSearch:function(){this.queryData={createFailReason:"",supplierId:"",skuCode:"",productName:"",productId:"",skuId:"",choseType:"",purchaseOrderNo:"",orderNo:"",timeList:[],value:"",cateId:"",thirdNo:"",startDate:"",endDate:"",tabType:this.activeName,page:{pageSize:20,pageNum:1}},this.getParams(),this.queryData.page.pageNum=1,this.hasSelectOrder=[],this.getAutoPurchaseOrderList()},getParams:function(){console.log(this.queryData.timeList),this.queryData.timeList&&this.queryData.timeList.length?(this.queryData.startDate=this.queryData.timeList[0],this.queryData.endDate=this.queryData.timeList[1]):(this.queryData.startDate="",this.queryData.endDate=""),1==this.queryData.choseType?(this.queryData.skuCode=this.queryData.value,this.queryData.productName="",this.queryData.skuId="",this.queryData.productId=""):2==this.queryData.choseType?(this.queryData.productName=this.queryData.value,this.queryData.skuCode="",this.queryData.skuId="",this.queryData.productId=""):3==this.queryData.choseType?(this.queryData.skuId=this.queryData.value,this.queryData.skuCode="",this.queryData.productName="",this.queryData.productId=""):4==this.queryData.choseType&&(this.queryData.productId=this.queryData.value,this.queryData.skuCode="",this.queryData.productName="",this.queryData.skuId=""),this.queryData.tabType=this.activeName,ie=Object.assign(this.queryData,{})},getAutoPurchaseOrderList:function(e){var t=this;this.getParams(),1==e&&(ie.page.pageNum=1),"CREATE_ERROR"==this.activeName||"WAIT_PAY_ERROR"==this.activeName?this.loading=!0:"WAIT_PAY"!=this.activeName&&"PAY_SUCCESS"!=this.activeName||(this.loadingSuccess=!0),Object(g["d"])(this.filterData(ie)).then((function(e){console.log(e),1==e.ret.errcode?(t.tableData=e.pbList,t.total=e.total,t.loading=!1,t.loadingSuccess=!1):(t.loading=!1,t.loadingSuccess=!1)})).catch((function(e){t.loading=!1,t.loadingSuccess=!1}))},getListnew:function(){this.getAutoPurchaseOrderList()},validtorPay:function(){var e=this;this.getParams(),this.confirmDialogVisible=!0,this.paymentLoading=!0,Object(g["b"])(this.filterData(ie)).then((function(t){1==t.ret.errcode&&(e.confirmDialogVisible=!1,e.paymentLoading=!1,0==t.successSum?e.noConformDialog=!0:(e.submitConformDialog=!0,e.checkContent=t.checkContent))})).catch((function(e){console.log(e)}))},cancelConfirm:function(e){"confirm"==e?this.confirmDialogVisible=!1:"noConfirm"==e?this.noConformDialog=!1:"submitConfirm"==e&&(this.submitConformDialog=!1)},closeSupplierDialog:function(){this.editSupplierDialog=!1},openEditDialog:function(e){var t=this;this.purchaseOrderNo=e.data.purchaseOrderNo,"edit"==e.type?(this.dialogTitle="编辑采购单",this.$refs["editDialog"].getSupplierList(e.data.supplierName)):this.dialogTitle="sku详情";var a={purchaseOrderNo:this.purchaseOrderNo};Object(g["c"])(a).then((function(e){1==e.ret.errcode&&(t.pruchaseEditForm=e,t.editSupplierDialog=!0)})).catch((function(e){console.log(e)}))},handleTabChange:function(e){this.queryData={createFailReason:"",supplierId:"",skuCode:"",productName:"",productId:"",skuId:"",choseType:"",purchaseOrderNo:"",orderNo:"",timeList:[],value:"",cateId:"",thirdNo:"",startDate:"",endDate:"",tabType:e.name,page:{pageSize:20,pageNum:1}},this.getParams(),this.queryData.page.pageNum=1,this.hasSelectOrder=[],this.getAutoPurchaseOrderList()},hasSelectOrderList:function(e){this.hasSelectOrder=e},autoPurchase:function(e){var t=this;if(0==this.hasSelectOrder.length)this.$message.warning("请选择要自动采购的采购单");else{console.log(this.hasSelectOrder);var a={purchaseNo:[],isUseSpotPrice:e};u.a.forEach(this.hasSelectOrder,(function(e){a.purchaseNo.push(e.purchaseOrderNo)}));var r=this.$loading({lock:!0,text:"正在采购中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(g["a"])(a).then((function(a){1==a.ret.errcode&&(r.close(),t.hasSelectOrder=[],t.getAutoPurchaseOrderList(),t.$message({type:"success",message:e?"选中的采购单已现货价下单":"选中的采购单已发起1688自动采购"}))}))}},openConfirmDialog:function(){console.log(this.hasSelectOrder),0==this.hasSelectOrder.length?this.$message.warning("请选择要付款的采购单"):this.dialogConfirm=!0},confirmPay:function(){var e=this,t={purchaseOrders:[]};u.a.forEach(this.hasSelectOrder,(function(e){t.purchaseOrders.push(e.purchaseOrderNo)})),Object(g["h"])(t).then((function(t){1==t.ret.errcode&&(e.dialogConfirm=!1,e.getAutoPurchaseOrderList())})).catch((function(e){console.log(e)}))},cancelConfirmDialog:function(){this.dialogConfirm=!1},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="el-icon-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="el-icon-arrow-up"),this.drop=!this.drop},getRowKeys:function(e){return 1==this.activeName||3==this.activeName?e.date:2==this.activeName||4==this.activeName?e.name:void 0},getBackSubCategory:function(e,t){if(0!=e.level){var a=e.value;this.fetchCategory({pid:parseInt(a),cateType:2,level:e.level+1,resolve:t})}},fetchCategory:function(e){var t=e.id,a=e.cateType,r=e.level,i=e.pid,o=e.page,n=e.resolve;Object(s["V"])(this.filterData({pid:i,id:t,level:r,cateType:a,page:o})).then((function(e){if(1===e.ret.errcode){for(var t=0;t<e.categoryUnit.length;t++){e.categoryUnit[t]["levelValue"]=[];var i=e.categoryUnit[t].cateNameValue.find((function(e){return"cn"==e.languageCode}));e.categoryUnit[t]["cateName"]=i?i.name:"",e.categoryUnit[t]["cateId"]=String(e.categoryUnit[t]["cateId"]),e.categoryUnit[t]["leaf"]=2==a?r>2:r>1}n&&n(e.categoryUnit,e)}}))},getSupplierList:function(e){var t=this;this.supplierQuery.supplierName=e,""!=e&&(this.supplierQuery.page.pageNum=1),Object(n["i"])(this.filterData(this.supplierQuery)).then((function(a){1===a.ret.errcode&&(t.supplierLists=e?a.list:t.deleteObject([].concat(Object(o["a"])(t.supplierLists),Object(o["a"])(a.list))))}))},loadMore:function(){""==this.supplierQuery.supplierName&&(this.supplierQuery.page.pageNum++,this.getSupplierList(""))},showPurchaseOrderDetail:function(e){var t=this,a=(e={purchaseOrderNo:e.purchaseOrderNo,details:[]},{purchaseOrderNo:e.purchaseOrderNo});Object(g["c"])(a).then((function(a){if(1==a.ret.errcode){e.details=a.skuList,t.List.show=!0,t.List.purchaseOrderNo=e.purchaseOrderNo;var r,i=te(e.details);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.$refs.purchaseOrderDetail.getAllSkuDeliveryDetail(o.skuCode)}}catch(c){i.e(c)}finally{i.f()}var n,s=te(e.details);try{for(s.s();!(n=s.n()).done;){var l=n.value;t.$refs.purchaseOrderDetail.getAllSkuAbnormalDetail(l.skuCode)}}catch(c){s.e(c)}finally{s.f()}t.$refs.purchaseOrderDetail.getPurchaseOrderDetail(),t.$refs.purchaseOrderDetail.getPurchaseLogiList(),t.$refs.purchaseOrderDetail.getPurchaseAssociatedOrderList(),t.$refs.purchaseOrderDetail.getPurchaseStatusRate()}})).catch((function(e){console.log(e)}))},handleCurrentChange:function(e){this.queryData.page.pageNum=e,this.getAutoPurchaseOrderList()},handleSizeChange:function(e){this.queryData.page.pageSize=e,this.getAutoPurchaseOrderList()}}},ne=oe,se=(a("fee9"),Object(C["a"])(ne,r,i,!1,null,"09a8e569",null));t["default"]=se.exports},e64c:function(e,t,a){},e77f:function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"i",(function(){return o})),a.d(t,"f",(function(){return n})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return p}));var r=a("284b");function i(e){console.log(e);var t=r["a"].create("InventoryPageReq",e);return Object(r["a"])("erp","InventoryBossService.InventoryPage",t,"inventory.InventoryPageResp")}function o(e){console.log(e);var t=r["a"].create("InventoryRecordPageReq",e);return Object(r["a"])("erp","InventoryBossService.InventoryRecordPage",t,"inventory.InventoryRecordPageResp")}function n(e){console.log(e);var t=r["a"].create("AdminUpdateInventoryReq",e);return Object(r["a"])("erp","InventoryBossService.AdminUpdateInventory",t,"inventory.AdminUpdateInventoryResp")}function s(e){console.log(e);var t=r["a"].create("AdminUpdateInventoryReq",e);return Object(r["a"])("erp","InventoryBossService.AdminUpdateInventory",t,"inventory.AdminUpdateInventoryResp")}function l(e){var t=r["a"].create("SkuInfoReq",e);return Object(r["a"])("erp","InventoryBossService.GetSkuInfo",t,"inventory.SkuInfoResp")}function c(e){var t=r["a"].create("AddInventoryReq",e);return Object(r["a"])("erp","InventoryBossService.AddInventory",t,"inventory.AddInventoryResp")}function u(e){var t=r["a"].create("GetRecordTypeReq",e);return Object(r["a"])("erp","InventoryBossService.GetRecordType",t,"inventory.GetRecordTypeResp")}function d(e){var t=r["a"].create("SupplierInventoryDataReq",e);return Object(r["a"])("erp","InventoryBossService.QuerySupplierInventoryByCondition",t,"inventory.SupplierInventoryDataResp")}function p(e){var t=r["a"].create("SupplierInventoryRecordReq",e);return Object(r["a"])("erp","InventoryBossService.QuerySupplierInventoryRecordByCondition",t,"inventory.SupplierInventoryRecordResp")}},eea5:function(e,t,a){"use strict";var r=a("b388"),i=a.n(r);i.a},fee9:function(e,t,a){"use strict";var r=a("e64c"),i=a.n(r);i.a}}]);