(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1543c4bc"],{"03b7":function(e,a,t){"use strict";var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("el-dialog",{staticClass:"work-order-dialog",attrs:{title:"关闭工单",width:"700px",visible:e.showDialog},on:{close:function(a){return e.closeDialog()}}},[t("common-detail",{attrs:{workOrderNo:e.workOrderNo,collapseArray:e.collapseArray}}),t("el-collapse",{model:{value:e.collapseArray,callback:function(a){e.collapseArray=a},expression:"collapseArray"}},[t("el-collapse-item",{attrs:{title:"操作",name:"4"}},[t("el-form",{ref:"closeWorkOrder",attrs:{"label-width":"80px",rules:e.rules,model:e.params}},[t("el-form-item",{attrs:{label:""}},[t("el-radio-group",{on:{change:e.clearValidate},model:{value:e.dealType,callback:function(a){e.dealType=a},expression:"dealType"}},e._l(e.typeList,(function(a,r){return t("el-radio",{key:r,attrs:{label:r}},[e._v(e._s(a))])})),1)],1),0==e.dealType?t("el-form-item",{attrs:{label:"跟进补充：",prop:"dealConetent"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入跟进补充",rows:2},model:{value:e.params.dealConetent,callback:function(a){e.$set(e.params,"dealConetent",a)},expression:"params.dealConetent"}})],1):t("el-form-item",{attrs:{label:"关闭备注："}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入关闭备注",maxLength:"2000",rows:2},model:{value:e.params.dealConetent,callback:function(a){e.$set(e.params,"dealConetent",a)},expression:"params.dealConetent"}})],1),t("el-form-item",{attrs:{label:"上传附件："}},[e.showDialog?t("c-upload",{attrs:{fileList:e.params.dealPic,limit:30,listType:"text"},on:{setData:e.setCoverImg}}):e._e()],1),1==e.dealType?t("el-form-item",{attrs:{label:"抄送："}},[t("el-select",{attrs:{"remote-method":e.getAdminUserList,placeholder:"请选择",size:"medium",clearable:"",filterable:"",remote:""},model:{value:e.params.ccManagerId,callback:function(a){e.$set(e.params,"ccManagerId",a)},expression:"params.ccManagerId"}},e._l(e.adminUserList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.realName,value:e.id}})})),1)],1):e._e()],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(a){return e.closeDialog()}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmCloseItem}},[e._v("确 定")])],1)],1)},l=[],o=t("f1ca"),s=t("6d47"),i=t("403c"),n=t("f09b"),c={props:{showDialog:{type:Boolean,default:!1},collapseArray:Array,workOrderNo:String},mixins:[i["a"]],components:{commonDetail:o["a"],cUpload:n["a"]},data:function(){return{params:{dealConetent:"",dealPic:"",ccManagerId:""},rules:{dealConetent:[{required:!0,message:"不能为空",trigger:"change"}]},dealType:"",typeList:{0:"跟进补充",1:"关闭工单"},imgList:[],uploadFileUrl:"".concat("https://temp.fingo.shop/fingo/product_manage/ImageUpload"),uploadFileName:"".concat("file"),headers:this.$headers}},watch:{workOrderNo:function(e){e&&(this.params={dealConetent:"",dealPic:"",ccManagerId:""},this.clearValidate())}},methods:{clearValidate:function(){this.$refs["closeWorkOrder"]&&this.$refs["closeWorkOrder"].clearValidate()},confirmCloseItem:function(){var e=this;this.$refs["closeWorkOrder"].validate((function(a){if(a){var t=s["g"];1==e.dealType&&(t=s["e"]),t(e.filterData(Object.assign(e.params,{workOrderNo:e.workOrderNo}))).then((function(a){console.log(a),1===a.ret.errcode&&(e.$message.success("设置成功"),e.closeDialog())}))}}))},setCoverImg:function(e){this.params.dealPic=e.data},closeDialog:function(){this.$emit("close")}}},d=c,m=(t("3d4e"),t("2877")),p=Object(m["a"])(d,r,l,!1,null,null,null);a["a"]=p.exports},"06c9":function(e,a,t){},"13cf":function(e,a,t){"use strict";var r=t("d5eb"),l=t.n(r);l.a},"3d4e":function(e,a,t){"use strict";var r=t("06c9"),l=t.n(r);l.a},4055:function(e,a,t){"use strict";var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("el-dialog",{attrs:{title:"工单详情页",width:"700px",visible:e.showDialog},on:{close:function(a){return e.closeDialog()}}},[t("common-detail",{attrs:{workOrderNo:e.workOrderNo,collapseArray:e.collapseArray}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(a){return e.closeDialog()}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.closeDialog()}}},[e._v("确 定")])],1)],1)},l=[],o=t("f1ca"),s={props:{showDialog:{type:Boolean,default:!1},collapseArray:Array,workOrderNo:String},data:function(){return{}},components:{commonDetail:o["a"]},methods:{closeDialog:function(){this.$emit("close")}}},i=s,n=t("2877"),c=Object(n["a"])(i,r,l,!1,null,null,null);a["a"]=c.exports},"42f5":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"filter-container"},[t("el-form",{ref:"workOrderFilterForm",attrs:{inline:"","label-width":"100px",model:e.params}},[t("el-form-item",{attrs:{label:"关键字："}},[t("el-input",{attrs:{placeholder:"请输入关键字",size:"medium"},model:{value:e.params.selectParam,callback:function(a){e.$set(e.params,"selectParam",a)},expression:"params.selectParam"}})],1),t("el-form-item",{attrs:{label:"创建日期："}},[t("el-date-picker",{attrs:{type:"daterange","value-format":"timestamp","start-placeholder":"时间起","end-placeholder":"时间止","default-time":["00:00:00","23:59:59"]},model:{value:e.timeList,callback:function(a){e.timeList=a},expression:"timeList"}})],1),t("span",{directives:[{name:"show",rawName:"v-show",value:e.drop,expression:"drop"}]},[t("el-form-item",{attrs:{label:"用户ID："}},[t("el-input",{attrs:{placeholder:"请输入用户ID",size:"medium"},model:{value:e.params.userId,callback:function(a){e.$set(e.params,"userId",a)},expression:"params.userId"}})],1),t("el-form-item",{attrs:{label:"手机号："}},[t("el-input",{attrs:{placeholder:"请输入用户手机号",size:"medium"},model:{value:e.params.userMobile,callback:function(a){e.$set(e.params,"userMobile",a)},expression:"params.userMobile"}})],1),t("el-form-item",{attrs:{label:"订单号："}},[t("el-input",{attrs:{placeholder:"请输入订单号",size:"medium"},model:{value:e.params.orderNo,callback:function(a){e.$set(e.params,"orderNo",a)},expression:"params.orderNo"}})],1),t("el-form-item",{attrs:{label:"是否分派："}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"medium"},model:{value:e.params.doDispatch,callback:function(a){e.$set(e.params,"doDispatch",a)},expression:"params.doDispatch"}},e._l(e.dispatchMap,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.key}})})),1)],1),t("el-form-item",{attrs:{label:"创建人："}},[t("el-select",{attrs:{"remote-method":e.getAdminUserList,placeholder:"请选择",size:"medium",clearable:"",filterable:"",remote:""},model:{value:e.params.createManagerId,callback:function(a){e.$set(e.params,"createManagerId",a)},expression:"params.createManagerId"}},e._l(e.adminUserList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.realName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"当前处理人："}},[t("el-select",{attrs:{"remote-method":e.getAdminUserList,placeholder:"请选择",size:"medium",clearable:"",filterable:"",remote:""},model:{value:e.params.currentDealManagerId,callback:function(a){e.$set(e.params,"currentDealManagerId",a)},expression:"params.currentDealManagerId"}},e._l(e.adminUserList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.realName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"工单来源："}},[t("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择",size:"medium"},model:{value:e.params.workOrderSource,callback:function(a){e.$set(e.params,"workOrderSource",a)},expression:"params.workOrderSource"}},e._l(e.sourceList,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:a}})})),1)],1),t("el-form-item",{attrs:{label:"紧急程度："}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"medium"},model:{value:e.params.emergencyLevel,callback:function(a){e.$set(e.params,"emergencyLevel",a)},expression:"params.emergencyLevel"}},e._l(e.emergencyLevel,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.key}})})),1)],1),t("el-form-item",{attrs:{label:"历史处理人："}},[t("el-select",{attrs:{"remote-method":e.getAdminUserList,placeholder:"请选择",size:"medium",clearable:"",filterable:"",remote:""},model:{value:e.params.historyDealManagerId,callback:function(a){e.$set(e.params,"historyDealManagerId",a)},expression:"params.historyDealManagerId"}},e._l(e.adminUserList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.realName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"标签："}},[t("el-cascader",{attrs:{props:{value:"id",label:"tagName",children:"subTags"},options:e.tagList},on:{change:e.setTagId},model:{value:e.params.tagId,callback:function(a){e.$set(e.params,"tagId",a)},expression:"params.tagId"}})],1),t("el-form-item",{attrs:{label:"工单状态："}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择",size:"medium"},model:{value:e.params.workOrderStatus,callback:function(a){e.$set(e.params,"workOrderStatus",a)},expression:"params.workOrderStatus"}},e._l(e.WorkOrderStatusEnum,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:a}})})),1)],1)],1),t("el-form-item",{staticClass:"filter-item",staticStyle:{"margin-left":"20px"}},[t("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"medium"},on:{click:function(a){return e.getList(1)}}},[e._v("搜索")]),t("el-button",{attrs:{icon:"el-icon-refresh-left",size:"medium"},on:{click:e.resetSearch}},[e._v("重置")]),t("el-button",{attrs:{icon:"el-icon-download",type:"primary",plain:"",size:"medium"},on:{click:e.clickToExport}},[e._v("导出")]),t("el-link",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",underline:!1},on:{click:e.dropDown}},[e._v("\n                    "+e._s(e.dropDownContent)+"\n                    "),t("i",{class:e.dropDownIcon})])],1)],1)],1),t("div",{staticClass:"main-content-wrapper"},[t("el-table",{attrs:{border:"",height:"100%",data:e.dataList}},[t("el-table-column",{attrs:{prop:"workOrderNo",label:"工单ID",fixed:"left",align:"center",width:"150px"}}),t("el-table-column",{attrs:{prop:"createDate",align:"center",label:"创建时间",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n                    "+e._s(e._f("formatTime")(a.row.createDate))+"\n                ")]}}])}),t("el-table-column",{attrs:{prop:"userId",label:"用户ID",align:"center"}}),t("el-table-column",{attrs:{prop:"userNickName",label:"客户姓名",align:"center"}}),t("el-table-column",{attrs:{prop:"tagName",label:"标签",align:"center"}}),t("el-table-column",{attrs:{label:"紧急程度",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n                    "+e._s(e.getNameByKey(a.row.emergencyLevel,"emergencyLevel"))+"\n                ")]}}])}),t("el-table-column",{attrs:{prop:"createManagerName",label:"创建人",align:"center"}}),t("el-table-column",{attrs:{prop:"currentDealManagerName",label:"当前处理人",align:"center","min-width":"100"}}),t("el-table-column",{attrs:{prop:"",label:"分配处理",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n                    "+e._s(e.getNameByKey(a.row.doDispatch,"dispatchMap"))+"\n                ")]}}])}),t("el-table-column",{attrs:{label:"工单状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n                    "+e._s(e.WorkOrderStatusEnum[a.row.workOrderStatus])+"\n                ")]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"table-action-btn-box"},[!e.hasPermission("BTN_CREATED_WORD_ORDER_DEAL")||1!=a.row.workOrderStatus||a.row.currentDealManagerId!=e.userInfo.id&&"admin"!=e.userInfo.account?e._e():t("el-button",{attrs:{plain:"",type:"success",size:"mini"},on:{click:function(t){return e.showWorkOrderDialog("dealDialog",a.row)}}},[e._v("处理工单\n                        ")]),!e.hasPermission("BTN_CREATED_WORD_ORDER_CLOSE")||2!=a.row.workOrderStatus||a.row.currentDealManagerId!=e.userInfo.id&&"admin"!=e.userInfo.account?e._e():t("el-button",{attrs:{plain:"",type:"danger",size:"mini"},on:{click:function(t){return e.showWorkOrderDialog("closeDialog",a.row)}}},[e._v("关闭工单\n                        ")]),e.hasPermission("BTN_CREATED_WORD_ORDER_DETAIL")?t("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(t){return e.showWorkOrderDialog("detailDialog",a.row)}}},[e._v("查看详情\n                        ")]):e._e()],1)]}}])})],1)],1),t("div",{staticClass:"pagination-box"},[t("el-pagination",{attrs:{"current-page":e.params.page.pageNum,"page-sizes":[5,10,20,50],"page-size":e.params.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totals},on:{"size-change":e.handleSizeChange,"current-change":e.getList}})],1),t("close-work-order",{attrs:{showDialog:e.closeDialog.show,collapseArray:["2","4"],workOrderNo:e.closeDialog.workOrderNo},on:{close:function(a){return e.closeWorkOrderDialog("closeDialog")}}}),t("deal-work-order",{attrs:{showDialog:e.dealDialog.show,collapseArray:["2","4"],workOrderNo:e.dealDialog.workOrderNo},on:{close:function(a){return e.closeWorkOrderDialog("dealDialog")}}}),t("work-order-detail",{attrs:{showDialog:e.detailDialog.show,collapseArray:["1","2","3"],workOrderNo:e.detailDialog.workOrderNo},on:{close:function(a){return e.closeWorkOrderDialog("detailDialog")}}})],1)},l=[],o=t("a655"),s=t("4055"),i=t("03b7"),n=t("6d47"),c=t("403c"),d={mixins:[c["a"]],data:function(){return{drop:!1,dropDownContent:"展开",dropDownIcon:"el-icon-arrow-down",totals:0,timeList:[],params:{selectParam:"",userId:"",userMobile:"",emergencyLevel:"",doDispatch:1,createManagerId:"",currentDealManagerId:"",ccManagerId:"",workOrderSource:"",historyDealManagerId:"",tagId:"",workOrderStatus:"",orderNo:"",page:{pageSize:10,pageNum:1,pagingSwitch:!0}},tagList:[],dataList:[],closeDialog:{show:!1,workOrderNo:""},detailDialog:{show:!1,workOrderNo:""},dealDialog:{show:!1,workOrderNo:""},userInfo:{id:null,account:""}}},components:{dealWorkOrder:o["a"],workOrderDetail:s["a"],closeWorkOrder:i["a"]},computed:{nowEnd:function(){return this.$store.state.globalNum.nowEnd},lastMonth:function(){return this.$store.state.globalNum.lastMonth}},created:function(){this.timeList=[this.lastMonth,this.nowEnd],this.getList(),this.getTagList(),localStorage.adminUserInfo&&(this.userInfo=JSON.parse(localStorage.adminUserInfo))},methods:{dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="el-icon-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="el-icon-arrow-up"),this.drop=!this.drop},handleSizeChange:function(e){this.params.page.pageSize=e,this.getList(1)},getTagList:function(){var e=this;Object(n["j"])({}).then((function(a){if(console.log(a),1===a.ret.errcode){e.tagList=[];for(var t=0;t<a.data.length;t++){for(var r={groupId:a.data[t].groupId,id:a.data[t].id,tagName:a.data[t].tagName,subTags:[]},l=0;l<a.data[t].subTags.length;l++)r.subTags.push({groupId:a.data[t].subTags[l].groupId,id:a.data[t].subTags[l].id,tagName:a.data[t].subTags[l].tagName});e.tagList.push(r)}}}))},setTagId:function(e){e.length>0&&(this.params.tagId=parseInt(e[1]))},getList:function(e){var a=this;this.params.page.pageNum=e||this.params.page.pageNum,this.timeList=this.timeList?this.timeList:[],Object(n["o"])(this.filterData(Object.assign(this.params,{startDate:this.timeList[0]?this.timeList[0]:null,endDate:this.timeList[1]?this.timeList[1]:null}))).then((function(e){console.log(e),1===e.ret.errcode&&(console.log(e),a.dataList=e.data,a.totals=e.total)}))},closeWorkOrderDialog:function(e){this[e].show=!1,this[e].workOrderNo="",this.getList()},showWorkOrderDialog:function(e,a){this[e].show=!0,this[e].workOrderNo=a.workOrderNo},resetSearch:function(){this.params={selectParam:"",userId:"",userMobile:"",emergencyLevel:"",doDispatch:"",createManagerId:"",currentDealManagerId:"",ccManagerId:"",workOrderSource:"",historyDealManagerId:"",tagId:"",workOrderStatus:"",orderNo:"",page:{pageSize:10,pageNum:1,pagingSwitch:!0}},this.timeList=[]},clickToExport:function(){var e=this;this.timeList&&2===this.timeList.length?Object(n["n"])(this.filterData(Object.assign(this.params,{startDate:this.timeList[0]?this.timeList[0]:null,endDate:this.timeList[1]?this.timeList[1]:null}))).then((function(a){if(console.log(a),1===a.ret.errcode){var t=document.createElement("a");t.src=e.dealShowFileSrc(a.fileUrl),t.href=e.dealShowFileSrc(a.fileUrl),t.click()}})):this.$message({type:"warning",message:"请选择导出日期范围"})}}},m=d,p=t("2877"),u=Object(p["a"])(m,r,l,!1,null,null,null);a["default"]=u.exports},a655:function(e,a,t){"use strict";var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("el-dialog",{attrs:{title:"工单详情页",width:"700px",visible:e.showDialog},on:{close:function(a){return e.closeDialog()}}},[t("common-detail",{attrs:{workOrderNo:e.workOrderNo,collapseArray:e.collapseArray}}),t("el-collapse",{model:{value:e.collapseArray,callback:function(a){e.collapseArray=a},expression:"collapseArray"}},[t("el-collapse-item",{attrs:{title:"操作",name:"4"}},[t("el-form",{ref:"dealWorkOrder",attrs:{"label-width":"80px",model:e.params,rules:e.rules}},[t("el-form-item",{attrs:{label:"问题解决：",prop:"dealType"}},[t("el-radio-group",{model:{value:e.params.dealType,callback:function(a){e.$set(e.params,"dealType",a)},expression:"params.dealType"}},e._l(e.typeList,(function(a,r){return t("el-radio",{key:r,attrs:{label:r}},[e._v(e._s(a))])})),1)],1),4==e.params.dealType?[t("el-form-item",{attrs:{label:"转派工单：",prop:"turnSendType"}},[t("el-radio-group",{model:{value:e.params.turnSendType,callback:function(a){e.$set(e.params,"turnSendType",a)},expression:"params.turnSendType"}},e._l(e.turnSendType,(function(a,r){return t("el-radio",{key:r,attrs:{label:r}},[e._v(e._s(a))])})),1)],1),0==e.params.turnSendType?t("el-form-item",{attrs:{label:"处理人：",prop:"dealManagerId"}},[t("el-select",{attrs:{"remote-method":e.getAdminUserList,placeholder:"请选择",size:"medium",clearable:"",filterable:"",remote:""},model:{value:e.params.dealManagerId,callback:function(a){e.$set(e.params,"dealManagerId",a)},expression:"params.dealManagerId"}},e._l(e.adminUserList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.realName,value:e.id}})})),1)],1):e._e()]:e._e(),t("el-form-item",{attrs:{label:"处理说明："}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入2000字符以内",maxLength:"2000",rows:2},model:{value:e.params.dealConetent,callback:function(a){e.$set(e.params,"dealConetent",a)},expression:"params.dealConetent"}})],1),t("el-form-item",{attrs:{label:"上传图片："}},[e.showDialog?t("c-upload",{attrs:{fileList:e.params.dealPic,limit:30,listType:"text"},on:{setData:e.setCoverImg}}):e._e()],1),4!=e.params.dealType?[t("el-form-item",{attrs:{label:"工单评价："}},[t("el-checkbox-group",{model:{value:e.params.dealEvaluation,callback:function(a){e.$set(e.params,"dealEvaluation",a)},expression:"params.dealEvaluation"}},e._l(e.evaluationMap,(function(a,r){return t("el-checkbox",{key:r,attrs:{label:r}},[e._v(e._s(a))])})),1)],1)]:e._e(),t("el-form-item",{attrs:{label:"抄送："}},[t("el-select",{attrs:{"remote-method":e.getAdminUserList,placeholder:"请选择",size:"medium",clearable:"",filterable:"",remote:""},model:{value:e.params.ccManagerId,callback:function(a){e.$set(e.params,"ccManagerId",a)},expression:"params.ccManagerId"}},e._l(e.adminUserList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.realName,value:e.id}})})),1)],1)],2)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(a){return e.closeDialog()}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.confirmDealOrder()}}},[e._v("确 定")])],1)],1)},l=[],o=t("f1ca"),s=t("6d47"),i=t("403c"),n=t("f09b"),c={props:{showDialog:{type:Boolean,default:!1},collapseArray:Array,workOrderNo:String},mixins:[i["a"]],data:function(){return{params:{dealType:"4",dealEvaluation:[],dealManagerId:"",dealPic:"",dealConetent:"",ccManagerId:"",turnSendType:"0"},rules:{dealType:[{required:!0,message:"不能为空",trigger:"change"}],turnSendType:[{required:!0,message:"不能为空",trigger:"change"}],dealManagerId:[{required:!0,message:"不能为空",trigger:"change"}]},evaluationMap:{1:"标签有误",2:"无需处理",3:"非本人处理",4:"其他"},typeList:{4:"转派",5:"退单",6:"已解决"},turnSendType:{0:"按人转派",1:"按标签转派"},imgList:[],uploadFileUrl:"".concat("https://temp.fingo.shop/fingo/product_manage/ImageUpload"),uploadFileName:"".concat("file"),headers:this.$headers}},components:{commonDetail:o["a"],cUpload:n["a"]},watch:{workOrderNo:function(e){e&&(this.params={dealType:"4",dealEvaluation:[],dealManagerId:"",dealPic:"",dealConetent:"",ccManagerId:"",turnSendType:"0"})}},methods:{setCoverImg:function(e){this.params.dealPic=e.data},confirmDealOrder:function(){var e=this;this.$refs["dealWorkOrder"].validate((function(a){a&&Object(s["f"])(e.filterData(Object.assign(e.params,{workOrderNo:e.workOrderNo}))).then((function(a){1===a.ret.errcode&&(e.$message.success("处理成功"),e.closeDialog())}))}))},closeDialog:function(){this.$emit("close")}}},d=c,m=t("2877"),p=Object(m["a"])(d,r,l,!1,null,null,null);a["a"]=p.exports},d5eb:function(e,a,t){},f1ca:function(e,a,t){"use strict";var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"common-work-order-info"},[Object.keys(e.detailInfo).length>0?t("el-collapse",{model:{value:e.collapseArray,callback:function(a){e.collapseArray=a},expression:"collapseArray"}},[t("el-collapse-item",{attrs:{title:"属性",name:"1"}},[t("div",{staticClass:"flex-between"},[t("span",[e._v("工单来源："+e._s(e.sourceList[e.detailInfo.workOrderSource]))]),t("span",[e._v("标签："+e._s(e.detailInfo.tagName))]),t("span",[e._v("紧急程度："+e._s(e.getNameByKey(e.detailInfo.emergencyLevel,"emergencyLevel")))]),t("span",[e._v("创建人："+e._s(e.detailInfo.createManagerName))])])]),t("el-collapse-item",{attrs:{title:"详情",name:"2"}},[t("div",{staticClass:"flex-between"},[t("span",[e._v("用户昵称："+e._s(e.detailInfo.userNickName))]),t("span",[e._v("用户ID："+e._s(e.detailInfo.userId))]),t("span",[e._v("用户手机号："+e._s(e.detailInfo.userMobile))])]),t("div",{staticClass:"mar-t-10"},[e._v("工单内容："+e._s(e.detailInfo.workOrderDescribe)+" ")]),t("div",{staticClass:"mar-t-10"},[e._v("订单号："+e._s(e.detailInfo.orderNo)+" ")]),t("div",[e._v("子订单："+e._s(e.detailInfo.subOrderNo))]),e.detailInfo.workOrderSource?t("div",{staticClass:"mar-t-10"},[e._v("工单来源："+e._s(e.sourceList[e.detailInfo.workOrderSource])+" ")]):e._e(),e.detailInfo.workOrderPic?t("div",{staticClass:"flex align-center mar-t-10"},[t("span",[e._v("附件：")]),e._l(e.formatImg(e.detailInfo.workOrderPic),(function(a){return t("div",{key:a},[e.isImg(a)?t("img",{staticClass:"list-img-box",attrs:{src:e.dealShowFileSrc(a)},on:{click:function(t){return e.previewImg([a],0)}}}):t("a",{staticClass:"file-a",attrs:{download:"文件",href:e.dealShowFileSrc(a)}},[e._v(e._s(e.getFileName(a)))])])}))],2):e._e(),e.detailInfo.workOrderContent?t("div",{staticClass:"mar-t-10"},[e._v("备注事项："+e._s(e.detailInfo.workOrderContent))]):e._e()]),t("el-collapse-item",{attrs:{name:"3"}},[t("template",{slot:"title"},[t("div",{staticClass:"flex-between"},[t("span",[e._v("处理进度")]),t("span",[e._v(e._s(e.getDealInfo()))])])]),t("el-timeline",e._l(e.detailInfo.processRecords,(function(a,r){return t("el-timeline-item",{key:r,attrs:{timestamp:e.WorkOrderDealTypeEnum[a[0].dealType],placement:"top"}},[t("el-card",[t("div",{staticClass:"flex-between"},[t("span",[e._v("\n                                处理人："+e._s(a[0].dealManagerName)+"\n                            ")]),t("span",[e._v(e._s(e._f("formatTime")(a[0].createDate)))])]),e._l(a,(function(a,r){return 0!=r?t("div",{key:r},[t("div",{staticClass:"flex-between"},[t("span",[7==a.dealType?[e._v("\n                                      抄送："+e._s(a.dealManagerName)+"\n                                  ")]:2==a.dealType?[e._v("\n                                     "+e._s(a.dealContent)+"\n                                 ")]:e._e()],2),t("span",[e._v(e._s(e._f("formatTime")(a.createDate)))])]),a.dealPic?t("div",{staticClass:"flex align-center mar-t-10"},[t("span",[e._v("附件：")]),e._l(e.formatImg(a.dealPic),(function(a){return t("div",{key:a},[e.isImg(a)?t("img",{staticClass:"list-img-box",attrs:{src:e.dealShowFileSrc(a)},on:{click:function(t){return e.previewImg([a],0)}}}):t("a",{staticClass:"file-a",attrs:{download:"文件",href:e.dealShowFileSrc(a)}},[e._v(e._s(e.getFileName(a)))])])}))],2):e._e()]):e._e()})),a[0].dealContent?t("div",[e._v("处理说明："+e._s(a[0].dealContent))]):e._e(),a[0].dealPic?t("div",{staticClass:"flex align-center mar-t-10"},[t("span",[e._v("附件：")]),e._l(e.formatImg(a[0].dealPic),(function(a){return t("div",{key:a},[e.isImg(a)?t("img",{staticClass:"list-img-box",attrs:{src:e.dealShowFileSrc(a)},on:{click:function(t){return e.previewImg([a],0)}}}):t("a",{staticClass:"file-a",attrs:{download:"文件",href:e.dealShowFileSrc(a)}},[e._v(e._s(e.getFileName(a)))])])}))],2):e._e(),a[0].dealEvaluation&&a[0].dealEvaluation.length>0?t("div",[e._v("\n                            工单评价："+e._s(e.WorkOrderEvaluationEnum[a[0].dealEvaluation])+"\n                            "),e._l(a[0].dealEvaluation,(function(a,r){return t("span",{key:r,staticClass:"mar-l-10"},[e._v(e._s(e.WorkOrderEvaluationEnum[a]))])}))],2):e._e()],2)],1)})),1)],2)],1):e._e(),t("image-preview",{directives:[{name:"show",rawName:"v-show",value:e.image.show,expression:"image.show"}],attrs:{close:e.closePreview,index:e.image.index,list:e.image.list}})],1)},l=[],o=(t("ac6a"),t("456d"),t("6762"),t("28a5"),t("c229")),s=t("8866"),i=t("6d47"),n=t("403c"),c=["bmp","jpg","png","jpeg","gif","tiff","pcx"],d={props:{workOrderNo:String,collapseArray:Array},data:function(){return{detailInfo:{},image:{show:!1,index:0,list:[]}}},mixins:[n["a"]],components:{imagePreview:o["a"]},watch:{workOrderNo:function(e){e&&this.getWorkOrderDetail()}},created:function(){this.getWorkOrderDetail()},methods:{getWorkOrderDetail:function(){var e=this;Object(i["k"])({workOrderNo:this.workOrderNo}).then((function(a){if(console.log(a),1===a.ret.errcode){for(var t={},r=0;r<a.workOrderView.processRecords.length;r++)t[a.workOrderView.processRecords[r].processNo]||(t[a.workOrderView.processRecords[r].processNo]=[]),t[a.workOrderView.processRecords[r].processNo].push(a.workOrderView.processRecords[r]);a.workOrderView.processRecords=t,e.detailInfo=a.workOrderView}}))},isImg:function(e){var a=e.split(".");return c.includes(a[a.length-1])},getFileName:function(e){var a=e.split("/");return a[a.length-1]||"文件"},getDealInfo:function(){var e="";if(Object.keys(this.detailInfo.processRecords).length>0){var a=Object.keys(this.detailInfo.processRecords)[Object.keys(this.detailInfo.processRecords).length-1];e="当前进度：";var t=this.detailInfo.processRecords[a][0];e+=this.WorkOrderDealStatus[t.dealStatus],e+=" "+t.dealManagerName,e+=" "+Object(s["b"])(t.createDate)}return e},previewImg:function(e,a){this.image.list=e,this.image.index=a,this.image.show=!0},closePreview:function(){this.image.index=0,this.image.show=!1}}},m=d,p=(t("13cf"),t("2877")),u=Object(p["a"])(m,r,l,!1,null,null,null);a["a"]=u.exports}}]);