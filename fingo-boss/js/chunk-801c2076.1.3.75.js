(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-801c2076"],{"05bd":function(e,t,i){"use strict";var a=i("3251"),s=i.n(a);s.a},"10e4":function(e,t,i){},3251:function(e,t,i){},"33c7":function(e,t,i){"use strict";var a=i("dcfc"),s=i.n(a);s.a},3936:function(e,t,i){"use strict";var a=i("b1ee"),s=i.n(a);s.a},"476f":function(e,t,i){"use strict";var a=i("e57f"),s=i.n(a);s.a},"49bd":function(e,t,i){"use strict";var a=i("e2ec"),s=i.n(a);s.a},5378:function(e,t,i){"use strict";var a=i("10e4"),s=i.n(a);s.a},"60fb":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));var a=i("5c96"),s="https://file.fingo.shop";axios.defaults.timeout=45e3,axios.interceptors.request.use((function(e){return e}),(function(e){return a["Message"].error("请求超时"),Promise.resolve(e)}));var n=function(e,t){var i={headers:{"Content-Type":"multipart/form-data"}};return axios.post("".concat(s).concat(e),t,i).then((function(e){return e.data}))},r=function(e,t){var i={headers:{"Content-Type":"multipart/form-data"}};return axios.post("".concat(s).concat(e),t,i).then((function(e){return e.data}))}},6471:function(e,t,i){"use strict";i.d(t,"s",(function(){return s})),i.d(t,"t",(function(){return n})),i.d(t,"u",(function(){return r})),i.d(t,"v",(function(){return o})),i.d(t,"w",(function(){return l})),i.d(t,"y",(function(){return u})),i.d(t,"z",(function(){return c})),i.d(t,"x",(function(){return p})),i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return h})),i.d(t,"k",(function(){return m})),i.d(t,"h",(function(){return f})),i.d(t,"f",(function(){return g})),i.d(t,"d",(function(){return v})),i.d(t,"n",(function(){return T})),i.d(t,"i",(function(){return b})),i.d(t,"j",(function(){return y})),i.d(t,"m",(function(){return k})),i.d(t,"l",(function(){return S})),i.d(t,"c",(function(){return w})),i.d(t,"e",(function(){return _})),i.d(t,"q",(function(){return C})),i.d(t,"r",(function(){return O})),i.d(t,"p",(function(){return D})),i.d(t,"o",(function(){return P})),i.d(t,"g",(function(){return R}));var a=i("284b");function s(e){var t=a["a"].create("CancelTimingTaskReq",e);return Object(a["a"])("chat","PushTaskService.CancelTimingTask",t,"pushtask.CancelTimingTaskResp")}function n(e){var t=a["a"].create("CreatePushTaskReq",e);return Object(a["a"])("chat","PushTaskService.CreatePushTask",t,"pushtask.CreatePushTaskResp")}function r(e){var t=a["a"].create("DeletePushTaskReq",e);return Object(a["a"])("chat","PushTaskService.DeletePushTask",t,"pushtask.DeletePushTaskResp")}function o(e){var t=a["a"].create("EditPushTaskReq",e);return Object(a["a"])("chat","PushTaskService.EditPushTask",t,"pushtask.EditPushTaskResp")}function l(e){var t=a["a"].create("EditUserGroupReq",e);return Object(a["a"])("chat","PushTaskService.EditUserGroup",t,"pushtask.EditUserGroupResp")}function u(e){var t=a["a"].create("SendPushReq",e);return Object(a["a"])("chat","PushTaskService.SendPush",t,"pushtask.SendPushResp")}function c(e){var t=a["a"].create("SendTimingTaskNowReq",e);return Object(a["a"])("chat","PushTaskService.SendTimingTaskNow",t,"pushtask.SendTimingTaskNowResp")}function p(e){var t=a["a"].create("SearchPushTaskOrRecordReq",e);return Object(a["a"])("chat","PushTaskService.SearchPushTaskOrRecord",t,"pushtask.SearchPushTaskOrRecordResp")}function d(e){var t=a["a"].create("AddUserGroupBySpeRep",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.AddUserGroupBySpe",t,"datahouse.AddUserGroupBySpeResp")}function h(e){var t=a["a"].create("AddUserGroupByGroupReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.AddUserGroupByGroup",t,"datahouse.AddUserGroupByGroupResp")}function m(e){var t=a["a"].create("GetUserGroupInfoReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.GetUserGroupInfo",t,"datahouse.GetUserGroupInfoResp")}function f(e){var t=a["a"].create("GetUserGroupDetailInfoReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.GetUserGroupDetailInfo",t,"datahouse.GetUserGroupDetailInfoResp")}function g(e){var t=a["a"].create("EditUserGroupInfoReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.EditUserGroupInfo",t,"datahouse.EditUserGroupInfoResp")}function v(e){var t=a["a"].create("DeleteUserGroupInfoReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.DeleteUserGroupInfo",t,"datahouse.DeleteUserGroupInfoResp")}function T(e){var t=a["a"].create("GetUserPropertyListReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.GetUserPropertyList",t,"datahouse.GetUserPropertyListResp")}function b(e){var t=a["a"].create("GetUserGroupIdToExcelReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.GetUserGroupIdToExcel",t,"datahouse.GetUserGroupIdToExcelResp")}function y(e){var t=a["a"].create("GetUserGroupIdTotalReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.GetUserGroupIdTotal",t,"datahouse.GetUserGroupIdTotalResp")}function k(e){var t=a["a"].create("GetUserIdsExcelOnEditPageReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.GetUserIdsExcelOnEditPage",t,"datahouse.GetUserIdsExcelOnEditPageResp")}function S(e){var t=a["a"].create("GetUserIdsCountOnEditPageReq",e);return Object(a["a"])("datahouse","PushTaskUserGroupService.GetUserIdsCountOnEditPage",t,"datahouse.GetUserIdsCountOnEditPageResp")}function w(e){var t=a["a"].create("CreateAppVersionReq",e);return Object(a["a"])("chat","AppVersionBossService.CreateAppVersion",t,"CreateAppVersionResp")}function _(e){var t=a["a"].create("EditAppVersionReq",e);return Object(a["a"])("chat","AppVersionBossService.EditAppVersion",t,"EditAppVersionResp")}function C(e){var t=a["a"].create("SearchCurrentAppVersionInfoReq",e);return Object(a["a"])("chat","AppVersionBossService.SearchCurrentAppVersionInfo",t,"SearchCurrentAppVersionInfoResp")}function O(e){var t=a["a"].create("SearchLowestAppVersionInfoReq",e);return Object(a["a"])("chat","AppVersionBossService.SearchLowestAppVersionInfo",t,"SearchLowestAppVersionInfoResp")}function D(e){var t=a["a"].create("SearchAppVersionInfoWithPageReq",e);return Object(a["a"])("chat","AppVersionBossService.SearchAppVersionInfoWithPage",t,"SearchAppVersionInfoWithPageResp")}function P(e){var t=a["a"].create("PublishAppVersionOrNotReq",e);return Object(a["a"])("chat","AppVersionBossService.PublishAppVersionOrNot",t,"PublishAppVersionOrNotResp")}function R(e){var t=a["a"].create("GetAppVersionDetailReq",e);return Object(a["a"])("chat","AppVersionBossService.GetAppVersionDetail",t,"GetAppVersionDetailResp")}},"8ced":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",{ref:"messagePushForm",attrs:{inline:"","label-width":"90px",model:e.queryData}},[i("el-form-item",{staticClass:"filter-item",attrs:{label:"标题：",prop:"title"}},[i("el-input",{attrs:{placeholder:"请输入标题",size:"medium",clearable:""},model:{value:e.queryData.title,callback:function(t){e.$set(e.queryData,"title",t)},expression:"queryData.title"}})],1),i("el-form-item",{staticClass:"filter-item",attrs:{label:"内容：",prop:"content"}},[i("el-input",{attrs:{placeholder:"请输入内容",size:"medium",clearable:""},model:{value:e.queryData.content,callback:function(t){e.$set(e.queryData,"content",t)},expression:"queryData.content"}})],1),i("span",{directives:[{name:"show",rawName:"v-show",value:e.drop,expression:"drop"}]},[i("el-form-item",{staticClass:"filter-item",attrs:{label:"推送编号：",prop:"pushTaskCode"}},[i("el-input",{attrs:{placeholder:"请输入推送编号",size:"medium",clearable:""},model:{value:e.queryData.pushTaskCode,callback:function(t){e.$set(e.queryData,"pushTaskCode",t)},expression:"queryData.pushTaskCode"}})],1),i("el-form-item",{staticClass:"filter-item",attrs:{label:"推送渠道：",prop:"pushChannel"}},[i("el-select",{attrs:{size:"medium",clearable:""},model:{value:e.queryData.pushChannel,callback:function(t){e.$set(e.queryData,"pushChannel",t)},expression:"queryData.pushChannel"}},e._l(e.pushChannelList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{staticClass:"filter-item",attrs:{label:"推送类型：",prop:"pushType"}},[i("el-select",{attrs:{size:"medium",clearable:""},model:{value:e.queryData.pushType,callback:function(t){e.$set(e.queryData,"pushType",t)},expression:"queryData.pushType"}},e._l(e.pushTypeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{staticClass:"filter-item",attrs:{label:"发送状态：",prop:"sendType"}},[i("el-select",{attrs:{size:"medium",clearable:""},model:{value:e.queryData.sendType,callback:function(t){e.$set(e.queryData,"sendType",t)},expression:"queryData.sendType"}},e._l(e.statusList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{staticClass:"filter-item",attrs:{label:"创建时间：",prop:"createTimeList"}},[i("el-date-picker",{attrs:{size:"medium",type:"daterange","value-format":"timestamp","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:e.queryData.createTimeList,callback:function(t){e.$set(e.queryData,"createTimeList",t)},expression:"queryData.createTimeList"}})],1)],1),i("el-form-item",{staticClass:"filter-item",attrs:{label:"发送时间：",prop:"sendTimeList"}},[i("el-date-picker",{attrs:{size:"medium",type:"daterange","value-format":"timestamp","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:e.queryData.sendTimeList,callback:function(t){e.$set(e.queryData,"sendTimeList",t)},expression:"queryData.sendTimeList"}})],1),i("el-form-item",{staticClass:"filter-item",staticStyle:{"margin-left":"20px"}},[i("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"medium"},on:{click:e.search},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}}},[e._v("搜索")]),i("el-button",{attrs:{icon:"el-icon-refresh-left",size:"medium"},on:{click:e.resetSearch}},[e._v("重置")]),i("el-link",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",underline:!1},on:{click:e.dropDown}},[e._v("\n                    "+e._s(e.dropDownContent)+"\n                    "),i("i",{class:e.dropDownIcon})])],1)],1)],1),i("div",{staticClass:"main-content-wrapper"},[i("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleTabClick},model:{value:e.activeCountry,callback:function(t){e.activeCountry=t},expression:"activeCountry"}},e._l(e.countryList,(function(e,t){return i("el-tab-pane",{key:t,attrs:{label:e.nameLocal,name:e.shortCode}})})),1),i("div",{staticClass:"sub-operate"},[i("el-radio-group",{attrs:{size:"medium"},on:{change:e.handleRadioChange},model:{value:e.listType,callback:function(t){e.listType=t},expression:"listType"}},[i("el-radio-button",{attrs:{label:"task"}},[e._v("任务")]),i("el-radio-button",{attrs:{label:"record"}},[e._v("记录")])],1),i("p",{staticClass:"tip"},[e._v("特别提醒：由于推送信息，默认全量用户，所以查询用户信息需要时间比较久，如果需要修改推送人群信息，请间隔20秒")]),i("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:e.addMessagePush}},[e._v("新建推送")])],1),i("span",{directives:[{name:"show",rawName:"v-show",value:"task"===e.listType,expression:"listType === 'task'"}],staticClass:"main-content-wrapper"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{height:"82%",data:e.tableData,border:""}},[i("el-table-column",{key:"1",attrs:{prop:"pushTaskCode",label:"推送编号",fixed:"",align:"center",width:"180"}}),i("el-table-column",{key:"2",attrs:{prop:"title",label:"标题",fixed:"",align:"center","min-width":"200"}}),i("el-table-column",{key:"3",attrs:{prop:"content",label:"内容",align:"center","min-width":"200"}}),i("el-table-column",{key:"4",attrs:{prop:"pushChannel",label:"推送渠道",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.pushChannel?i("span",[e._v("站外+应用内")]):e._e(),2===t.row.pushChannel?i("span",[e._v("应用内")]):e._e(),3===t.row.pushChannel?i("span",[e._v("站外")]):e._e()]}}])}),i("el-table-column",{key:"5",attrs:{prop:"pushType",label:"推送类型",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["PROMOTION_CODE_SALE"===t.row.pushType?i("span",[e._v("促销活动")]):e._e(),"PROMOTION_CODE_COUPON"===t.row.pushType?i("span",[e._v("优惠券")]):e._e(),"PROMOTION_CODE_MEMBER_ACTIVITY"===t.row.pushType?i("span",[e._v("会员活动")]):e._e()]}}])}),i("el-table-column",{key:"6",attrs:{prop:"creator",label:"创建人",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.creator||"-")+"\n                    ")]}}])}),i("el-table-column",{key:"10",attrs:{prop:"createTime",label:"创建时间(北京)",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e._f("secondTimeFormat")(t.row.createTime))+"\n                    ")]}}])}),i("el-table-column",{key:"13",attrs:{label:"操作",align:"center",fixed:"right",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["task"===e.listType&&e.hasPermission("BTN_MESSAGE_PUSH_SEND")?i("el-dropdown",{attrs:{size:"medium",type:"text",trigger:"click"},on:{command:e.handleCommand}},[i("span",{staticClass:"el-dropdown-link send-push"},[e._v("\n                                发送"),i("i",{staticClass:"el-icon-arrow-down"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"sendNow"},nativeOn:{click:function(i){return e.sendOption(t.row)}}},[e._v("立即发送")]),i("el-dropdown-item",{attrs:{command:"sendTimer"},nativeOn:{click:function(i){return e.sendOption(t.row)}}},[e._v("定时发送")])],1)],1):e._e(),"record"===e.listType&&3===t.row.sendStatus&&e.hasPermission("BTN_MESSAGE_PUSH_SEND")?i("el-dropdown",{attrs:{size:"medium",type:"text",trigger:"click"},on:{command:e.handleRecordCommand}},[i("span",{staticClass:"el-dropdown-link send-push"},[e._v("\n                                定时发送"),i("i",{staticClass:"el-icon-arrow-down"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"cancelTiming"},nativeOn:{click:function(i){return e.sendOption(t.row)}}},[e._v("撤销定时")]),i("el-dropdown-item",{attrs:{command:"sendTiming"},nativeOn:{click:function(i){return e.sendOption(t.row)}}},[e._v("立即发送")])],1)],1):e._e(),"task"===e.listType&&e.hasPermission("BTN_MESSAGE_PUSH_EDIT")?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.editPush(t.row,"edit")}}},[e._v("编辑")]):e._e(),"record"===e.listType?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.editPush(t.row,"view")}}},[e._v("查看")]):e._e(),"task"===e.listType&&e.hasPermission("BTN_MESSAGE_PUSH_RECEIVER_SET")?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.setReceiver(t.row)}}},[e._v("接收用户")]):e._e(),"task"===e.listType&&e.hasPermission("BTN_MESSAGE_PUSH_DELETE")?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.delPushTask(t.row)}}},[e._v("删除")]):e._e()]}}])})],1)],1),i("span",{directives:[{name:"show",rawName:"v-show",value:"record"===e.listType,expression:"listType === 'record'"}]},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{height:"84%",data:e.tableData,border:""}},[i("el-table-column",{key:"1",attrs:{prop:"pushTaskCode",label:"推送编号",fixed:"",align:"center",width:"180"}}),i("el-table-column",{key:"2",attrs:{prop:"title",label:"标题",fixed:"",align:"center","min-width":"200"}}),i("el-table-column",{key:"3",attrs:{prop:"content",label:"内容",align:"center","min-width":"200"}}),i("el-table-column",{key:"12",attrs:{prop:"sendStatus",label:"发送状态",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.sendStatus?i("el-tag",{attrs:{size:"mini",type:"success"}},[e._v("已发送")]):e._e(),2===t.row.sendStatus?i("el-tag",{attrs:{size:"mini"}},[e._v("发送中")]):e._e(),3===t.row.sendStatus?i("el-tag",{attrs:{size:"mini",type:"warning"}},[e._v("定时发送")]):e._e()]}}])}),i("el-table-column",{key:"4",attrs:{prop:"pushChannel",label:"推送渠道",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.pushChannel?i("span",[e._v("站外+应用内")]):e._e(),2===t.row.pushChannel?i("span",[e._v("应用内")]):e._e(),3===t.row.pushChannel?i("span",[e._v("站外")]):e._e()]}}])}),i("el-table-column",{key:"5",attrs:{prop:"pushType",label:"推送类型",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["PROMOTION_CODE_SALE"===t.row.pushType?i("span",[e._v("促销活动")]):e._e(),"PROMOTION_CODE_COUPON"===t.row.pushType?i("span",[e._v("优惠券")]):e._e(),"PROMOTION_CODE_MEMBER_ACTIVITY"===t.row.pushType?i("span",[e._v("会员活动")]):e._e()]}}])}),i("el-table-column",{key:"6",attrs:{prop:"creator",label:"创建人",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.creator||"-")+"\n                    ")]}}])}),i("el-table-column",{key:"7",attrs:{prop:"sender",label:"发送人",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.sender||"-")+"\n                    ")]}}])}),i("el-table-column",{key:"8",attrs:{prop:"successSentNum",label:"成功发送数",align:"center",width:"110"}}),i("el-table-column",{key:"9",attrs:{prop:"openRate",label:"打开率",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.openRate||"-")+"%\n                    ")]}}])},[i("template",{slot:"header"},[e._v("\n                        打开率\n                        "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"打开率=（阅读推送的用户数/成功发送数）x 100%",placement:"top"}},[i("i",{staticClass:"el-icon-warning-outline"})])],1)],2),i("el-table-column",{key:"10",attrs:{prop:"createTime",label:"创建时间(北京)",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e._f("secondTimeFormat")(t.row.createTime))+"\n                    ")]}}])}),i("el-table-column",{key:"11",attrs:{prop:"sentTime",label:"发送时间("+e.activeCountryName+")",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e._f("secondTimeFormat")(t.row.sentTime))+"\n                    ")]}}])}),i("el-table-column",{key:"13",attrs:{label:"操作",align:"center",fixed:"right",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["task"===e.listType?i("el-dropdown",{attrs:{size:"medium",type:"text",trigger:"click"},on:{command:e.handleCommand}},[i("span",{staticClass:"el-dropdown-link send-push"},[e._v("\n                                发送"),i("i",{staticClass:"el-icon-arrow-down"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"sendNow"},nativeOn:{click:function(i){return e.sendOption(t.row)}}},[e._v("立即发送")]),i("el-dropdown-item",{attrs:{command:"sendTimer"},nativeOn:{click:function(i){return e.sendOption(t.row)}}},[e._v("定时发送")])],1)],1):e._e(),"record"===e.listType&&3===t.row.sendStatus?i("el-dropdown",{attrs:{size:"medium",type:"text",trigger:"click"},on:{command:e.handleRecordCommand}},[i("span",{staticClass:"el-dropdown-link send-push"},[e._v("\n                                定时发送"),i("i",{staticClass:"el-icon-arrow-down"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"cancelTiming"},nativeOn:{click:function(i){return e.sendOption(t.row)}}},[e._v("撤销定时")]),i("el-dropdown-item",{attrs:{command:"sendTiming"},nativeOn:{click:function(i){return e.sendOption(t.row)}}},[e._v("立即发送")])],1)],1):e._e(),"task"===e.listType?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.editPush(t.row,"edit")}}},[e._v("编辑")]):e._e(),"record"===e.listType?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.editPush(t.row,"view")}}},[e._v("查看")]):e._e(),"task"===e.listType?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.setReceiver(t.row)}}},[e._v("接收用户")]):e._e(),"task"===e.listType?i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.delPushTask(t.row)}}},[e._v("删除")]):e._e()]}}])})],1)],1)],1),i("div",{staticClass:"pagination-box"},[i("el-pagination",{staticClass:"pagination",attrs:{"page-sizes":[10,20,50,100],"current-page":e.queryData.page.pageNum,"page-size":e.queryData.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),i("confirm-dialog",{attrs:{dialogVisible:e.confirmVisible,title:e.confirmDialogTitle,text:e.confirmDialogText},on:{"on-cancle":e.handleCancleConfirm,"on-confirm":e.handleConfirm}}),i("push-time-edit-dialog",{attrs:{dialogVisible:e.pushTimeEditVisible,countryName:e.activeCountryName,pushSettingModel:e.pushTimeSetting},on:{"on-cancle":e.handleCancleEditTime,"on-confirm":e.handleConfirmEditTime}}),i("push-receiver-edit-dialog",{attrs:{dialogVisible:e.pushReceiverEditVisible,receiverModel:e.receiverModel},on:{"on-cancle":e.handleCancleEditReceiver,"on-confirm":e.handleConfirmEditReceiver}}),i("message-push-edit-dialog",{attrs:{dialogVisible:e.editDialogVisible,editType:e.messageEditType,pushSettingModel:e.pushSetting},on:{"on-cancle":e.handleCancleEdit,"on-confirm":e.handleConfrimEdit}})],1)},s=[],n=(i("ac4d"),i("8a81"),i("5df3"),i("1c4c"),i("28a5"),i("6b54"),i("ac6a"),i("7f7f"),i("bd86")),r=i("2ef0"),o=i.n(r),l=i("6471"),u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"message-push-edit-dialog"},[i("el-dialog",{attrs:{title:e.dialogTitle,visible:e.toggle,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){e.toggle=t},close:e.cancle}},[i("el-card",{staticClass:"info-card"},[i("div",{staticClass:"info-title mar-b-10"},[e._v("\n                推送设置\n            ")]),i("div",[i("el-form",{ref:"pushSettingForm",staticStyle:{width:"1000px"},attrs:{model:e.pushSetting,rules:e.ruleValidate,"label-width":"110px",size:"mini"}},[i("el-form-item",{attrs:{prop:"countryName",label:"推送国家："}},[e._v(e._s(e.pushSetting.countryName))]),i("el-form-item",{attrs:{prop:"pushChannel",label:"推送渠道："}},[i("el-select",{attrs:{size:"medium",clearable:""},model:{value:e.pushSetting.pushChannel,callback:function(t){e.$set(e.pushSetting,"pushChannel",t)},expression:"pushSetting.pushChannel"}},e._l(e.pushChannelList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{prop:"pushType",label:"推送类型："}},[i("el-select",{attrs:{size:"medium",clearable:""},model:{value:e.pushSetting.pushType,callback:function(t){e.$set(e.pushSetting,"pushType",t)},expression:"pushSetting.pushType"}},e._l(e.pushTypeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{prop:"pushPic",label:"推送图片："}},[i("div",{staticClass:"push-cover-image-wrapper",staticStyle:{width:"120px",height:"120px"}},[e.pushSetting.pushPic?i("div",{staticClass:"cover-image"},[i("el-image",{attrs:{src:e.dealShowFileSrc(e.pushSetting.pushPic),fit:"contain"}}),i("div",{staticClass:"operate-area"},[i("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.delPic()}}})])],1):i("el-upload",{staticClass:"standard-img",attrs:{action:"",limit:1,accept:".jpg,.jpeg,.png,.gif,.bmp,.JPG,.JPEG,.PBG,.GIF,.BMP","http-request":e.uploadPic,"list-type":"picture-card"}},[i("i",{staticClass:"el-icon-plus"})])],1)]),i("el-form-item",{attrs:{prop:"redirect",label:"跳转："}},[i("el-radio-group",{model:{value:e.pushSetting.redirect,callback:function(t){e.$set(e.pushSetting,"redirect",t)},expression:"pushSetting.redirect"}},[i("el-radio",{attrs:{label:3}},[e._v("不跳转")]),i("el-radio",{attrs:{label:1}},[e._v("链接")]),i("el-radio",{attrs:{label:2}},[e._v("应用内")])],1)],1),2===e.pushSetting.redirect?i("el-form-item",{attrs:{prop:"actionType",label:"跳转类型："}},[i("el-select",{attrs:{size:"medium",clearable:""},model:{value:e.pushSetting.actionType,callback:function(t){e.$set(e.pushSetting,"actionType",t)},expression:"pushSetting.actionType"}},e._l(e.actionTypeList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),1===e.pushSetting.redirect?i("el-form-item",{attrs:{prop:"url",label:"跳转链接："}},[i("el-input",{staticStyle:{width:"400px"},attrs:{clearable:"",placeholder:"请输入内容",size:"medium"},model:{value:e.pushSetting.url,callback:function(t){e.$set(e.pushSetting,"url",t)},expression:"pushSetting.url"}})],1):e._e()],1)],1)]),i("el-card",{staticClass:"info-card"},[i("div",{staticClass:"info-title mar-b-10"},[e._v("推送内容"),i("span",[e._v(" (标题和内容包含emoji等表情符号不要过多，避免超长)")])]),i("div",{staticClass:"user-category"},[i("el-form",{ref:"pushLangSettingForm",staticStyle:{width:"1000px"},attrs:{model:e.pushSetting,rules:e.ruleValidate,"label-width":"120px",size:"mini"}},e._l(e.languageList,(function(t,a){return i("span",{key:a},[i("el-form-item",{attrs:{prop:"title"+t.code,label:"标题("+t.desc+")："}},[i("el-input",{staticStyle:{width:"400px"},attrs:{clearable:"",placeholder:"请输入标题",size:"medium",maxlength:"100","show-word-limit":""},model:{value:e.pushSetting["title"+t.code],callback:function(i){e.$set(e.pushSetting,"title"+t.code,i)},expression:"pushSetting['title'+item.code]"}})],1),i("el-form-item",{attrs:{prop:"content"+t.code,label:"内容("+t.desc+")："}},[i("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",rows:3,placeholder:"请输入内容",clearable:"",size:"medium",maxlength:"200","show-word-limit":""},model:{value:e.pushSetting["content"+t.code],callback:function(i){e.$set(e.pushSetting,"content"+t.code,i)},expression:"pushSetting['content'+item.code]"}})],1)],1)})),0)],1)]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["view"===e.editType?i("el-button",{attrs:{size:"small"},on:{click:e.cancle}},[e._v("关 闭")]):e._e(),"view"!=e.editType?i("el-button",{attrs:{size:"small"},on:{click:e.cancle}},[e._v("取 消")]):e._e(),"view"!=e.editType?i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("确 定")]):e._e()],1)],1)],1)},c=[],p=i("60fb"),d={props:{editType:{type:String,default:""},dialogVisible:{type:Boolean,default:!1},pushSettingModel:{type:Object,default:function(){return{}}}},data:function(){return{languageList:[],pushSetting:this.pushSettingModel,ruleValidate:{countryName:[{required:!0,message:"",trigger:"blur"}],pushChannel:[{required:!0,message:"请选择推送渠道",trigger:"change"}],pushType:[{required:!0,message:"请选择推送类型",trigger:"change"}],pushPic:[{required:!0,message:"请上传推送图片",trigger:"blur"}],redirect:[{required:!0,message:"请选择跳转类型",trigger:"change"}],actionType:[{required:!0,message:"请选择跳转类型",trigger:"change"}],url:[{required:!0,message:"请输入跳转链接",trigger:"blur"}],sendType:[{required:!0,message:"请选择发送方式",trigger:"change"}],pushPlanTime:[{required:!0,message:"请选择发送时间",trigger:"change"}],titlecn:[{required:!0,message:"请输入标题（简体中文）",trigger:"blur"}],contentcn:[{required:!0,message:"请输入内容（简体中文）",trigger:"blur"}],titleen:[{required:!0,message:"请输入标题（英文）",trigger:"blur"}],contenten:[{required:!0,message:"请输入内容（英文）",trigger:"blur"}]},options:[],productBaseData:[],skuTableData:[],createGroupRadio:null,joinGroupRadio:null,createGroupCheckList:[],joinGroupCheckList:[],createUserIdList:"",joinUserIdList:"",pushChannelList:[{value:1,label:"站外+应用内"},{value:2,label:"应用内"},{value:3,label:"站外"}],pushTypeList:[{value:"PROMOTION_CODE_SALE",label:"促销活动"},{value:"PROMOTION_CODE_COUPON",label:"优惠券"},{value:"PROMOTION_CODE_MEMBER_ACTIVITY",label:"会员活动"},{value:"ORDER_CODE_SEND_ORDER_REFUND_CASH",label:"订单退款"}],memberLevel:[{label:"SH",value:"SH"},{label:"PS",value:"PS"},{label:"AM",value:"AM"},{label:"AT",value:"AT"}],actionTypeList:[{label:"我的收益",value:"MY_INCOME"},{label:"我的团队",value:"MY_TEAM"},{label:"我的优惠券",value:"MY_COUPON"},{label:"我的收藏",value:"MY_COLLECTION"}]}},computed:{toggle:{get:function(){return this.dialogVisible},set:function(){}},dialogTitle:{get:function(){return"add"===this.editType?"新增消息推送":"edit"===this.editType?"编辑消息推送":"查看消息推送"},set:function(){}}},components:{},watch:{},created:function(){this.languageList=JSON.parse(this.getStore("languageList"))},methods:{cancle:function(){this.$emit("on-cancle"),this.reset()},confirm:function(){var e=this,t=!0,i=!0;this.$refs.pushSettingForm.validate((function(i){if(i){t=!0;var a=[];_.forEach(e.languageList,(function(t){var i={};e.pushSetting["title"+t.code]&&(i.language=t.code,i.title=e.pushSetting["title"+t.code],i.content=e.pushSetting["content"+t.code],a.push(i))})),e.pushSetting.pushLang=a,2===e.pushSetting.redirect?e.pushSetting.redirectParam=e.pushSetting.actionType:1===e.pushSetting.redirect&&(e.pushSetting.redirectParam=e.pushSetting.url)}else t=!1})),this.$refs.pushLangSettingForm.validate((function(e){i=!!e})),t&&i&&(this.$emit("on-confirm",this.pushSetting),this.reset())},reset:function(){this.pushSetting.pushType="",this.pushSetting.actionType=null,this.pushSetting.url="",this.$refs.pushSettingForm.resetFields()},uploadPic:function(e){var t=this,i=new FormData,a={fileName:e.file.name,type:"product"};i.append("file",e.file),i.append("param",JSON.stringify(a));var s="/file/rest/uploadservices/uploadfile";Object(p["a"])(s,i).then((function(e){"600"===e.status&&(console.log(e),t.pushSetting.pushPic=e.original_link)})).catch((function(e){console.log(e)}))},delPic:function(){this.pushSetting.pushPic=""}}},h=d,m=(i("3936"),i("bcab"),i("2877")),f=Object(m["a"])(h,u,c,!1,null,"7023fafc",null),g=f.exports,v=i("96ec"),T=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"push-time-edit-dialog"},[i("el-dialog",{attrs:{title:e.dialogTitle,visible:e.toggle,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.toggle=t},close:e.cancle}},[i("el-form",{ref:"pushTimeEditForm",attrs:{model:e.pushSetting,rules:e.ruleValidate,"label-width":"150px"}},[i("el-form-item",{attrs:{prop:"sendTime",label:"发送时间("+e.countryName+")："}},[i("el-date-picker",{attrs:{"value-format":"timestamp",type:"datetime",size:"medium",placeholder:"选择日期时间","picker-options":e.pickerOptions},model:{value:e.pushSetting.sendTime,callback:function(t){e.$set(e.pushSetting,"sendTime",t)},expression:"pushSetting.sendTime"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:e.cancle}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)],1)},b=[],y={name:"PushTimeDialog",data:function(){return{dialogTitle:"定时发送",pushSetting:this.pushSettingModel,ruleValidate:{sendTime:[{required:!0,message:"请设置发送时间",trigger:"change"}]},pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}}}},props:{dialogVisible:{type:Boolean,default:!1},pushSettingModel:{type:Object,default:function(){return{}}},countryName:{type:String,default:""}},components:{},computed:{toggle:{get:function(){return this.dialogVisible},set:function(){}}},methods:{cancle:function(){this.$emit("on-cancle"),this.reset()},confirm:function(){var e=this,t=(new Date).getTime();this.pushSetting.sendTime-t<18e5?this.$message.warning("离发时间要大于半小时"):this.$refs.pushTimeEditForm.validate((function(t){t&&(e.$emit("on-confirm",e.pushSetting),e.reset())}))},reset:function(){this.$refs.pushTimeEditForm.resetFields()}}},k=y,S=(i("5378"),Object(m["a"])(k,T,b,!1,null,null,null)),w=S.exports,C=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"push-receiver-edit-dialog"},[i("el-dialog",{attrs:{title:e.dialogTitle,visible:e.toggle,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.toggle=t},close:e.cancle}},[i("div",{staticClass:"push-receiver-edit"},[i("el-radio-group",{on:{change:e.handleChange},model:{value:e.receiverData.groupType,callback:function(t){e.$set(e.receiverData,"groupType",t)},expression:"receiverData.groupType"}},[i("div",{staticClass:"user-type"},[i("el-radio",{attrs:{label:1}},[e._v("全量用户")])],1),i("div",{staticClass:"user-type"},[i("el-radio",{attrs:{label:2}},[e._v("等级")]),i("el-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:2===e.receiverData.groupType,expression:"receiverData.groupType === 2"}],staticClass:"type-item",model:{value:e.receiverData.userLevel,callback:function(t){e.$set(e.receiverData,"userLevel",t)},expression:"receiverData.userLevel"}},e._l(e.memberLevel,(function(t,a){return i("el-checkbox",{key:a,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),i("div",{staticClass:"user-type"},[i("el-radio",{attrs:{label:3}},[e._v("用户ID")]),i("el-input",{directives:[{name:"show",rawName:"v-show",value:3===e.receiverData.groupType,expression:"receiverData.groupType === 3"}],staticClass:"type-item",staticStyle:{width:"350px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"可填写多个用户id，id之间用英文','隔开"},model:{value:e.receiverData.userId,callback:function(t){e.$set(e.receiverData,"userId",t)},expression:"receiverData.userId"}})],1),i("div",{staticClass:"user-type"},[i("el-radio",{attrs:{label:4}},[e._v("用户画像分组")]),i("el-select",{directives:[{name:"show",rawName:"v-show",value:4===e.receiverData.groupType,expression:"receiverData.groupType === 4"}],attrs:{filterable:"",remote:"","reserve-keyword":"","remote-method":e.remoteMethod,placeholder:"请选择"},model:{value:e.receiverData.userGroupId,callback:function(t){e.$set(e.receiverData,"userGroupId",t)},expression:"receiverData.userGroupId"}},e._l(e.receiverData.idList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)])],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:e.cancle}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("确 定")])],1)])],1)},O=[],D=(i("c5f6"),{name:"PushReceiverDialog",data:function(){return{dialogTitle:"接收用户",pushTimeEditForm:{pushPlanTime:""},ruleValidate:{pushPlanTime:[{required:!0,message:"请选择发送时间",trigger:"change"}]},memberLevel:[{label:"SH",value:2},{label:"PS",value:3},{label:"AM",value:4},{label:"AT",value:5}],receiverIdList:"",receiverCheckList:[]}},props:{dialogVisible:{type:Boolean,default:!1},receiverTypeModel:{type:Number},receiverModel:{type:Object,default:function(){return{}}}},components:{},computed:{toggle:{get:function(){return this.dialogVisible},set:function(){}},receiverData:{get:function(){return this.receiverModel},set:function(){}}},methods:{remoteMethod:function(e){console.log(e),this.$parent.getUserGroupInfo(e,"")},cancle:function(){this.$emit("on-cancle")},confirm:function(){console.log(this.receiverData),this.$emit("on-confirm",this.receiverData)},handleChange:function(){this.reset()},reset:function(){this.receiverIdList="",this.receiverCheckList=[]}}}),P=D,R=(i("476f"),i("05bd"),Object(m["a"])(P,C,O,!1,null,"21ccc33c",null)),E=R.exports;function L(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=x(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r=!0,o=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return r=e.done,e},e:function(e){o=!0,n=e},f:function(){try{r||null==i.return||i.return()}finally{if(o)throw n}}}}function x(e,t){if(e){if("string"===typeof e)return G(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?G(e,t):void 0}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}i("c32d");var I={name:"MessagePush",data:function(){return{drop:!1,dropDownContent:"展开",dropDownIcon:"el-icon-arrow-down",loading:!1,activeCountry:"MY",activeCountryName:"马来西亚",countryList:[],languageList:[],queryData:{country:"MY",title:"",content:"",pushTaskCode:"",pushType:"",sendType:null,createTimeList:[],sendTimeList:[],createTimeStart:"",createTimeEnd:"",sendTimeStart:"",sendTimeEnd:"",type:1,page:{pageNum:1,pageSize:20,pagingSwitch:!0}},listType:"task",tableData:[],totalCount:0,pushChannelList:[{value:"1",label:"站外+应用内"},{value:"2",label:"应用内"},{value:"3",label:"站外"}],pushTypeList:[{value:"PROMOTION_CODE_SALE",label:"促销活动"},{value:"PROMOTION_CODE_COUPON",label:"优惠券"},{value:"PROMOTION_CODE_MEMBER_ACTIVITY",label:"会员活动"}],statusList:[{value:1,label:"已发送"},{value:2,label:"发送中"},{value:3,label:"定时发送"}],pushSetting:Object(n["a"])({country:"MY",countryName:"马来西亚",pushChannel:"",pushType:"",pushPic:"",redirect:"",url:"",sendType:"",pushPlanTime:"",pushLang:[]},"redirect",3),editDialogVisible:!1,messageEditType:"",confirmVisible:!1,confirmDialogTitle:"",confirmDialogText:"",confirmType:"",pushTimeEditVisible:!1,pushReceiverEditVisible:!1,sentTime:"",currentRow:null,receiverModel:{groupType:1,userLevel:[],userId:"",userGroupId:"",idList:[]},pushTimeSetting:{sendTime:""}}},components:{ConfirmDialog:v["a"],MessagePushEditDialog:g,PushTimeEditDialog:w,PushReceiverEditDialog:E},created:function(){this.countryList=JSON.parse(this.getStore("countryList")),this.languageList=JSON.parse(this.getStore("languageList"))},mounted:function(){this.getPushTaskOrRecordList(),this.getUserGroupInfo()},methods:{dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="el-icon-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="el-icon-arrow-up"),this.drop=!this.drop},getUserGroupInfo:function(e,t){var i=this;this.receiverModel.idList.splice(0);var a={userGroupName:e||"",userGroupType:"",userGroupId:t,page:{pageNum:1,pageSize:20,pagingSwitch:!0}};Object(l["k"])(a).then((function(e){if(1===e.ret.errcode){console.log(e);var t,a=L(e.userGroupInfo);try{for(a.s();!(t=a.n()).done;){var s=t.value;i.receiverModel.idList.push({value:s.userGroupId,label:s.userGroupName})}}catch(n){a.e(n)}finally{a.f()}console.log(i.receiverModel.idList)}}))},handleTabClick:function(e){this.listType="task",this.pushSetting.country=e.name,this.pushSetting.countryName=e.label,this.queryData.country=e.name,this.activeCountryName=e.label,this.queryData.type="1",this.getPushTaskOrRecordList()},search:function(){this.queryData.page.pageNum=1,this.queryData.page.pageSize=20,this.getPushTaskOrRecordList()},resetSearch:function(){this.queryData.page.pageNum=1,this.queryData.page.pageSize=20,this.queryData.createTimeStart="",this.queryData.createTimeEnd="",this.queryData.sendTimeStart="",this.queryData.sendTimeEnd="",this.$refs.messagePushForm.resetFields(),this.getPushTaskOrRecordList()},handleCurrentChange:function(e){this.queryData.page.pageNum=e||this.queryData.page.pageNum,this.getPushTaskOrRecordList()},handleSizeChange:function(e){this.queryData.page.pageSize=e,this.getPushTaskOrRecordList()},handleRadioChange:function(e){this.queryData.type="task"===e?"1":"2",this.getPushTaskOrRecordList()},getPushTaskOrRecordList:function(){var e=this;this.loading=!0;var t=this.queryData;t.sendTimeList.length>0&&(t.sendTimeStart=t.sendTimeList?t.sendTimeList[0]+"":null,t.sendTimeEnd=t.sendTimeList?t.sendTimeList[1]+"":null),t.createTimeList.length>0&&(t.createTimeStart=t.createTimeList?t.createTimeList[0]+"":null,t.createTimeEnd=t.createTimeList?t.createTimeList[1]+"":null),Object(l["x"])(this.filterData(t)).then((function(t){e.loading=!1,1===t.ret.errcode&&(e.tableData=t.item,e.totalCount=t.total,e.getUserGroupInfo())})).catch((function(t){e.loading=!1,console.log(t)}))},addMessagePush:function(){var e=this;this.editDialogVisible=!0,this.messageEditType="add",o.a.forEach(this.languageList,(function(t){e.$set(e.pushSetting,"title"+t.code,""),e.$set(e.pushSetting,"content"+t.code,"")}))},handleCancleEdit:function(){this.editDialogVisible=!1},handleConfrimEdit:function(e){var t=this;this.editDialogVisible=!1;var i=e;if("add"===this.messageEditType)Object(l["t"])(this.filterData(i)).then((function(e){t.$message.success("消息推送创建成功！"),t.getPushTaskOrRecordList()})).catch((function(e){console.log(e)}));else if("edit"===this.messageEditType){var a=e;a.pushTaskCode=this.currentRow.pushTaskCode,Object(l["v"])(this.filterData(a)).then((function(e){t.$message.success("消息推送编辑成功！"),t.getPushTaskOrRecordList()})).catch((function(e){console.log(e)}))}},handleCancleConfirm:function(){this.confirmVisible=!1},handleConfirm:function(){this.confirmVisible=!1;var e={};switch(this.confirmType){case"sendNow":e={pushTaskCode:this.currentRow.pushTaskCode,sendType:1},this.sendPushRequest(e);break;case"delPush":e={pushTaskCode:this.currentRow.pushTaskCode},this.deletePushTaskRequest(e);break;case"cancelTiming":e={pushTaskCode:this.currentRow.pushTaskCode},this.cancelTimingTaskRequest(e);break;case"sendTiming":e={pushTaskCode:this.currentRow.pushTaskCode},this.sendTimingTaskNowRequest(e);break}},handleCommand:function(e){"sendNow"===e?(this.confirmVisible=!0,this.confirmDialogTitle="发送后将无法撤回",this.confirmDialogText="是否确认发送",this.confirmType="sendNow"):"sendTimer"===e&&(this.pushTimeEditVisible=!0)},sendOption:function(e){this.currentRow=e},handleRecordCommand:function(e){"cancelTiming"===e?(this.confirmVisible=!0,this.confirmDialogTitle="撤销定时发送，该条推送将移至记录中",this.confirmDialogText="是否确认撤销",this.confirmType="cancelTiming"):"sendTiming"===e&&(this.confirmVisible=!0,this.confirmDialogTitle="发送后将无法撤回",this.confirmDialogText="是否确认发送",this.confirmType="sendTiming")},editPush:function(e,t){var i=this;this.currentRow=e,this.messageEditType=t,this.editDialogVisible=!0,this.pushSetting.pushChannel=e.pushChannel,this.pushSetting.pushType=e.pushType,this.pushSetting.pushPic=e.pushPic,this.pushSetting.redirect=e.redirect,2===e.redirect?this.pushSetting.actionType=e.redirectParam:1===e.redirect&&(this.pushSetting.url=e.redirectParam),o.a.forEach(this.languageList,(function(e){i.$set(i.pushSetting,"title"+e.code,""),i.$set(i.pushSetting,"content"+e.code,"")})),o.a.forEach(e.itemLang,(function(e){i.$set(i.pushSetting,"title"+e.language,e.title),i.$set(i.pushSetting,"content"+e.language,e.content)}))},handleCancleEditTime:function(){this.pushTimeEditVisible=!1},handleConfirmEditTime:function(e){this.pushTimeEditVisible=!1;var t={pushTaskCode:this.currentRow.pushTaskCode,sendType:2,sendTime:e.sendTime+""};this.sendPushRequest(t)},setReceiver:function(e){this.currentRow=e,this.pushReceiverEditVisible=!0,this.receiverModel.groupType=e.groupType,2===e.groupType?this.receiverModel.userLevel=e.userLevel:3===e.groupType?this.receiverModel.userId=e.userId.toString():4===e.groupType&&(this.receiverModel.userGroupId=e.userGroupId,this.getUserGroupInfo("",e.userGroupId))},handleCancleEditReceiver:function(){Object.assign(this.receiverModel,{groupType:1,userLevel:[],userId:"",userGroupId:"",idList:[]}),this.pushReceiverEditVisible=!1,this.getUserGroupInfo()},handleConfirmEditReceiver:function(e){var t=this;this.pushReceiverEditVisible=!1;var i={pushTaskCode:this.currentRow.pushTaskCode,groupType:e.groupType};2===e.groupType&&(i.userLevel=e.userLevel),3===e.groupType&&(i.userId=e.userId.split(",")),4===e.groupType&&(i.userGroupId=e.userGroupId),Object(l["w"])(this.filterData(i)).then((function(e){1===e.ret.errcode&&(t.$message.success("接收用户设置成功"),t.getPushTaskOrRecordList(),Object.assign(t.receiverModel,{groupType:1,userLevel:[],userId:"",userGroupId:"",idList:[]}),t.getUserGroupInfo())})).catch((function(e){console.log(e)}))},sendPushRequest:function(e){var t=this,i=e;Object(l["y"])(this.filterData(i)).then((function(e){1===e.ret.errcode&&(t.$message.success("消息推送发送成功"),t.getPushTaskOrRecordList())}))},delPushTask:function(e){this.currentRow=e,this.confirmVisible=!0,this.confirmDialogTitle="删除后将无法恢复",this.confirmDialogText="是否确认删除",this.confirmType="delPush"},deletePushTaskRequest:function(e){var t=this,i=e;Object(l["u"])(this.filterData(i)).then((function(e){1===e.ret.errcode&&(t.$message.success("消息推送删除成功"),t.getPushTaskOrRecordList())})).catch((function(e){console.log(e)}))},cancelTimingTaskRequest:function(e){var t=this,i=e;Object(l["s"])(this.filterData(i)).then((function(e){1===e.ret.errcode&&(t.$message.success("定时消息推送撤销成功"),t.getPushTaskOrRecordList())})).catch((function(e){console.log(e)}))},sendTimingTaskNowRequest:function(e){var t=this,i=e;Object(l["z"])(this.filterData(i)).then((function(e){1===e.ret.errcode&&(t.$message.success("消息推送发送成功"),t.getPushTaskOrRecordList())})).catch((function(e){console.log(e)}))}}},q=I,N=(i("49bd"),Object(m["a"])(q,a,s,!1,null,"967fb6dc",null));t["default"]=N.exports},"8f70":function(e,t,i){"use strict";var a=i("df99"),s=i.n(a);s.a},"96ec":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"confirm-dialog"},[i("el-dialog",{attrs:{title:e.title,visible:e.toggle,"close-on-click-modal":!1,"show-close":!1,width:"400px"},on:{"update:visible":function(t){e.toggle=t}}},[i("div",{attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"el-icon-warning icon"}),e._v(e._s(e.title)+"\n        ")]),i("p",{staticClass:"warning"},[e._v(e._s(e.text))]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:e.cancle}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("确 定")])],1)])],1)},s=[],n={data:function(){return{}},props:{dialogVisible:{type:Boolean,default:!1},title:{type:String,default:"提示"},text:{type:String,default:""}},computed:{toggle:{get:function(){return this.dialogVisible},set:function(){}}},methods:{cancle:function(){this.$emit("on-cancle")},confirm:function(){this.$emit("on-confirm")}}},r=n,o=(i("33c7"),i("8f70"),i("2877")),l=Object(o["a"])(r,a,s,!1,null,"75168e74",null);t["a"]=l.exports},b1ee:function(e,t,i){},bcab:function(e,t,i){"use strict";var a=i("ef6a3"),s=i.n(a);s.a},dcfc:function(e,t,i){},df99:function(e,t,i){},e2ec:function(e,t,i){},e57f:function(e,t,i){},ef6a3:function(e,t,i){}}]);